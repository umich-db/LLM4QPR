EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '89436','30868','65085','22977','83927','77557',
                          '58429','40697','80614','10502','32779',
                          '91137','61265','98294','17921','18427',
                          '21203','59362','87291','84093','21505',
                          '17184','10866','67898','25797','28055',
                          '18377','80332','74535','21757','29742',
                          '90885','29898','17819','40811','25990',
                          '47513','89531','91068','10391','18846',
                          '99223','82637','41368','83658','86199',
                          '81625','26696','89338','88425','32200',
                          '81427','19053','77471','36610','99823',
                          '43276','41249','48584','83550','82276',
                          '18842','78890','14090','38123','40936',
                          '34425','19850','43286','80072','79188',
                          '54191','11395','50497','84861','90733',
                          '21068','57666','37119','25004','57835',
                          '70067','62878','95806','19303','18840',
                          '19124','29785','16737','16022','49613',
                          '89977','68310','60069','98360','48649',
                          '39050','41793','25002','27413','39736',
                          '47208','16515','94808','57648','15009',
                          '80015','42961','63982','21744','71853',
                          '81087','67468','34175','64008','20261',
                          '11201','51799','48043','45645','61163',
                          '48375','36447','57042','21218','41100',
                          '89951','22745','35851','83326','61125',
                          '78298','80752','49858','52940','96976',
                          '63792','11376','53582','18717','90226',
                          '50530','94203','99447','27670','96577',
                          '57856','56372','16165','23427','54561',
                          '28806','44439','22926','30123','61451',
                          '92397','56979','92309','70873','13355',
                          '21801','46346','37562','56458','28286',
                          '47306','99555','69399','26234','47546',
                          '49661','88601','35943','39936','25632',
                          '24611','44166','56648','30379','59785',
                          '11110','14329','93815','52226','71381',
                          '13842','25612','63294','14664','21077',
                          '82626','18799','60915','81020','56447',
                          '76619','11433','13414','42548','92713',
                          '70467','30884','47484','16072','38936',
                          '13036','88376','45539','35901','19506',
                          '65690','73957','71850','49231','14276',
                          '20005','18384','76615','11635','38177',
                          '55607','41369','95447','58581','58149',
                          '91946','33790','76232','75692','95464',
                          '22246','51061','56692','53121','77209',
                          '15482','10688','14868','45907','73520',
                          '72666','25734','17959','24677','66446',
                          '94627','53535','15560','41967','69297',
                          '11929','59403','33283','52232','57350',
                          '43933','40921','36635','10827','71286',
                          '19736','80619','25251','95042','15526',
                          '36496','55854','49124','81980','35375',
                          '49157','63512','28944','14946','36503',
                          '54010','18767','23969','43905','66979',
                          '33113','21286','58471','59080','13395',
                          '79144','70373','67031','38360','26705',
                          '50906','52406','26066','73146','15884',
                          '31897','30045','61068','45550','92454',
                          '13376','14354','19770','22928','97790',
                          '50723','46081','30202','14410','20223',
                          '88500','67298','13261','14172','81410',
                          '93578','83583','46047','94167','82564',
                          '21156','15799','86709','37931','74703',
                          '83103','23054','70470','72008','49247',
                          '91911','69998','20961','70070','63197',
                          '54853','88191','91830','49521','19454',
                          '81450','89091','62378','25683','61869',
                          '51744','36580','85778','36871','48121',
                          '28810','83712','45486','67393','26935',
                          '42393','20132','55349','86057','21309',
                          '80218','10094','11357','48819','39734',
                          '40758','30432','21204','29467','30214',
                          '61024','55307','74621','11622','68908',
                          '33032','52868','99194','99900','84936',
                          '69036','99149','45013','32895','59004',
                          '32322','14933','32936','33562','72550',
                          '27385','58049','58200','16808','21360',
                          '32961','18586','79307','15492')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2002
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '94211','79992','17147','73350','95552','95964',
                          '55561','83503','95291','81886','67803',
                          '14005','15352','35939','69788','69465',
                          '26210','94717','45717','20504','90727',
                          '73919','46409','31148','78856','51952',
                          '56658','59186','20236','39664','25479',
                          '78594','77585','48999','26659','40979',
                          '73998','58749','32169','88111','42206',
                          '17735','61235','40770','90216','73431',
                          '50635','94649','28503','62223','48465',
                          '98660','88750','62881','71150','74395',
                          '65573','54385','27053','75005','87100',
                          '46144','45752','48173','56128','44719',
                          '13165','47448','46589','98083','92734',
                          '59191','46743','32303','80247','49119',
                          '87663','28609','27220','75773','36942',
                          '88769','31029','11970','65289','54157',
                          '39828','16573','76507','11253','86979',
                          '93912','46157','41126','73708','43288',
                          '84025','93128','25843','83277','97822',
                          '12152','60970','20713','52014','13766',
                          '12054','67524','33300','81540','48540',
                          '34617','13904','20941','94950','41828',
                          '25750','42074','23769','80831','69469',
                          '94240','81975','91729','70390','66360',
                          '31770','51726','21985','90413','37770',
                          '89417','36432','11876','30715','40941',
                          '52138','25940','18308','41432','27325',
                          '32918','25864','68460','82185','33659',
                          '50905','45481','23148','84826','23289',
                          '64959','33374','75583','98214','40895',
                          '60252','68911','86559','47921','91792',
                          '21767','16714','36192','57781','23460',
                          '84556','95705','56373','34965','71858',
                          '67078','73474','83617','62740','31550',
                          '74359','90454','61357','79723','62749',
                          '69805','61783','48116','67366','32388',
                          '58504','99336','74644','85173','46041',
                          '28570','53752','44252','54305','67674',
                          '86596','97055','37196','54915','18790',
                          '32477','91830','24899','30659','69429',
                          '95386','41803','68146','90045','16572',
                          '65641','19959','43400','65967','11384',
                          '57058','73504','95723','95544','79738',
                          '52586','35436','39511','90114','67467',
                          '72042','93043','36460','68016','47066',
                          '36386','50886','59969','67561','96727',
                          '38794','40261','99622','68122','79229',
                          '61578','93750','79261','55336','34752',
                          '91425','74438','61232','39795','62410',
                          '39956','60094','57080','31815','35656',
                          '94130','65256','50034','96324','55887',
                          '69118','50706','19297','64728','14124',
                          '28972','68872','25699','61631','43656',
                          '84696','44847','55497','84007','53896',
                          '33193','63127','50002','92416','82870',
                          '72477','74061','97137','55994','26823',
                          '52147','78636','82211','29813','55691',
                          '54536','38580','60289','80266','81486',
                          '37739','58338','73713','16747','96061',
                          '29870','50644','69262','22387','58433',
                          '55314','60475','21391','14081','11028',
                          '69126','12943','68242','61807','55397',
                          '30981','49541','49422','60652','59552',
                          '44648','52906','74398','53160','27696',
                          '35803','19865','86380','13454','20648',
                          '70423','69100','45747','53046','71352',
                          '47386','23475','16902','18566','59929',
                          '28020','41953','59232','91434','57898',
                          '73452','76395','87527','46974','97877',
                          '20274','69056','60363','38187','10194',
                          '31880','18201','31666','38224','81782',
                          '62771','49892','17579','80473','80507',
                          '92101','93259','65722','30057','61776',
                          '38037','65719','66683','44040','48584',
                          '62751','90127','24971','44330','65895',
                          '29111','55957','53417','87081','11164',
                          '40693','48761','34746','11925','59373',
                          '61194','29863','53584','94406','86488',
                          '23160','66428','40619','14250')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '14127','16281','67602','52068','35969','39265',
                          '66860','64000','19690','98788','42570',
                          '55696','21383','84706','92577','53412',
                          '49928','47291','50939','13438','96889',
                          '85931','11958','40521','45603','81074',
                          '73022','21993','55294','53532','29650',
                          '43909','40750','91836','19129','98235',
                          '14117','83897','41129','90470','54233',
                          '33371','76782','80988','18736','12796',
                          '65743','37875','87805','70965','89906',
                          '66274','77607','71034','26880','35907',
                          '11659','92672','64763','21800','54823',
                          '40135','24502','23210','78954','20029',
                          '41220','83925','53290','21289','91841',
                          '26480','13291','39470','30801','20990',
                          '21028','70826','44539','98802','24594',
                          '73040','19478','99068','96326','49003',
                          '12388','84252','60872','97534','15487',
                          '11822','76208','79879','96165','82622',
                          '49848','67789','59095','10168','10768',
                          '61873','28832','95625','18159','13110',
                          '33725','71809','85262','56794','97189',
                          '60015','23730','19352','18592','52742',
                          '60992','90058','96247','26194','81163',
                          '99315','60911','42024','68978','17126',
                          '96315','60009','61045','74176','49923',
                          '43154','73278','91351','91783','18315',
                          '78594','38729','90296','66254','36549',
                          '95236','54066','68047','15412','52680',
                          '52578','77635','34247','87907','85104',
                          '23694','85162','75441','95618','44769',
                          '52848','35561','32925','30474','51831',
                          '61214','47052','66017','55020','77191',
                          '98153','79679','40325','54426','69141',
                          '45470','95039','68573','63007','84855',
                          '96003','62053','79569','89520','25017',
                          '80600','22729','85191','55028','56860',
                          '34654','81599','90861','79794','33617',
                          '28949','83613','43632','27750','88477',
                          '82345','41429','34421','16194','88680',
                          '28458','32277','35875','18808','92860',
                          '80402','17337','89373','36275','10055',
                          '68265','38275','42703','44417','75376',
                          '38224','68258','15438','17711','80107',
                          '78902','43475','84777','48189','23536',
                          '19892','58195','21937','47584','39483',
                          '18410','20796','15480','38262','48413',
                          '74793','79412','49189','20702','82798',
                          '79587','14052','96657','20619','87735',
                          '69522','54317','18374','46199','61100',
                          '89621','67909','56796','82506','31138',
                          '40777','65470','12430','66114','66077',
                          '29742','69152','98701','63409','53253',
                          '58916','89141','29317','18870','43899',
                          '39456','88172','28417','86371','68947',
                          '22609','10405','95849','20635','47127',
                          '94183','61309','53230','53647','48785',
                          '53844','30419','62732','70672','77625',
                          '51869','41882','83428','94254','96920',
                          '77312','43272','80412','78571','97428',
                          '76243','62129','32188','26713','75372',
                          '71007','98565','44684','85562','72440',
                          '97111','79601','85277','14316','68745',
                          '18789','34237','52148','30722','66776',
                          '15963','41299','54406','45770','81138',
                          '86540','45966','17806','47554','73576',
                          '20054','83536','67827','30930','95375',
                          '69638','47187','98440','78784','53511',
                          '92217','67283','77760','41456','43869',
                          '36433','17847','79486','32997','57796',
                          '70976','82040','10162','58352','97153',
                          '14203','31744','37755','60324','56513',
                          '27706','39225','28100','43068','84379',
                          '32572','92862','53661','36898','90715',
                          '89526','14735','44819','73827','32724',
                          '11296','30590','99794','72800','63645',
                          '13864','40604','31601','82627','23771',
                          '94441','43049','76218','39966','17617',
                          '16156','11531','45899','50702','80431',
                          '90509','91213','41532','28400')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '55641','65242','94981','85648','53844','23794',
                          '33983','92931','78867','79190','29659',
                          '75761','62501','24696','16323','78229',
                          '20494','81117','38308','14413','58789',
                          '76856','73053','43280','72630','54819',
                          '95775','29872','36804','53239','54458',
                          '62028','90180','14108','69114','55454',
                          '11589','60631','48981','16837','12224',
                          '51090','94489','66557','46498','64913',
                          '47072','78585','77082','52654','35707',
                          '10516','33902','38058','84075','53145',
                          '68438','86143','48504','59753','34783',
                          '46570','30400','41956','92510','23207',
                          '37391','44202','15055','62134','78747',
                          '95192','93113','39393','56491','36663',
                          '15745','48935','87514','14130','53028',
                          '85058','51404','21560','61323','63732',
                          '25000','11268','97871','88847','10033',
                          '13702','54187','12764','10709','27261',
                          '22804','46189','65710','29152','75512',
                          '16385','22886','41085','67860','77126',
                          '98809','19208','36505','92267','24561',
                          '65072','40376','63385','36721','93992',
                          '90061','19509','95786','92781','47192',
                          '20336','39502','18497','22333','51130',
                          '58549','37676','53935','11250','86101',
                          '75255','23319','97644','75559','24988',
                          '25494','63592','48094','73093','93713',
                          '96111','63196','62083','38653','80300',
                          '29552','61348','39149','64079','17410',
                          '30562','94600','17590','25709','32630',
                          '88376','35546','71201','71396','60863',
                          '13123','80102','66836','28348','88213',
                          '21320','21497','88026','90040','16658',
                          '18262','56769','90188','15294','82832',
                          '63462','39810','57277','31548','39735',
                          '12726','58767','85761','60026','31406',
                          '87330','94315','10847','91870','83245',
                          '31408','27512','22188','53209','96028',
                          '89114','29799','56039','45890','24019',
                          '76901','79489','78850','84594','58282',
                          '82343','67652','56167','93533','80566',
                          '30396','24271','27682','64999','42169',
                          '48284','31138','58472','14444','43290',
                          '90744','79873','74966','86439','23393',
                          '56033','86490','91190','34977','86423',
                          '58695','67413','98200','13128','76423',
                          '39759','54772','15304','74391','12231',
                          '36492','73585','22725','35991','86113',
                          '24222','92685','87944','49538','32483',
                          '76678','46054','45765','69080','22938',
                          '85544','54316','91288','67420','56626',
                          '19120','99359','36799','47693','97975',
                          '81806','85504','93348','39622','27380',
                          '31293','48992','87922','35831','38387',
                          '10457','31179','28490','44535','50489',
                          '80227','19469','34414','47837','22426',
                          '44124','43577','70673','44653','43912',
                          '57676','41767','75296','30566','70936',
                          '21708','92649','53379','20117','12205',
                          '75406','17743','73277','53251','88942',
                          '11760','69361','94797','46506','66512',
                          '56123','40509','18529','43928','74193',
                          '45318','17425','62189','27582','65607',
                          '20095','73801','20280','42893','28935',
                          '18593','70051','21145','55373','61012',
                          '33354','59945','23140','27794','62898',
                          '24469','68795','17703','84704','22551',
                          '79418','68762','26652','40624','24196',
                          '17729','64138','85308','10388','44628',
                          '55929','45084','27545','57780','41287',
                          '34908','40998','57319','38483','54690',
                          '97585','20415','72782','15240','61773',
                          '93181','93365','58975','15804','62386',
                          '15197','15434','21840','25334','63957',
                          '19664','83898','65551','21430','55932',
                          '49681','14532','15002','67425','11631',
                          '86009','95668','96675','60058','95662',
                          '20558','79167','11531','53082','75858',
                          '75616','19747','25506','34796')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1999
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '32490','80133','59564','27233','31195','74873',
                          '49881','13892','86207','75229','65896',
                          '23072','22835','33052','72756','87398',
                          '45674','48994','39431','20846','66681',
                          '65151','94085','37562','17374','40551',
                          '46813','27027','65540','25438','68986',
                          '63254','57831','66390','85787','19152',
                          '74046','33775','52283','21619','36554',
                          '67172','54289','45204','80935','43344',
                          '64283','30424','34055','77848','35728',
                          '25600','97795','76654','19815','17081',
                          '21040','97661','41336','36523','37437',
                          '28645','35340','51449','93082','79408',
                          '35536','60725','19517','10373','64505',
                          '43894','89282','47657','49668','10230',
                          '45233','23784','53712','22443','75091',
                          '55094','19397','90929','17945','48661',
                          '64741','97815','19675','13063','80566',
                          '89785','15734','67718','23645','98852',
                          '81276','26639','35287','20813','71390',
                          '22970','82989','91358','35225','25402',
                          '91462','10654','13987','14795','64804',
                          '63781','49236','65485','17910','95923',
                          '39071','27201','68045','25588','17939',
                          '43782','74656','46429','32012','37539',
                          '85167','24503','50296','13486','84526',
                          '24023','22302','93280','68039','88738',
                          '41665','16136','40887','77281','88472',
                          '43699','49458','84968','27482','54271',
                          '61812','11596','10198','75859','59166',
                          '13824','54360','24990','40678','83853',
                          '18308','77081','64728','54301','39240',
                          '22549','88564','86354','19498','45730',
                          '60561','84545','28627','69495','22716',
                          '64853','76113','52205','56548','96326',
                          '68928','14901','96908','72550','40769',
                          '68253','85910','41588','57779','32502',
                          '73174','36235','19833','24542','37097',
                          '16758','32271','23538','62335','10019',
                          '97239','98318','15239','57446','42865',
                          '26330','83840','37114','11286','81632',
                          '12544','92809','43767','78584','83823',
                          '15036','63713','47975','63902','63292',
                          '25430','21182','59057','86422','49121',
                          '40027','81419','43925','20524','87983',
                          '21822','68191','76417','93014','63909',
                          '86640','30566','16176','50935','42919',
                          '51350','11631','85160','84840','64709',
                          '90765','97089','21806','16816','68294',
                          '39747','60921','35749','95100','51838',
                          '11721','33857','76555','58545','31814',
                          '87804','47999','69497','91498','17845',
                          '45225','17567','65864','50319','57774',
                          '77123','83613','50464','17503','40533',
                          '99960','94458','80012','49246','19702',
                          '67202','71266','43596','90358','54703',
                          '38674','16511','13010','84297','80138',
                          '50495','59286','61377','82813','84072',
                          '10775','92602','23383','78574','51189',
                          '99628','37223','40927','82218','67970',
                          '60622','75356','14696','86530','20282',
                          '73480','90684','82414','30411','79303',
                          '73396','42212','30379','11648','96036',
                          '33147','83350','10603','63986','53794',
                          '66233','12557','61902','58867','11765',
                          '49301','85512','64079','71983','55686',
                          '14321','31747','42910','51179','48814',
                          '98103','90450','44160','66586','82162',
                          '82087','28216','93605','64647','81083',
                          '30520','39257','77366','58370','95989',
                          '11154','83201','92181','50984','95103',
                          '67822','45454','71812','33151','14137',
                          '84208','71044','66111','66351','47974',
                          '78642','71186','39450','83373','80020',
                          '14803','54550','48784','44462','26683',
                          '84275','79531','88149','85090','92941',
                          '63518','40347','54000','55782','85163',
                          '12516','66948','36635','26691','28575',
                          '83438','69170','30158','90030','52806',
                          '51997','63427','10649','42552')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1999
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '82912','16429','56372','94900','62843','98356',
                          '52140','91472','15284','30074','93060',
                          '87466','18023','12326','44629','72686',
                          '65854','17347','98884','94591','57710',
                          '74359','36064','15618','60047','83880',
                          '82758','48091','26772','32314','20650',
                          '23630','46805','13250','58970','87436',
                          '47667','37587','18693','59634','42981',
                          '84376','96058','21067','27798','14989',
                          '43259','24113','59807','61526','94954',
                          '78396','86864','76708','43124','17625',
                          '92671','46759','49146','66589','44376',
                          '79907','36181','96595','94595','30916',
                          '53727','73961','10742','36464','93749',
                          '74952','74791','59319','40362','88948',
                          '34103','44473','20557','39900','63196',
                          '23003','95474','84162','15186','16107',
                          '14725','24701','18388','89640','91829',
                          '83071','15027','61070','48078','10778',
                          '32885','55230','63841','68671','74466',
                          '33073','14604','66268','20819','96366',
                          '42451','27427','67755','61001','59395',
                          '25784','68106','36351','15724','31556',
                          '67270','83617','46640','30862','39269',
                          '44761','48968','77105','37871','20427',
                          '45744','65622','50828','91024','27516',
                          '40940','57469','24886','23441','84768',
                          '88601','15790','24862','38732','42379',
                          '15695','82454','79895','67554','10635',
                          '12145','40628','19386','29665','81476',
                          '60866','95975','30130','31535','37504',
                          '29499','25361','37631','54841','91571',
                          '25560','53494','81936','82095','21287',
                          '80936','51321','47181','24783','62263',
                          '20208','55880','46400','36050','59418',
                          '65971','61720','51511','76912','63529',
                          '94232','79488','62294','79472','21223',
                          '76802','34750','58792','78745','39187',
                          '20338','95230','63343','67667','63893',
                          '17279','15233','97222','90855','49321',
                          '25027','23130','40088','36066','59264',
                          '16862','55611','16079','15729','72696',
                          '77750','81369','19667','36334','99062',
                          '62644','30761','58447','20290','41781',
                          '39154','62125','31985','79985','41220',
                          '76500','24620','66099','21170','69063',
                          '75880','99776','10598','34081','35502',
                          '66895','35976','73763','87439','10843',
                          '39478','66252','33453','83542','12158',
                          '39735','11020','16094','64529','99318',
                          '27585','92693','60404','79506','82771',
                          '24642','53279','30009','44667','15445',
                          '79761','60182','27949','61864','17804',
                          '60952','72053','50534','57020','83098',
                          '71902','67843','36673','62298','45404',
                          '33046','85908','46923','50477','63165',
                          '84028','96235','12060','11599','83010',
                          '83255','97492','76842','33951','59429',
                          '89494','93219','15474','19054','32108',
                          '50555','37995','70185','19168','74455',
                          '46667','76431','94222','11697','38850',
                          '39162','53248','10579','74858','87860',
                          '48585','56050','25216','86584','54729',
                          '25416','88992','78126','64505','91520',
                          '10180','65006','74577','94312','53340',
                          '78341','84242','43333','37864','92080',
                          '68430','86211','94781','15901','27464',
                          '61649','84182','23261','28413','75217',
                          '44022','45930','70846','29107','91783',
                          '42754','84393','16174','32053','88758',
                          '40832','64059','22961','88379','66734',
                          '22304','18788','75385','37435','42427',
                          '10585','81738','18047','70152','48840',
                          '78295','84844','36923','45111','44709',
                          '57834','22783','18441','51641','56713',
                          '25706','13654','86335','58366','13245',
                          '56269','41052','75674','85272','82342',
                          '92694','42295','50147','44504','24644',
                          '32011','71053','30631','26418','46781',
                          '37768','10116','91468','95133')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '15649','97176','11360','24494','95632','70829',
                          '13920','20200','71516','43566','64761',
                          '14371','53335','39963','35318','86348',
                          '69458','25752','38869','45374','84336',
                          '56953','46991','43630','13511','62831',
                          '18652','60853','61079','22429','70700',
                          '94674','36533','86246','45046','75688',
                          '87524','42949','15199','11458','62631',
                          '19163','25215','38302','77584','57121',
                          '77920','35077','20124','41697','42012',
                          '80974','34191','72215','40589','98087',
                          '60714','32206','45649','77868','91274',
                          '50134','10194','63169','48654','13691',
                          '56763','50550','11863','90278','74108',
                          '77386','65216','19678','14873','79800',
                          '70639','96537','95880','14642','78622',
                          '49704','87013','74044','65119','45127',
                          '41477','43403','80431','30916','45101',
                          '20266','35688','23097','40317','92254',
                          '46593','51307','67598','35427','21637',
                          '54133','95472','43230','60681','26367',
                          '96563','46070','49787','31523','38503',
                          '59099','63600','87308','26194','62098',
                          '49512','92542','45800','52600','94197',
                          '69741','21041','16703','62300','18307',
                          '27973','74633','88169','16625','37777',
                          '31628','54479','13057','22995','82447',
                          '60985','11425','87516','89804','70889',
                          '27175','94215','95471','94619','24322',
                          '47102','76579','11880','42729','17087',
                          '56261','80423','99752','50486','12143',
                          '11171','67932','79840','95301','92265',
                          '66338','91731','86557','50821','92884',
                          '38075','68951','35468','60592','72759',
                          '90361','84040','35063','47344','80501',
                          '98040','52919','85872','43919','51079',
                          '98329','29393','79122','72427','36702',
                          '24159','31016','98824','32545','85510',
                          '29492','96659','29763','31063','37533',
                          '63797','37369','66140','91245','58016',
                          '32788','49214','28211','89512','77950',
                          '28147','76974','38547','61447','22275',
                          '62125','32551','45994','14586','14100',
                          '42707','13565','29162','20957','34311',
                          '60299','41933','88106','17152','77062',
                          '71739','22227','96166','26383','89033',
                          '24221','14853','33951','47050','19103',
                          '69581','43820','18618','87654','58992',
                          '40373','91682','84541','74140','16555',
                          '20380','59341','19033','89178','53282',
                          '36260','62550','62025','94519','98393',
                          '43612','61451','46663','47520','37806',
                          '43418','70016','72504','88593','28437',
                          '73828','39659','15774','33551','26000',
                          '58506','17779','83210','58170','35925',
                          '64047','87926','52017','10473','47957',
                          '27050','90439','70545','81391','94703',
                          '32465','33114','83491','84583','82495',
                          '70071','88087','29557','89594','69039',
                          '77336','92848','92344','77266','32173',
                          '55542','95320','24332','13227','30839',
                          '46895','56687','10967','74162','11645',
                          '72462','87782','71803','21003','75424',
                          '33182','35552','46114','10639','76229',
                          '40375','43378','86016','27721','79311',
                          '98727','41952','39383','40967','35765',
                          '84366','31986','30304','42764','86670',
                          '43923','64577','14049','98434','13403',
                          '24805','70147','56387','78555','88271',
                          '95464','92040','82860','93850','45363',
                          '24257','67949','23664','12018','50458',
                          '81813','74815','77209','90540','15519',
                          '18714','38489','78960','78483','14855',
                          '25410','89318','34245','72407','37184',
                          '95451','60775','53607','25725','25574',
                          '79734','69066','82972','45655','64265',
                          '54047','85323','53842','71367','11320',
                          '73201','79231','93945','69444','96619',
                          '43755','33788','90027','37267','53417',
                          '71664','75380','31243','14280')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '77465','97995','72537','21900','42499','52330',
                          '83610','73167','15686','85030','46804',
                          '88233','65158','12472','53269','80508',
                          '24560','52813','81622','16418','58991',
                          '50537','27152','54999','16785','82675',
                          '76889','81395','55130','38896','14208',
                          '98598','66935','52476','64233','90009',
                          '18332','49832','30797','45499','79663',
                          '43550','36279','99439','70375','30001',
                          '54009','69517','69740','59166','39009',
                          '96191','87649','39365','38379','45582',
                          '97450','45053','43288','46058','45113',
                          '47915','91376','89267','18138','72838',
                          '51397','38489','30740','73330','30795',
                          '16409','40256','53770','95419','51779',
                          '35561','83054','75117','24060','98388',
                          '42093','87121','82328','11033','57947',
                          '17917','74350','99900','61796','33493',
                          '99641','37504','66987','68014','65720',
                          '73105','26199','91335','17785','47313',
                          '62391','70292','15180','29492','65259',
                          '81625','69908','48239','70434','77483',
                          '24399','57375','25135','45747','11531',
                          '42789','78192','18654','86653','90239',
                          '77981','56007','26458','93115','75238',
                          '53312','12453','13404','35264','94144',
                          '90302','17422','18112','52238','89482',
                          '50734','44227','47560','28406','42543',
                          '41638','76496','87800','45526','41726',
                          '89427','11366','63993','58761','23561',
                          '82202','77510','90870','65019','99090',
                          '37461','21030','20086','36115','72203',
                          '46791','51062','22342','16184','24835',
                          '63840','33770','18818','32561','41117',
                          '16725','93309','57913','77395','41849',
                          '69152','75768','50195','92692','74443',
                          '14704','51107','43524','79407','71004',
                          '20227','40386','66426','74289','96908',
                          '49399','62680','82289','14104','82830',
                          '90876','34874','74969','77895','68353',
                          '83811','30134','63490','49806','73141',
                          '77733','46489','89660','10935','27003',
                          '79364','77982','12882','33558','23370',
                          '60564','14983','24939','33447','63759',
                          '16462','70273','15189','63406','42185',
                          '32505','63108','48305','83529','31536',
                          '76094','19184','83590','33560','93962',
                          '32510','98269','12912','80541','99138',
                          '51278','27848','90747','14890','91593',
                          '74080','54731','15976','12289','45422',
                          '55999','22900','17535','28293','48231',
                          '50488','80367','24273','67884','69225',
                          '80496','22359','47461','12915','45218',
                          '91034','84049','11455','15766','97588',
                          '24927','49694','31029','60639','32025',
                          '30265','71497','60326','44707','90330',
                          '39539','84911','73782','43783','65204',
                          '42466','37845','70726','36584','98658',
                          '23536','31272','76587','36960','98215',
                          '66851','51442','13313','57121','90226',
                          '98625','91584','55432','51860','97515',
                          '50220','91855','70844','81729','94215',
                          '27426','77085','41373','91641','91399',
                          '41262','87202','32971','28564','80190',
                          '32532','78675','26993','72447','52550',
                          '93469','94488','34282','66268','69331',
                          '25830','51007','91581','29966','83846',
                          '70752','79546','42087','82460','52786',
                          '66746','20182','17010','55861','51876',
                          '23805','40636','51267','37212','81557',
                          '27311','33246','38973','80038','12735',
                          '20676','23267','36439','71060','74201',
                          '18946','37237','48913','79605','33851',
                          '99932','49974','34725','13531','13242',
                          '63267','51214','14542','57525','50551',
                          '34631','32594','27557','14478','11548',
                          '66318','88581','38329','86517','99349',
                          '29495','94651','51906','48404','92612',
                          '61791','81485','86188','45253','88898',
                          '56706','45106','88875','78579')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '77661','12172','48633','30522','77516','47593',
                          '42736','13431','60328','51004','58830',
                          '73231','71595','92456','44605','64787',
                          '50000','56786','59080','41562','41317',
                          '26178','77460','24505','44648','61157',
                          '13884','60939','92187','63308','18653',
                          '73267','76681','88231','91314','74382',
                          '75606','29255','83554','46014','65895',
                          '50527','19535','23406','50114','61466',
                          '71101','73924','91310','84787','45297',
                          '25515','68057','15152','86347','88689',
                          '86473','50762','73297','21927','92168',
                          '76750','42285','63085','87127','94952',
                          '35208','42352','86699','98853','55431',
                          '94022','59292','39267','10988','14027',
                          '88033','31548','64656','64512','18602',
                          '10987','11720','55625','19973','52110',
                          '62644','78897','99512','66942','53325',
                          '70523','75029','18193','47516','96854',
                          '81962','81713','91216','29121','80380',
                          '40713','15209','50902','22005','14580',
                          '29238','73890','30936','29189','97505',
                          '24818','64230','91895','38383','19044',
                          '38267','16085','52139','48122','95943',
                          '13984','64043','14978','49016','97128',
                          '93772','14165','91610','38123','34007',
                          '69476','76457','72132','21390','47749',
                          '37146','84573','63802','12827','60529',
                          '76981','57559','23016','93676','56982',
                          '86490','36898','92619','33273','51562',
                          '35923','10366','78029','60253','22718',
                          '85212','15723','61055','79099','22567',
                          '45156','61470','66324','29587','34043',
                          '34227','53678','21955','39619','75643',
                          '51511','40586','90275','44572','42544',
                          '43791','13860','44862','39928','87728',
                          '94568','34480','70964','98578','44326',
                          '45839','66931','42597','98820','52995',
                          '72960','70171','79195','16334','65832',
                          '58766','29846','57002','28957','88020',
                          '43307','50922','38774','15259','41193',
                          '61960','62508','35487','26330','45824',
                          '92253','23296','68030','31515','19769',
                          '40502','71085','54574','36213','56352',
                          '55190','82114','73270','48477','41413',
                          '30645','42093','78603','91322','51853',
                          '47847','49129','26639','45520','52677',
                          '85032','79762','83843','37492','88618',
                          '21246','61452','27527','35458','95902',
                          '31273','62479','46299','80444','99543',
                          '89604','86602','89989','97557','95208',
                          '90174','47678','29040','40582','96188',
                          '87296','81077','14110','59332','79030',
                          '36974','87957','31422','74945','73824',
                          '77574','34618','80026','75507','70507',
                          '48515','95175','76862','42324','92637',
                          '88631','87734','88877','49347','86828',
                          '95755','77909','41381','35294','20519',
                          '64833','22968','87085','53177','89833',
                          '59398','17607','20589','38856','45237',
                          '61536','34481','24375','96936','46029',
                          '57685','35229','39688','50903','41271',
                          '89837','76868','97935','65752','46213',
                          '25002','88792','76658','84635','23513',
                          '93300','49474','62205','45199','38889',
                          '63170','62794','92784','55129','89426',
                          '18462','89987','14644','98666','97414',
                          '65282','25277','34067','12478','78150',
                          '46564','60063','23990','74238','16654',
                          '91228','28010','67934','82207','79409',
                          '52936','54861','80268','74848','16098',
                          '87271','71472','29436','70919','99727',
                          '50661','25684','60808','36672','78116',
                          '75339','12832','86047','68857','14486',
                          '41324','54118','84326','35624','19798',
                          '56221','75850','72679','66290','55722',
                          '48721','91406','39882','46691','10489',
                          '53674','62555','64484','70113','67138',
                          '87273','10558','79037','20966','84340',
                          '52873','91404','53064','57042')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '41997','76861','10255','66115','77066','91619',
                          '14077','13159','82549','46801','96716',
                          '57292','61178','29690','26494','37527',
                          '79770','52650','78897','67576','53435',
                          '94509','36254','60024','61274','93006',
                          '31463','22110','38721','54522','13110',
                          '43696','28969','34480','37762','55369',
                          '74314','68127','61755','61095','50007',
                          '92328','78545','47422','19765','15787',
                          '53332','93155','36803','16970','34637',
                          '67307','96667','56956','12873','89780',
                          '41908','83971','94066','22075','14188',
                          '93752','47603','83781','62371','15023',
                          '51729','12079','18545','60789','92723',
                          '49736','62164','86402','93795','26879',
                          '94367','14752','52151','64691','77944',
                          '10512','25102','98934','68220','90199',
                          '24834','73571','35390','28982','59172',
                          '18786','64902','93527','66696','48527',
                          '15169','36763','31958','31594','31037',
                          '56512','31876','43661','81674','78032',
                          '34495','46481','61507','29227','61656',
                          '24684','62042','63354','92507','28466',
                          '76876','88243','55038','64521','19255',
                          '94230','96324','91542','73359','28381',
                          '21334','63681','71059','97357','11902',
                          '33858','66551','82585','34875','41250',
                          '37459','77616','64198','49467','21497',
                          '24600','76491','53249','10716','38882',
                          '17153','64275','82415','68643','76783',
                          '98797','67960','96190','81244','49322',
                          '34644','16195','90894','26338','86453',
                          '65413','87615','61242','41677','69210',
                          '58523','87075','83263','24569','89961',
                          '14239','23541','11660','55686','47923',
                          '12882','58013','59363','91239','69417',
                          '38453','84695','64964','83935','29356',
                          '57730','71432','42441','73321','32114',
                          '38975','29657','95870','17507','58366',
                          '80756','49043','15888','23324','72549',
                          '45268','35241','25573','87606','44619',
                          '24782','23652','55133','69858','57798',
                          '37273','43674','70148','23156','63530',
                          '95030','87645','28625','94090','97622',
                          '68017','78391','71346','12826','94847',
                          '31654','57726','39611','79581','42532',
                          '31783','84797','70737','53694','90114',
                          '80196','16553','40876','13832','55940',
                          '26068','46817','73501','83070','78022',
                          '83862','79852','83649','35914','18178',
                          '77966','47754','91259','98430','68527',
                          '61801','63326','19878','80959','42018',
                          '32867','44242','35775','22184','10574',
                          '41621','73769','19260','42569','78445',
                          '90458','58375','85276','17241','71947',
                          '44702','18562','93116','12099','98009',
                          '64705','17221','31855','43297','85718',
                          '47741','55653','48755','11614','18707',
                          '90227','42936','74787','52622','20702',
                          '91843','69537','51456','33361','70008',
                          '64435','40845','32016','72230','23765',
                          '20879','53918','11917','91348','58682',
                          '97674','43575','56888','91770','64957',
                          '23640','17336','30170','14464','74126',
                          '38474','36868','40348','89543','21419',
                          '30472','53905','78767','16293','50845',
                          '45987','95054','52680','60265','79551',
                          '89750','62789','94555','13380','98048',
                          '89059','47757','70812','15357','64880',
                          '13541','43887','49271','34021','17223',
                          '63152','86071','51408','33045','93350',
                          '41600','88946','52126','66012','81020',
                          '31549','30188','31861','14616','37126',
                          '53898','29348','38643','97816','17522',
                          '53494','55807','32509','47822','89966',
                          '69677','39965','54885','46084','97211',
                          '57160','53914','42915','91089','15110',
                          '10040','92648','22296','34054','16844',
                          '83423','89823','83143','69868','70411',
                          '60169','95884','66336','10674')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2002
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '11967','50753','31853','43636','46408','66484',
                          '37430','48281','62224','34846','48043',
                          '26919','12065','55469','11906','18006',
                          '92437','24612','30362','32936','95274',
                          '50736','34495','80319','44752','75561',
                          '63231','49156','38515','63908','78615',
                          '33750','60063','97996','90127','17852',
                          '57464','98312','74373','68290','66917',
                          '72624','76548','82154','85079','46516',
                          '47522','26999','53513','35459','84405',
                          '63167','18143','39322','76550','46069',
                          '33408','91019','23449','12860','86536',
                          '81077','42627','99133','85432','91674',
                          '77451','88747','50803','59869','31522',
                          '62679','75115','31269','83525','86629',
                          '31037','42665','53764','18195','49313',
                          '28547','21511','82761','50777','56598',
                          '12359','55580','67592','30610','13470',
                          '63045','13405','37336','54820','64372',
                          '73890','38878','28618','97292','46205',
                          '65805','10979','16303','83872','28594',
                          '26145','19274','29759','21339','93794',
                          '45477','28775','59342','49865','20278',
                          '35228','89935','92889','22772','77651',
                          '13202','87176','24350','39623','80624',
                          '70845','47861','86450','28792','96217',
                          '98717','65068','86257','25779','82124',
                          '82906','74677','70070','48100','67797',
                          '98511','94635','90134','31208','18540',
                          '97815','15765','26521','25293','92693',
                          '53786','39150','76795','20618','16735',
                          '19622','49120','61595','58494','35023',
                          '33998','32924','89401','79885','47244',
                          '22429','67681','86625','95482','59767',
                          '68594','57018','18199','31251','63871',
                          '59260','55432','95019','22803','88253',
                          '80770','43946','95018','88406','57026',
                          '61070','26416','37251','64752','41981',
                          '12991','26704','24657','71934','48130',
                          '23468','43321','23679','98355','59008',
                          '43078','98813','61896','30615','60213',
                          '53040','23572','20774','95908','62954',
                          '31539','77179','24543','14686','98543',
                          '14147','70075','49413','78151','81618',
                          '30697','84301','58150','64387','19294',
                          '22082','55714','45284','61193','35152',
                          '95577','87688','69811','83068','36905',
                          '86380','51003','72693','60678','23032',
                          '22996','59053','60228','34079','92347',
                          '12358','89458','22241','51682','55456',
                          '67687','96315','10740','45474','14001',
                          '26668','84537','46376','89269','11256',
                          '51663','38443','15106','68930','68798',
                          '86947','59785','19503','78618','88503',
                          '75687','74806','95521','27429','52553',
                          '41829','40369','51321','47795','24521',
                          '22271','21270','79750','31963','94106',
                          '69201','13197','54477','80427','68168',
                          '94117','81367','45893','45201','31844',
                          '15487','79672','73290','53189','67829',
                          '86025','41951','69233','23962','19780',
                          '85914','63408','98886','20501','94856',
                          '88690','12783','48347','77381','79848',
                          '55102','11536','86443','83354','21253',
                          '50186','99680','11044','42022','24980',
                          '88030','46443','12268','46064','69805',
                          '95238','13917','77547','50608','95828',
                          '58044','83527','43111','78552','62875',
                          '11993','10213','24101','97340','53937',
                          '82480','99190','71296','74625','82818',
                          '39527','30470','85289','93308','12061',
                          '91041','48585','13122','42083','86399',
                          '92650','21264','78111','96048','93186',
                          '39936','53819','84188','28654','68791',
                          '71056','33167','23810','34490','33568',
                          '79556','56181','55091','23057','11103',
                          '18202','30207','52126','60336','46879',
                          '94484','44334','70449','30552','15453',
                          '89228','10797','32604','15528','69884',
                          '52695','37452','25699','38813')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '84717','44016','89941','19345','50950','23366',
                          '27912','51465','85316','49103','96747',
                          '84974','16556','50905','20745','11569',
                          '96269','38605','74470','90448','71526',
                          '27230','72559','55999','14133','74834',
                          '50458','85987','51315','89294','80972',
                          '98692','85529','24436','82687','99776',
                          '20136','60524','91513','36905','44420',
                          '33221','60241','37420','85842','99686',
                          '10436','90806','52824','86165','68464',
                          '37778','10811','73076','28072','30446',
                          '34795','31261','77604','39177','90709',
                          '24540','49264','14394','44109','64591',
                          '19379','42503','41422','64446','38817',
                          '47813','47710','29639','96043','33343',
                          '55655','93618','55468','83376','80771',
                          '76199','19272','49440','86317','36933',
                          '33032','35004','31183','89522','55686',
                          '39986','51428','71694','10544','70263',
                          '88043','71175','52707','67783','98217',
                          '20063','86234','65345','57433','76920',
                          '22160','48674','20984','37639','95164',
                          '69061','59741','62824','77048','15503',
                          '80361','15755','74524','72368','49281',
                          '18074','36842','42578','69847','61498',
                          '53698','94654','54068','46818','96576',
                          '93800','55941','32876','82259','26864',
                          '91175','43936','18267','85673','70004',
                          '14208','19256','10186','81232','92543',
                          '52588','75645','20130','63923','37242',
                          '68006','31552','97218','50404','36428',
                          '73858','70140','70604','59408','54087',
                          '70306','70289','93670','67633','24568',
                          '21490','53407','56619','98292','82382',
                          '57020','93660','36060','37272','38036',
                          '92854','98343','79623','71882','91037',
                          '76083','23167','44567','61128','45277',
                          '16480','33502','92585','11917','32707',
                          '13647','48386','67866','66086','93475',
                          '49168','64886','99738','38097','60955',
                          '66468','56839','46194','64099','52918',
                          '27503','14114','46901','24265','85989',
                          '50508','78776','30103','48320','33980',
                          '97145','45361','93138','79029','49099',
                          '62753','93548','71420','89769','43153',
                          '37029','55883','74291','75605','55029',
                          '19191','62589','92732','67475','75033',
                          '17498','56659','10237','31913','58698',
                          '31742','64885','82168','25520','24445',
                          '17666','33228','96281','49560','89346',
                          '85143','24394','96410','83027','35551',
                          '56980','34167','79674','98913','69509',
                          '50487','20782','46770','44114','15687',
                          '24816','19688','58911','97303','77916',
                          '60214','45575','54835','86550','38685',
                          '76604','80488','71125','57340','57370',
                          '61984','49608','83743','92222','64102',
                          '33151','45816','12377','40532','64558',
                          '58298','38225','59705','96967','37508',
                          '76409','27474','21670','75692','66173',
                          '65940','67745','15429','16872','95635',
                          '12027','73213','28131','29402','32510',
                          '38728','45533','67499','19509','89853',
                          '97845','86901','62343','77514','82010',
                          '71770','50172','53558','21381','62780',
                          '44919','85259','55133','10408','97966',
                          '82323','31487','58351','35745','81939',
                          '43467','88209','58209','39666','51587',
                          '81444','92186','29895','84733','11032',
                          '27646','49428','97399','95010','35875',
                          '67718','61104','56352','27420','67784',
                          '52961','79375','94186','67544','72452',
                          '12230','88894','60555','62270','49885',
                          '62928','13701','24463','41109','49927',
                          '21069','12311','90652','82610','35469',
                          '33777','22535','92000','58078','53037',
                          '17990','14116','64994','73778','27071',
                          '61511','19771','67762','43211','83948',
                          '84412','51237','64197','27386','70114',
                          '26287','39943','13639','63295')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '88626','30461','41106','52673','93506','82111',
                          '44875','11602','20969','53461','10014',
                          '87670','28707','50003','11849','36202',
                          '72966','16094','70206','36443','66567',
                          '78273','27017','77005','14718','58217',
                          '54449','12378','51254','73026','22934',
                          '56166','94975','47961','95629','33445',
                          '34861','81075','33057','91120','35810',
                          '22897','91983','14764','83685','61105',
                          '77754','82939','78635','11422','37329',
                          '66056','90845','55728','58603','59606',
                          '72975','55051','23679','22462','98486',
                          '41149','69291','63441','20054','55469',
                          '19664','16712','96631','38270','86912',
                          '70424','26201','44690','79681','52676',
                          '97914','27524','18782','12550','72279',
                          '18588','44266','71849','71074','87964',
                          '40648','97411','54033','81279','40662',
                          '51929','58760','40417','93485','83926',
                          '20224','81909','55767','53576','74071',
                          '68413','37878','80312','34299','39760',
                          '22812','96166','35706','82071','81272',
                          '82290','34852','62128','34833','82441',
                          '79360','28984','23811','12029','46219',
                          '69798','13252','65630','23677','67933',
                          '21969','79540','35109','96877','51412',
                          '56375','65816','85861','51421','45234',
                          '10961','36743','83995','44262','43257',
                          '64142','41688','94716','30318','45545',
                          '60877','48520','48305','61665','34038',
                          '73621','33462','38856','65744','77493',
                          '96823','69548','27840','48349','83206',
                          '98977','51886','86611','41010','53550',
                          '36871','59959','17919','54849','41160',
                          '64589','21429','80105','73219','52783',
                          '10731','24711','65884','82650','87831',
                          '18551','43286','30493','32392','92426',
                          '33783','21347','93036','47251','14851',
                          '44110','92856','10814','79231','32274',
                          '64123','26823','89693','91235','14275',
                          '49713','73135','64737','67258','13586',
                          '38535','42836','13282','85016','56710',
                          '58770','85638','31201','42139','27191',
                          '61799','92299','15460','63761','30068',
                          '17897','11127','58543','33364','12948',
                          '69694','67070','67151','81799','19127',
                          '96394','62511','86307','59348','63244',
                          '29520','17261','12888','52171','50174',
                          '59542','85430','60998','54467','52224',
                          '45660','39648','71432','84951','18335',
                          '17006','63229','20143','90611','31150',
                          '32745','58264','23292','77637','57800',
                          '36596','34792','53486','36715','91674',
                          '32971','18376','75994','70235','32270',
                          '54654','54846','35743','68459','65713',
                          '34123','54913','63647','77090','18010',
                          '61312','56374','60993','61860','35593',
                          '93084','46312','95197','88185','56778',
                          '46662','91245','75671','74961','40502',
                          '36197','65492','65890','34426','48264',
                          '70160','92880','17493','51787','73249',
                          '70913','44035','91323','55968','93650',
                          '78376','50476','21151','79123','47179',
                          '19819','38379','15614','23561','51368',
                          '63231','74159','57244','78724','92400',
                          '42004','16856','54387','20855','50778',
                          '25406','46728','38162','53160','74284',
                          '72210','85838','63846','96818','27909',
                          '20060','35549','73372','78009','33407',
                          '75698','37278','60433','39050','24688',
                          '20007','83871','15635','47064','45561',
                          '71265','36073','10666','31738','32184',
                          '37262','48921','60029','37682','96594',
                          '42083','19118','73970','67756','94548',
                          '27908','86941','91993','30654','14377',
                          '68054','16210','48984','56589','34005',
                          '57942','55280','73882','51317','22154',
                          '81342','22523','86505','30602','36793',
                          '64460','46725','60034','93142','19971',
                          '92390','67266','72126','71076')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '28474','21420','57983','23572','88082','88822',
                          '78307','25307','43781','83182','98538',
                          '39203','76914','11261','21320','46659',
                          '93180','90483','46096','71331','59145',
                          '43944','24885','63103','94014','32828',
                          '15403','76200','21230','98193','35207',
                          '25695','49462','58364','96771','13387',
                          '72214','83162','79324','58425','65489',
                          '87425','28603','46049','23709','99343',
                          '67855','40403','37019','77001','50438',
                          '25495','45593','71513','23546','66853',
                          '20508','16638','28965','73149','59455',
                          '39759','70011','80144','25947','89004',
                          '24235','37699','67885','16986','56733',
                          '84710','91674','81162','70726','53265',
                          '86649','79775','41002','36455','38159',
                          '30259','78570','11806','86756','34055',
                          '93705','74842','56741','34182','60186',
                          '74687','44488','95522','15320','62378',
                          '45348','75561','26353','37086','11579',
                          '89358','26106','33167','43021','61041',
                          '64480','51660','78496','59615','27286',
                          '46926','21430','12929','46908','31997',
                          '73745','92144','58944','72130','21688',
                          '85866','14928','94747','39956','77904',
                          '60452','76232','97605','55755','53894',
                          '64475','46697','22312','18830','35173',
                          '12031','53502','66777','28628','62806',
                          '17339','86453','27454','97770','25127',
                          '82151','12964','63563','29122','13399',
                          '34816','47158','69065','81911','60170',
                          '74519','79593','60304','24127','45596',
                          '56373','77110','87758','66907','72912',
                          '92844','39034','84967','23236','34625',
                          '14568','84113','69298','68553','27593',
                          '74200','32292','41479','37043','52170',
                          '87177','92683','11590','73517','78299',
                          '57624','66794','86266','48194','39967',
                          '19016','16338','30518','98219','55209',
                          '88247','33484','84251','38246','13719',
                          '30819','26414','33321','25090','37358',
                          '17167','55637','30778','91828','74300',
                          '62526','40251','54896','59808','56748',
                          '54337','99461','76957','95430','46032',
                          '21608','88380','60080','77635','73202',
                          '64799','12028','43905','11928','87689',
                          '92894','52568','54266','46346','65192',
                          '67303','70470','76603','31672','44482',
                          '71996','53152','91413','17027','45641',
                          '63116','53602','80492','22678','89107',
                          '94258','17209','89965','74397','11771',
                          '98039','27125','35903','17393','20985',
                          '31215','85492','22046','18254','18946',
                          '82853','13079','48665','93785','64564',
                          '84749','28687','61413','89846','38002',
                          '68131','56112','74409','74656','39252',
                          '79121','42517','26175','54379','96262',
                          '99363','56729','50166','14186','55442',
                          '18289','13950','28054','25180','56907',
                          '59872','33444','21631','63376','28046',
                          '18642','52452','88664','65102','14654',
                          '72982','99462','38203','67352','99110',
                          '71731','71650','92975','68002','32272',
                          '66868','39176','21228','46921','12529',
                          '37933','12331','73818','92202','44174',
                          '59609','63929','14914','64347','51376',
                          '77561','14192','17608','74458','42033',
                          '57643','35600','32416','50982','15056',
                          '79496','10647','89798','61052','41839',
                          '12306','70453','54914','54785','81923',
                          '79031','52059','20863','28684','44963',
                          '34333','94228','70477','74417','16598',
                          '32586','62772','75899','11242','40517',
                          '45535','89745','26277','75412','38518',
                          '66677','97627','25513','96686','54291',
                          '56966','70307','35216','51572','39157',
                          '52553','70651','66932','20550','39372',
                          '76643','16854','81044','57407','96946',
                          '16523','53380','76853','45804','59693',
                          '27287','74543','27198','72778')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '74285','86603','97367','66387','35562','76550',
                          '79242','94464','29206','81560','67918',
                          '22542','62872','65898','79955','34929',
                          '67190','45369','68447','59372','73153',
                          '26454','96871','59288','35532','36001',
                          '66272','91285','54609','26523','11912',
                          '49682','57178','11756','28607','60306',
                          '60871','67480','44027','20160','29421',
                          '94183','22546','90765','26712','34661',
                          '45381','90734','36748','90840','73115',
                          '37339','32912','37968','94020','93374',
                          '21560','19287','88891','94369','61076',
                          '48717','38632','36571','64404','38970',
                          '56384','48661','60634','12115','63144',
                          '41825','93697','71054','88742','84445',
                          '19244','69872','62743','15794','24993',
                          '10153','20564','96204','82179','55697',
                          '55502','88284','46085','41806','69260',
                          '76759','39999','91063','13184','42482',
                          '61848','94698','65906','68583','48706',
                          '49187','37106','35443','81910','92314',
                          '97058','21670','94764','32290','38727',
                          '76254','70515','77316','49802','98430',
                          '23711','37850','70708','61007','13058',
                          '87027','35124','41153','40636','67665',
                          '46329','96047','17912','67500','97592',
                          '21280','62382','12078','60529','14309',
                          '43341','14414','99132','10995','60017',
                          '96792','36132','68102','78674','92994',
                          '45033','60682','25982','12472','83844',
                          '65701','29057','26656','94581','69077',
                          '95652','42936','69345','29267','16758',
                          '10396','82704','41615','79728','38198',
                          '81798','72466','42823','26966','88326',
                          '40940','40826','55134','56757','12826',
                          '47904','23965','55919','49332','92123',
                          '22135','51729','40186','84354','92578',
                          '94880','77998','90110','71384','82594',
                          '79746','25094','52442','21088','15660',
                          '80330','32233','23321','69743','15690',
                          '92039','15728','95220','26069','74302',
                          '23213','78618','61601','39261','60369',
                          '68746','37007','86362','77049','25530',
                          '59569','36102','42378','82825','38074',
                          '56591','88667','74736','90636','70368',
                          '68173','88348','75784','22614','78101',
                          '66412','32246','10450','51731','38998',
                          '87942','96815','76060','44850','89395',
                          '97930','10093','86296','77100','88118',
                          '95360','12003','21551','82723','24635',
                          '89577','71001','41963','58792','50129',
                          '90777','31500','89783','41351','60848',
                          '44622','23255','66210','30376','36140',
                          '75092','29264','55151','20880','46286',
                          '98392','32865','17356','22658','66554',
                          '56558','36699','74442','16698','61385',
                          '96129','17439','82597','83231','65645',
                          '82238','97089','53034','95292','12278',
                          '91538','55495','81965','55549','85615',
                          '68419','98067','14827','86536','76191',
                          '79817','41499','83033','45539','35001',
                          '92831','54424','51884','51513','92766',
                          '86098','35182','97172','96188','87937',
                          '10689','64767','22949','81257','24125',
                          '50303','44623','37543','71433','58007',
                          '37465','53613','65647','22483','36574',
                          '43298','64475','84763','89015','69508',
                          '36734','38754','25074','73161','96442',
                          '38271','42014','93282','36450','15329',
                          '72977','25536','56523','31573','28953',
                          '42144','27522','38848','74157','82501',
                          '40080','54772','40937','71198','49495',
                          '33755','96530','83384','55233','87696',
                          '63337','87561','67995','73964','29814',
                          '82056','58146','99194','60268','93639',
                          '15617','49945','46686','92155','21189',
                          '25753','30954','38853','78791','66299',
                          '62869','34098','84622','21549','36139',
                          '64101','49766','51169','39141','79645',
                          '85437','91205','52508','49059')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '51060','70473','91072','22370','22893','11462',
                          '27141','39503','54625','31992','88466',
                          '36064','63980','86611','85614','92801',
                          '53334','18517','17480','98791','22072',
                          '57260','24554','36828','76944','52493',
                          '57611','74643','31178','16852','60196',
                          '34891','20518','73612','56123','59459',
                          '16675','29969','98335','24475','61425',
                          '66854','65612','41303','25400','72100',
                          '54677','68628','85123','13784','83347',
                          '40595','11119','88991','47028','39587',
                          '85975','61112','42606','86113','36231',
                          '52404','47606','49188','21105','72836',
                          '34286','43248','79137','30826','67308',
                          '65683','79362','66932','72186','35273',
                          '10899','87640','31576','22441','37296',
                          '84611','21325','39184','48784','65535',
                          '90156','93593','53477','64277','76532',
                          '68193','76551','75417','38031','26606',
                          '90611','11065','25398','74446','99962',
                          '30141','30945','55621','86302','24167',
                          '37453','92900','98464','29565','31593',
                          '57139','67433','98802','48423','86110',
                          '67466','49222','16234','43660','23751',
                          '57453','23962','90897','67171','46736',
                          '21855','44740','44948','87668','69445',
                          '34990','59250','83138','27664','26674',
                          '14392','56267','12611','39738','10563',
                          '39003','45196','74356','57401','11765',
                          '48197','17619','56851','87548','52975',
                          '15028','85685','35410','39773','43091',
                          '55433','60815','35330','96060','25379',
                          '90592','34213','24243','81636','27604',
                          '92170','50903','96167','65583','13570',
                          '30130','46954','81013','25377','53880',
                          '52378','30518','76840','56262','51996',
                          '76571','45431','45668','48952','25050',
                          '60975','16276','42015','97107','50769',
                          '91041','21588','67218','27910','92656',
                          '46474','86801','50272','45664','45081',
                          '67135','72737','64853','88079','60427',
                          '56474','52460','40393','53167','41489',
                          '73981','36962','12077','89433','71490',
                          '68796','71098','63758','21714','49801',
                          '38105','83764','86276','28519','39212',
                          '54714','52421','62323','72001','15805',
                          '42664','21485','87669','20167','41637',
                          '29036','52013','49065','24231','81890',
                          '54316','39334','40804','52812','82406',
                          '18675','11949','26428','39532','28918',
                          '67436','18097','49399','67523','22660',
                          '68964','22065','98307','43274','71347',
                          '17547','88677','48980','79653','58107',
                          '98225','39363','89169','36159','50073',
                          '19501','24801','52886','67739','13032',
                          '25632','15829','60704','17962','22669',
                          '89827','70697','21364','14547','58308',
                          '57582','83697','44089','85120','93830',
                          '70609','34115','48921','37590','94446',
                          '65973','43209','30158','23834','88125',
                          '38180','69208','70062','41437','83898',
                          '10101','60733','92625','83406','16681',
                          '37863','34426','44945','31838','94450',
                          '24713','17118','67652','17533','53089',
                          '92719','31493','74750','34749','26735',
                          '57422','78087','82563','80510','82603',
                          '78329','64501','93420','44112','11403',
                          '94184','92110','56280','68929','33851',
                          '85073','23332','59368','82838','38641',
                          '40959','47611','13641','72384','48757',
                          '27991','17784','39605','17387','68538',
                          '87439','59411','87853','12519','66224',
                          '91561','29465','21265','10730','34207',
                          '92474','43271','20145','73923','44145',
                          '77040','96427','61840','78928','45439',
                          '63065','27956','38015','37224','71587',
                          '85739','88383','70259','14686','40893',
                          '62884','26107','27328','78227','79328',
                          '65358','81159','26298','83641','18667',
                          '14454','77439','75454','82551')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '26120','27788','52290','64147','11854','91618',
                          '72440','54883','39610','82272','38450',
                          '32483','27214','19693','98657','27213',
                          '93181','42178','64987','88375','80314',
                          '13680','51807','65258','79218','19809',
                          '16127','94708','93746','15243','37195',
                          '52013','57245','50412','16083','18376',
                          '84908','92072','59042','22066','61730',
                          '72094','68736','68057','24968','36228',
                          '58815','76252','90974','15011','49365',
                          '50410','18321','97561','71372','75759',
                          '47114','38210','50379','66420','94201',
                          '86362','24335','48143','20142','15849',
                          '48361','87967','20461','22249','49623',
                          '42440','95712','26995','89839','52451',
                          '43035','71510','37170','61337','69844',
                          '52097','31356','94604','46839','13818',
                          '47768','89178','21074','92264','72905',
                          '21785','85770','34116','55628','80779',
                          '42531','11417','64753','78257','92112',
                          '67876','51672','38197','21611','47416',
                          '65213','45634','95622','10668','66166',
                          '28552','63284','61182','34313','62724',
                          '50369','26317','76692','51462','28799',
                          '41415','47769','88077','18565','40085',
                          '56505','44388','54649','37924','83238',
                          '92711','99245','99076','17827','56671',
                          '99739','93462','33833','30127','27549',
                          '64484','73005','16380','11910','53511',
                          '55356','56989','72002','88687','29137',
                          '97453','62103','42377','64892','27886',
                          '36942','12085','48004','83870','15744',
                          '42662','30681','94115','31635','95527',
                          '43663','65832','12553','41763','76525',
                          '67379','77182','71256','69891','72578',
                          '89671','26933','30051','23115','66682',
                          '80044','40912','88918','27248','39670',
                          '92633','89557','40902','57408','98183',
                          '57369','53870','40771','14126','26840',
                          '11286','63288','65494','49993','66513',
                          '24822','55815','99405','92511','45831',
                          '84433','75485','97462','72160','51084',
                          '95564','28779','98897','15774','50592',
                          '79427','25795','99277','36178','50957',
                          '15747','74208','79523','50538','30906',
                          '26610','19308','17601','65204','27015',
                          '65442','43241','58096','72581','86958',
                          '95348','36469','68554','41193','25604',
                          '77976','98851','26725','91729','95248',
                          '53395','20282','28542','68087','18646',
                          '63082','30809','30364','25074','88313',
                          '72972','56138','23823','64096','42194',
                          '92223','81432','65713','68873','58592',
                          '52151','32664','56059','55218','99766',
                          '55600','18427','47298','88765','84229',
                          '53957','49111','64609','39683','99481',
                          '54736','44845','90521','44746','31426',
                          '24779','68794','80762','71969','59061',
                          '96147','10310','37682','53907','37407',
                          '22648','47801','35402','19178','95824',
                          '57692','96839','21532','98331','86857',
                          '98051','63122','46332','61345','90336',
                          '34976','25030','29808','53962','88706',
                          '95088','26437','19600','80278','94886',
                          '76375','16888','22464','77359','66353',
                          '75771','85702','69805','18900','67398',
                          '42067','84154','86843','47547','19152',
                          '28612','19866','35828','24899','86394',
                          '87814','65601','69255','68315','62639',
                          '37453','11784','68808','75542','57570',
                          '62337','82796','85647','26240','34533',
                          '13981','13297','52113','78082','41483',
                          '41245','80901','55876','58508','96816',
                          '61971','44529','48658','18008','56794',
                          '34515','80487','71163','22357','47010',
                          '74689','96002','94674','26334','81033',
                          '51177','61265','49899','60427','22499',
                          '78748','14059','51058','68034','64002',
                          '58237','51044','82220','10084','57291',
                          '23783','78084','73015','59748')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2002
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '59785','40369','32519','89386','36723','51899',
                          '44868','48181','91836','90129','94469',
                          '84983','46784','39657','15224','50329',
                          '10327','49157','68264','45559','78433',
                          '77469','56133','79355','73155','22765',
                          '16839','47043','18952','98257','48867',
                          '34019','62269','16147','48960','69707',
                          '87766','54905','11623','33875','37620',
                          '17954','22959','57842','67270','26001',
                          '56172','81860','87998','15725','92375',
                          '68734','40258','40169','33151','76912',
                          '33408','27651','74764','58808','18460',
                          '52787','25094','67533','94605','52986',
                          '48642','64321','90997','13201','30387',
                          '64432','77041','15353','99585','83319',
                          '79229','73170','96951','75877','20890',
                          '69912','11411','69533','42938','27214',
                          '60731','25753','54671','10478','86987',
                          '50571','45393','46158','14071','15260',
                          '65889','88134','51270','20619','21915',
                          '10608','30080','55580','36378','99593',
                          '58494','27157','36421','12000','71863',
                          '46994','42387','52535','62390','54954',
                          '12660','70510','88513','69558','79639',
                          '73281','85902','64779','74364','68249',
                          '46730','27203','58837','15391','92225',
                          '62920','24549','38133','57501','27851',
                          '57211','15610','90382','90748','12855',
                          '51844','45752','41215','93739','31903',
                          '75603','33683','21419','89805','45535',
                          '58566','18134','75173','54508','51954',
                          '24691','68379','81303','42953','64167',
                          '62675','82560','90232','22828','34673',
                          '14585','20380','59892','68653','30130',
                          '32422','18813','95065','73924','81495',
                          '13204','79223','56345','92099','61519',
                          '50837','97979','92601','80036','64064',
                          '75054','24964','38745','71171','19844',
                          '34206','21552','25349','39953','46614',
                          '39074','47431','92805','39514','55413',
                          '57841','18343','87217','12044','62192',
                          '15397','16734','21985','18236','37683',
                          '54870','39212','74501','47937','21620',
                          '90057','88236','46789','85051','53401',
                          '17670','99999','96924','91634','40004',
                          '65380','12881','72392','19977','60554',
                          '17982','81354','97477','97962','57511',
                          '64084','95427','67744','29096','71194',
                          '81399','62042','91967','15388','76870',
                          '14833','80829','57950','60104','34467',
                          '73447','44439','87534','77826','55882',
                          '61741','49730','64534','95222','48371',
                          '78107','28398','89842','29332','88330',
                          '48933','72249','61769','32819','37462',
                          '44236','18692','93492','55492','21930',
                          '35680','77317','61356','94692','73567',
                          '97539','22612','31054','70760','18878',
                          '23318','12587','35071','82637','11811',
                          '69364','34776','52505','37100','34017',
                          '96187','63337','64068','74551','90247',
                          '83848','21070','19108','56646','69278',
                          '84120','24847','72247','56669','20033',
                          '99211','71851','50493','67375','67445',
                          '35863','98334','51389','67655','71897',
                          '57710','35076','41618','99805','23956',
                          '51636','24447','41185','82378','14035',
                          '90388','18342','58989','77558','41975',
                          '66249','79211','67014','44168','84740',
                          '31022','40936','66928','70439','25383',
                          '22855','44891','79837','57930','81686',
                          '40254','16062','75646','16741','67536',
                          '83087','13924','50412','28030','25514',
                          '10374','68548','17129','60531','76737',
                          '88042','55806','91458','70270','42711',
                          '45580','86982','51436','90402','85529',
                          '94217','59756','48345','79468','66264',
                          '12217','10612','93859','40866','70349',
                          '79803','63331','84830','77569','60968',
                          '45974','47048','91540','55656','64400',
                          '34596','90532','56718','70770')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2002
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '90416','12607','26205','33463','71017','32037',
                          '22779','72740','50849','69022','81823',
                          '19417','17686','58257','26649','12779',
                          '47510','86191','83841','64910','92272',
                          '72534','55340','54616','28050','90309',
                          '16061','54425','90662','97215','44744',
                          '70196','99597','49008','26651','64981',
                          '21204','72244','97360','74355','95657',
                          '65627','30732','72724','14712','83384',
                          '76346','31925','95510','83262','78612',
                          '35805','69164','19758','44090','70023',
                          '57470','61182','94434','99200','58677',
                          '51203','30881','32514','10393','19321',
                          '82033','90079','70536','32961','64510',
                          '53629','52092','29918','57268','35422',
                          '93048','37601','20198','41144','25520',
                          '27343','48101','17331','69581','45929',
                          '60679','71747','91484','63708','14566',
                          '93466','28330','81535','88956','87881',
                          '11895','50481','29120','54952','42082',
                          '91946','28753','51110','86461','23526',
                          '79042','33994','39576','16558','54996',
                          '41872','96238','30342','17239','24909',
                          '16068','15708','82829','76114','70515',
                          '57215','93293','20976','83555','63923',
                          '89810','80387','96376','95022','13704',
                          '77142','27081','12767','90565','78503',
                          '75263','53212','25121','57778','31275',
                          '64793','95509','88593','40117','77634',
                          '44218','73877','54652','24318','27285',
                          '88796','38098','28731','86149','18230',
                          '96242','96543','95511','42664','48339',
                          '43864','99519','30656','83738','54800',
                          '70869','37250','58115','41042','46074',
                          '47741','30007','27043','30918','59907',
                          '41981','97874','41994','84894','53727',
                          '55747','40972','59698','56478','86562',
                          '74955','56590','79544','96772','76765',
                          '34821','50313','22808','50823','23664',
                          '78231','58666','31899','64251','92147',
                          '45688','27280','36091','29019','53392',
                          '78105','40669','56896','36488','54879',
                          '19656','70572','14654','37441','21758',
                          '86470','82299','80867','35607','98391',
                          '18275','24869','23984','54923','24678',
                          '52791','78208','28811','36052','32013',
                          '92320','28150','24762','29043','78124',
                          '35771','28812','89887','74025','63200',
                          '89503','60686','89943','25789','10728',
                          '47178','38908','31713','17939','75916',
                          '67747','57885','65012','50079','43930',
                          '63410','42568','71326','29999','78963',
                          '89033','49344','76102','71795','96166',
                          '17746','21057','41970','60853','43401',
                          '31877','29007','11789','47559','63464',
                          '73019','13927','29410','93275','88892',
                          '37240','11955','67176','40394','24903',
                          '84593','93218','15030','10158','14526',
                          '13722','79284','62377','69634','58465',
                          '30538','10620','65001','31076','97961',
                          '87292','38526','53533','40904','42257',
                          '96990','64427','38657','74178','86919',
                          '41668','34248','44128','44020','65410',
                          '25341','47690','21233','12400','96863',
                          '85684','29224','99138','88821','69251',
                          '29603','90453','86008','99546','74038',
                          '71048','17282','98994','87778','19451',
                          '93923','38274','31632','76243','78201',
                          '18053','44868','79856','83035','90332',
                          '33607','18922','87993','27557','29541',
                          '96135','21726','50036','83213','84758',
                          '88420','35283','55069','11592','92468',
                          '89256','66317','71537','76268','18089',
                          '36388','65204','84256','43637','31249',
                          '21686','25251','79635','36825','63181',
                          '11253','48955','80250','33299','80641',
                          '88275','33465','61537','96005','89018',
                          '38684','26345','15942','13357','45946',
                          '78729','60985','63054','86661','64026',
                          '54443','52970','36794','71836')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '12113','17701','65154','14167','54781','29983',
                          '50464','90212','97047','68318','68009',
                          '22298','43504','62504','19332','33577',
                          '16181','35860','57147','82213','83178',
                          '69299','90535','79752','39750','89359',
                          '26119','99487','23989','45520','80317',
                          '88670','70172','38877','50539','97337',
                          '63559','88459','32931','85098','22982',
                          '96419','65071','30856','50935','27877',
                          '25669','53317','43917','22043','24199',
                          '37338','57973','35433','30336','86072',
                          '28119','18756','74492','16881','60516',
                          '12221','67943','85614','63045','58107',
                          '63752','75967','79649','19602','29703',
                          '82450','45489','13351','53609','23565',
                          '61813','98152','77746','58510','77504',
                          '11182','26478','77696','58970','91726',
                          '85745','71998','23447','52879','22831',
                          '89926','21041','65239','62884','95543',
                          '12844','47478','29547','84182','83526',
                          '95771','31807','72934','65137','16187',
                          '46769','61634','78592','53685','47445',
                          '50367','34129','95318','94735','30492',
                          '22862','83586','11250','78581','48939',
                          '64906','87459','47059','12146','87917',
                          '53863','93092','21586','54461','63171',
                          '68459','18554','53333','95358','27610',
                          '95275','64952','73309','26718','41340',
                          '45770','44321','35110','31845','27643',
                          '80067','63852','53753','86368','49701',
                          '11805','74159','34590','54040','32593',
                          '38077','49564','64601','40575','65797',
                          '73687','63736','38731','24593','49405',
                          '64176','43849','97828','58556','62615',
                          '13916','94543','80480','31042','25150',
                          '56661','96602','41430','92648','69024',
                          '44949','75128','70603','43152','10623',
                          '66302','55242','31489','32178','62049',
                          '79224','37851','16243','30444','19961',
                          '22381','38015','97400','26054','76117',
                          '24226','28199','72699','96063','47991',
                          '13196','71558','81338','66197','65421',
                          '16782','70921','35224','12081','40246',
                          '21855','53431','22469','43682','76377',
                          '68709','20182','45696','39866','78533',
                          '83483','53877','37556','36489','85857',
                          '62119','43588','40685','10494','85197',
                          '80985','40656','78389','76120','58414',
                          '74439','51112','64702','28624','29258',
                          '23957','92437','53911','89776','51579',
                          '38081','39779','46866','29461','61945',
                          '87011','59748','62199','34835','56442',
                          '76620','40986','11161','98087','61814',
                          '56450','67259','78355','33695','80765',
                          '79083','19870','72399','96840','64637',
                          '19894','57826','81280','19576','80270',
                          '69276','50248','36828','68182','44083',
                          '61032','22291','34466','90912','83714',
                          '12061','47378','88762','56266','93886',
                          '70276','90041','34435','42110','83341',
                          '47037','46188','53226','74141','73633',
                          '76716','90624','88266','79154','57793',
                          '30957','25846','48498','82696','53336',
                          '52328','84924','45344','42132','79568',
                          '91033','58598','24433','85008','15900',
                          '15789','18129','16421','33357','37408',
                          '18598','78981','26562','44087','31195',
                          '11530','79452','72893','99979','55443',
                          '99554','54024','73839','59413','36423',
                          '81123','27228','96284','94249','76361',
                          '87684','12708','35091','36119','91991',
                          '26547','10945','35083','80896','48306',
                          '54118','26679','73753','78611','87435',
                          '95035','38062','69640','14736','47425',
                          '44798','21191','49429','59317','80268',
                          '39629','13302','53577','93526','14188',
                          '79318','87099','16096','63411','40197',
                          '43967','66224','64187','71428','69762',
                          '89042','25925','70591','34406','41353',
                          '48584','21627','96837','37298')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1999
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '25479','79060','13026','50279','38614','50838',
                          '79964','95215','68493','33514','69736',
                          '48619','80133','31715','84869','94667',
                          '36231','43751','35350','72858','39889',
                          '39346','51877','72512','24136','12725',
                          '75530','43725','72074','80660','56836',
                          '18466','23567','37130','65984','68527',
                          '47866','12975','98294','73740','65123',
                          '47757','56242','53214','11334','37980',
                          '20682','67607','67446','24939','29368',
                          '79937','62479','25783','97415','68000',
                          '85746','38348','27974','25520','36219',
                          '44374','99775','54030','53369','28750',
                          '40491','94962','60014','96942','59093',
                          '13058','36919','21810','39073','53319',
                          '63857','43347','71500','40628','47667',
                          '47719','73498','22324','21680','20884',
                          '76084','77510','88526','42925','53781',
                          '98899','26154','20275','97999','95573',
                          '21390','46813','14458','18819','46488',
                          '20839','89886','74133','79815','58082',
                          '19937','31149','42065','49750','23871',
                          '90885','52818','94303','40018','14086',
                          '78088','59144','74044','22143','24235',
                          '15555','80384','68525','73708','23948',
                          '31292','79951','13970','30218','28912',
                          '17204','98174','45308','46714','62847',
                          '11561','58493','80584','45700','33046',
                          '72535','80926','90467','87810','15559',
                          '45046','63065','83826','76315','18156',
                          '72311','85223','84455','69664','71840',
                          '65559','38133','33936','14433','91997',
                          '80845','80397','29399','34042','86092',
                          '87198','68866','97576','79604','78228',
                          '87129','51895','30474','67405','65036',
                          '85363','37451','63597','41721','79484',
                          '11348','98059','63584','77567','53585',
                          '38257','77840','35895','27744','52110',
                          '25321','81807','52983','46079','18528',
                          '83027','20965','15224','54341','20037',
                          '34214','54963','52413','15078','40590',
                          '41788','63439','77605','76180','55901',
                          '89320','35255','93644','18120','33372',
                          '84881','77300','66680','29923','17815',
                          '43507','85051','43396','19381','98129',
                          '20466','91965','95045','65165','33611',
                          '75526','62621','37733','25424','53653',
                          '75709','63453','25719','39276','90430',
                          '48098','21864','41368','52185','94974',
                          '65046','93764','46750','72470','68379',
                          '96737','29422','12835','11628','15682',
                          '19948','83917','23430','74368','53545',
                          '82975','18570','39013','96076','43880',
                          '66360','63182','32848','27586','17814',
                          '84286','44491','22126','48953','45844',
                          '84936','68095','81314','62455','42900',
                          '95420','83040','87736','44011','48880',
                          '92537','15328','53804','64356','52240',
                          '79463','64811','85452','96404','92042',
                          '74037','27349','27525','66618','24076',
                          '79956','53410','71778','73968','12793',
                          '68781','34170','63296','78471','92012',
                          '22051','41044','50915','48547','73238',
                          '23246','15757','96165','88930','98351',
                          '93512','51898','29926','16301','41254',
                          '25995','15947','12110','57044','13069',
                          '72822','31045','69853','20861','31807',
                          '92888','68857','77770','83608','75083',
                          '16978','75393','15083','88191','64292',
                          '12572','46216','17602','79092','74340',
                          '18023','88527','42500','10583','55006',
                          '39323','12313','37361','38944','37691',
                          '54929','55918','42299','12873','58433',
                          '88665','20191','77392','92017','27124',
                          '51461','40668','27509','68052','98530',
                          '49259','15483','62096','93205','12354',
                          '89032','78477','66512','20292','23313',
                          '73429','92620','84654','91264','32764',
                          '95645','80798','51135','81499','68163',
                          '85703','13338','46722','60495')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '45036','86504','96937','44858','31328','99193',
                          '77327','66374','47402','40459','89997',
                          '24418','99889','85178','33037','24334',
                          '88177','80692','29123','45969','21569',
                          '53693','51647','27316','18952','23622',
                          '49348','80345','34910','73746','98206',
                          '98454','39875','42069','49075','97634',
                          '39957','83454','42351','27028','31178',
                          '42030','72742','70071','33444','52891',
                          '52555','11588','45429','56792','88381',
                          '22765','23769','52056','98296','80150',
                          '22598','13855','47265','31184','72418',
                          '38462','12421','91725','92220','60525',
                          '87538','10531','79760','67116','39165',
                          '79842','95741','10887','19869','85263',
                          '29887','98045','43258','30783','95613',
                          '83342','78174','73174','13842','76032',
                          '48039','30683','79462','57352','44715',
                          '10213','68277','72815','14111','53472',
                          '80996','35179','24456','34460','93671',
                          '68911','76166','60375','98277','95712',
                          '25594','60242','78487','34747','66246',
                          '92730','64686','26769','11192','61504',
                          '13788','99855','22877','77929','94687',
                          '79117','90879','36489','29128','49536',
                          '10424','59253','71516','97789','61293',
                          '59692','51131','67864','62017','40584',
                          '25691','48966','11648','42657','51759',
                          '59700','28059','47925','62164','73560',
                          '17137','26348','32026','36364','53999',
                          '59628','11593','12733','56408','83987',
                          '24146','96982','95478','91636','60784',
                          '39664','62323','55725','75305','60849',
                          '88014','88872','37858','42592','74187',
                          '24733','90142','46855','36555','12312',
                          '94509','98898','97550','79895','64156',
                          '73193','45669','60840','66595','44698',
                          '49844','73856','52735','84646','94373',
                          '59309','84365','25652','28706','52552',
                          '52793','49874','37410','95523','96132',
                          '96312','75886','30015','29984','17978',
                          '32882','59832','27379','50312','78469',
                          '82180','13901','56351','32192','79362',
                          '75280','36260','23792','48647','98097',
                          '52798','33398','61556','52501','11370',
                          '37997','57228','39322','21818','17769',
                          '27830','48172','75672','33244','47717',
                          '45313','55498','36949','45564','39197',
                          '71558','80588','43197','89509','97953',
                          '85561','16290','54833','94951','81189',
                          '83662','65254','75882','99133','73371',
                          '59165','24042','26026','22796','28017',
                          '58017','38155','98997','70902','71893',
                          '46231','74626','21716','15217','72787',
                          '72762','56154','28524','97406','12418',
                          '65778','76423','27713','83465','63570',
                          '14399','45562','22455','95695','17992',
                          '90346','78640','67313','64814','98585',
                          '45581','72220','49632','98811','82519',
                          '81747','75726','96424','53419','86865',
                          '86962','43960','29540','87219','16878',
                          '36439','11384','91785','92148','34575',
                          '73868','27140','80472','77690','99703',
                          '21598','95190','98660','25970','14228',
                          '35531','91374','96091','25612','64023',
                          '96179','21392','42354','87093','77731',
                          '41772','24799','23145','39553','63089',
                          '67357','76274','28611','71539','42016',
                          '85707','44535','87065','37112','82891',
                          '99832','33670','64752','88657','49786',
                          '84475','82718','62301','65900','41832',
                          '55480','19872','53315','35583','47893',
                          '17297','34821','25490','93129','57296',
                          '14981','19913','18032','34441','19964',
                          '21125','69268','50430','51435','37009',
                          '87809','78417','66498','55934','45591',
                          '39962','82779','59159','93962','19874',
                          '16872','16176','68931','82591','84619',
                          '51795','34442','72258','31776','79226',
                          '84139','43535','10035','38030')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1999
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '85721','40640','73641','31525','82975','73103',
                          '38931','47809','51644','15560','57732',
                          '79681','75957','82587','71745','32773',
                          '29619','42369','48810','27849','13187',
                          '24730','91743','75901','92091','80022',
                          '76204','19573','24256','81539','67940',
                          '82236','79606','74192','85242','47731',
                          '34477','93794','43133','17151','60529',
                          '12016','30706','17668','21868','23608',
                          '58075','78402','91131','59131','94827',
                          '46798','82903','87357','15594','49651',
                          '19434','80910','65310','56750','36445',
                          '41403','33073','63585','76000','46656',
                          '58718','73632','98621','21266','78418',
                          '85076','71339','28316','78273','26139',
                          '71191','61684','91734','69380','31379',
                          '41893','51799','84681','32953','57724',
                          '56828','40453','75482','64134','51054',
                          '51564','47503','46016','38139','55738',
                          '35107','95323','14881','99377','99861',
                          '39772','26453','57238','56751','36897',
                          '90512','93571','76417','22244','84015',
                          '34683','92101','42518','74116','60337',
                          '57280','20351','79299','42596','86844',
                          '75892','14682','93822','16448','17788',
                          '65852','41396','30331','26253','32596',
                          '21671','90288','83437','61572','77504',
                          '53110','94019','49413','43028','28877',
                          '84137','18363','41655','70761','32779',
                          '66926','90491','19396','73333','13324',
                          '65775','12472','86760','97171','34195',
                          '17162','83384','36972','13126','27940',
                          '75601','56365','78846','71211','89095',
                          '69520','67882','69597','49632','84861',
                          '78889','66462','28645','68645','28855',
                          '35693','19005','30187','75037','74268',
                          '37401','64598','40887','33697','51103',
                          '88369','74754','48345','84574','51694',
                          '89502','49265','27382','95428','33728',
                          '19450','46684','53733','60035','99266',
                          '76652','53626','44870','75809','60776',
                          '79411','39603','93861','40230','48264',
                          '10819','53642','67376','75979','17452',
                          '45821','94747','61894','90347','81712',
                          '18483','60437','49717','85224','13139',
                          '86119','19627','81258','77126','48215',
                          '13649','45458','97949','53310','69067',
                          '49571','12866','51486','13035','26927',
                          '44026','25016','55686','80258','92670',
                          '58068','45694','54409','17586','54414',
                          '87627','50667','55014','79759','47534',
                          '34538','21175','59449','11439','39015',
                          '41032','85934','68902','62468','20762',
                          '80375','55412','78406','97333','23416',
                          '50278','42506','59571','16242','82731',
                          '46109','29602','75019','10143','66355',
                          '11518','37856','63732','20305','57541',
                          '86569','25901','28300','15208','49605',
                          '49811','50746','91730','43748','60990',
                          '97475','77169','20546','99700','44662',
                          '73275','36658','65440','59747','99307',
                          '82342','45803','96157','74838','63495',
                          '19469','11044','46064','51001','89332',
                          '40839','70734','56911','44522','21879',
                          '45820','33539','92375','84885','62414',
                          '49337','71138','37200','52319','11782',
                          '37826','66526','84248','11759','73112',
                          '94621','70886','91482','87772','10915',
                          '98855','23084','65618','21433','75203',
                          '32148','22187','47819','57933','54122',
                          '71655','30405','92128','56871','95709',
                          '31592','19852','15466','79703','10427',
                          '55996','31483','33603','85518','72235',
                          '42557','59592','77900','61216','54086',
                          '37841','79876','60328','66356','21950',
                          '46861','86301','35795','91359','26749',
                          '33340','46697','17314','77201','98929',
                          '38707','27860','67765','31717','74387',
                          '98803','95207','76940','85919','37477',
                          '75312','31641','23382','25879')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1999
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '21980','52300','16741','47540','79132','80878',
                          '32653','40589','33985','77780','88893',
                          '47436','27484','41987','78488','43127',
                          '42763','46904','82514','29756','11371',
                          '25787','26747','73307','90407','21473',
                          '37822','52875','11228','44160','24420',
                          '90110','52799','73795','47591','13183',
                          '35143','62245','68373','94678','65383',
                          '23130','45079','29637','71672','14275',
                          '21522','67823','30751','60967','65499',
                          '35772','75709','94697','77920','51427',
                          '89076','46712','20589','91190','63070',
                          '49232','10566','42401','85715','33515',
                          '57934','67590','13404','46584','66474',
                          '68487','91934','69314','31949','81654',
                          '80719','47725','41072','49078','40409',
                          '86742','58233','41062','62812','70641',
                          '30992','93488','77571','34413','22049',
                          '47702','57379','40065','79140','25548',
                          '93687','86170','19626','42012','68763',
                          '83684','13750','39701','17896','99755',
                          '90011','35407','64983','98410','32125',
                          '87867','20814','18220','45436','82422',
                          '50744','14893','19562','82983','91922',
                          '67958','11525','83865','20172','68572',
                          '44684','37733','43343','88218','99763',
                          '33731','88733','66977','95250','16843',
                          '38688','30715','52261','82042','40789',
                          '62328','66171','33995','45619','83239',
                          '59923','95526','16087','36314','54165',
                          '47984','19432','24925','33273','77783',
                          '25735','24592','70466','63444','31004',
                          '85598','18229','16544','10291','71012',
                          '14488','93946','14740','42854','48613',
                          '80001','24233','93016','69353','87108',
                          '36016','28132','59684','27375','45454',
                          '84386','70449','74140','70828','74825',
                          '32205','41293','16668','73349','64241',
                          '95762','50589','71004','98731','92776',
                          '39990','56545','98005','92088','19441',
                          '69831','78430','35773','50951','57817',
                          '65917','48152','57594','37369','43163',
                          '20132','88978','36365','69959','79636',
                          '90219','64837','83623','61263','15713',
                          '10680','67205','60098','18020','68919',
                          '62562','16305','88558','41769','43814',
                          '29872','45240','30514','38044','27575',
                          '99199','56010','46281','25663','31077',
                          '86084','85008','33732','35300','82516',
                          '56178','56449','47027','51025','45524',
                          '27093','77149','39282','44730','77249',
                          '99423','85740','64176','77486','21826',
                          '35052','85195','73331','51558','83007',
                          '11339','24343','83273','32001','74328',
                          '94210','72284','31630','24352','82127',
                          '77362','82700','79577','67938','59299',
                          '18971','60956','79006','92780','43400',
                          '49219','77781','47757','97814','10108',
                          '91874','28291','87163','85591','17706',
                          '72386','73556','17757','17011','77631',
                          '70703','90812','73418','43481','10933',
                          '75650','18917','65019','11057','65507',
                          '51037','45538','30296','83316','76704',
                          '26078','54613','11613','96504','17102',
                          '56995','10498','53787','94121','42183',
                          '13501','94253','84504','30666','62878',
                          '30170','64281','29232','96244','22607',
                          '33334','76775','35552','53297','95987',
                          '62416','78490','43568','70966','93124',
                          '72688','74936','87339','96483','24130',
                          '87770','28395','13520','34498','41174',
                          '15236','44900','86442','48395','60397',
                          '59711','78414','30064','25990','57374',
                          '70787','86226','65554','22796','34668',
                          '90534','49933','44272','74697','56544',
                          '46411','83105','23910','32334','95438',
                          '32969','79070','10266','93714','32963',
                          '48796','55076','49181','10732','19940',
                          '92759','92100','39664','71252','84932',
                          '74066','55907','28953','43353')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '62729','91420','28347','27234','95209','40171',
                          '21195','78447','28318','74656','42850',
                          '74594','51671','12439','33316','70737',
                          '19976','55675','13707','81234','68234',
                          '64326','78734','97096','73927','51220',
                          '28371','75474','60702','23991','91235',
                          '84705','84046','44737','59487','51249',
                          '92577','96748','24605','60295','71000',
                          '40551','33483','84547','27287','32424',
                          '35009','31119','50713','17469','54008',
                          '98564','50424','31259','25081','30117',
                          '55783','77387','38941','11038','68192',
                          '12286','86579','22927','71770','39227',
                          '30435','71075','78165','23730','66055',
                          '42242','52907','90222','63953','98430',
                          '22282','79894','58110','61046','67193',
                          '82230','10169','33804','67275','40023',
                          '24113','55432','78796','68090','99773',
                          '70424','95198','62202','22320','94181',
                          '27087','19750','18532','80827','72074',
                          '15614','25943','55668','60331','66782',
                          '23068','36542','88790','12563','76136',
                          '24780','50755','53127','10848','33637',
                          '46269','83830','77264','82718','71660',
                          '21364','26585','76527','95872','92088',
                          '43537','49426','46421','25684','45823',
                          '17140','15555','74098','33589','86249',
                          '15847','67966','27490','28742','90531',
                          '35681','71547','95805','77950','60443',
                          '57938','71058','92969','38878','24956',
                          '19460','84749','33047','69218','31226',
                          '58270','21095','45458','46530','41676',
                          '33647','68598','37357','86291','50279',
                          '92846','25469','26485','80056','76643',
                          '67667','91582','13133','39460','51735',
                          '97005','39504','62664','33661','36475',
                          '67507','21427','89064','35808','54970',
                          '59997','99499','34504','72097','48893',
                          '97486','97145','55111','59556','15244',
                          '41229','74006','38825','88594','35491',
                          '25108','58185','79878','73058','42971',
                          '72735','74368','37243','49905','26106',
                          '82937','97419','28454','53107','50456',
                          '11322','10534','95628','22506','48909',
                          '61944','46010','51937','47173','24258',
                          '29303','60090','58827','47414','68318',
                          '69783','85566','39390','75493','49299',
                          '72310','15838','42287','73294','29637',
                          '81235','17996','85618','71848','53804',
                          '16621','78651','53667','84934','48271',
                          '88913','85305','30215','23222','33386',
                          '54786','77470','53817','13214','90765',
                          '68364','79615','40509','92585','54994',
                          '97689','97048','12999','29930','14374',
                          '28034','44686','73478','79522','53214',
                          '87496','32592','48006','77524','44654',
                          '95787','80576','51403','80482','26138',
                          '30502','37984','72317','20487','78233',
                          '26391','31673','79562','60256','65526',
                          '12086','20233','59277','97594','87438',
                          '27491','21962','17098','77493','52528',
                          '89755','39236','93729','80491','35063',
                          '89622','65800','27000','97964','48858',
                          '32857','12356','82562','23582','14001',
                          '81762','59993','14073','43845','68533',
                          '99042','41196','77295','35942','70815',
                          '80875','11067','48356','30731','10665',
                          '95545','31036','42085','56226','91113',
                          '20133','13470','29696','85384','15087',
                          '17168','70875','44865','42184','93550',
                          '99790','17323','10543','59311','74563',
                          '38923','41725','49058','62801','20288',
                          '63672','27037','42151','26395','16985',
                          '30878','45046','74544','67022','93797',
                          '51047','82023','49168','45985','18854',
                          '71008','25301','12595','11439','23319',
                          '32135','50475','49172','23705','97505',
                          '20929','89963','14868','95835','16551',
                          '28531','32702','92542','29790','25014',
                          '83126','88420','74573','53502')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '57443','69299','53143','55917','91794','81552',
                          '39112','29553','17426','45404','98883',
                          '23910','94609','62550','90637','26226',
                          '64725','92304','51372','51303','63082',
                          '59921','40461','85780','32641','31445',
                          '72823','21937','60499','64177','76189',
                          '38852','80983','98629','33906','93924',
                          '43357','17033','74813','64702','18023',
                          '10275','27472','25045','10049','55148',
                          '28823','15695','25738','38354','12570',
                          '92309','17762','67526','71622','90222',
                          '93253','93871','93668','74207','95957',
                          '67136','87966','95578','83732','22479',
                          '63219','31657','75614','40477','30787',
                          '63760','30343','36062','39819','20543',
                          '22711','16315','81786','35298','37268',
                          '11636','38888','82727','67729','57677',
                          '54231','18079','15989','58796','44014',
                          '74500','79722','84400','76510','67942',
                          '47832','62228','18840','41103','29097',
                          '59106','75439','37749','66951','47502',
                          '60543','66177','76830','93070','22573',
                          '60649','37243','52717','77122','73124',
                          '10692','66717','58414','51482','74716',
                          '84854','47683','14123','69183','56115',
                          '50656','66523','38140','76054','83216',
                          '15770','16416','17529','54299','33254',
                          '45549','84710','34809','90458','74901',
                          '93632','81271','90191','35627','47719',
                          '54246','61999','74790','88434','81194',
                          '20518','30410','95641','10097','83504',
                          '28236','63013','75678','81129','69477',
                          '79039','35812','75142','37022','92708',
                          '75167','11702','58117','70689','35941',
                          '84053','81613','98983','27659','15344',
                          '37570','13747','31393','82897','79103',
                          '57901','28521','18821','14658','26412',
                          '58773','61975','54827','38444','69246',
                          '75261','38203','70157','54142','55817',
                          '67915','39164','74386','78761','89212',
                          '89347','64805','77411','64424','76266',
                          '42672','84340','29501','69006','86881',
                          '33676','77930','13654','75112','19710',
                          '96505','74780','49541','49571','59542',
                          '67146','99690','98658','36189','95644',
                          '81813','38151','37984','49564','96963',
                          '83994','55066','79401','22494','58152',
                          '77964','58208','57191','13275','56298',
                          '91382','83793','74585','84902','53809',
                          '13778','33242','58783','52316','11345',
                          '32923','60943','44294','31944','84795',
                          '47757','60308','46587','78100','44055',
                          '61059','28653','81727','15784','92909',
                          '24530','28274','42101','46036','62990',
                          '93699','38569','74405','60914','46698',
                          '25808','89275','10279','93242','20519',
                          '46382','87891','36074','94592','65804',
                          '80553','49154','79115','36853','79563',
                          '86716','98544','37184','60931','45463',
                          '79417','16763','80254','33088','93758',
                          '98464','92676','81697','23527','69425',
                          '70801','36282','46855','31340','98038',
                          '43205','94281','45709','58120','86609',
                          '19787','34369','79082','85377','78486',
                          '41068','30230','40784','12368','96902',
                          '35420','34367','61263','17953','30092',
                          '55192','64681','63553','11534','93263',
                          '98053','83189','76451','94032','39614',
                          '35001','79513','11865','40505','95511',
                          '49061','51464','25523','48886','78362',
                          '35094','71306','42967','88729','77550',
                          '70535','89878','98793','70790','59076',
                          '41628','95118','76936','18898','62141',
                          '79263','63625','11139','81550','25906',
                          '60128','80632','43396','30086','47259',
                          '45757','11083','25487','51003','12561',
                          '39775','31061','49567','39018','81107',
                          '63384','17171','12918','57531','42017',
                          '92086','34253','84755','47904','12255',
                          '90234','99956','99252','80901')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '41173','52827','87452','41981','27457','46733',
                          '43240','24468','45254','95322','93054',
                          '12580','54610','62507','32468','87199',
                          '58248','95576','37121','53126','35163',
                          '16046','74946','12711','25431','41876',
                          '77503','96367','34677','51701','16817',
                          '17546','14324','97159','78617','30268',
                          '24193','89107','13893','92126','36086',
                          '29992','94474','22691','70874','12182',
                          '95568','59315','35870','89061','15358',
                          '31429','41774','38531','84666','57675',
                          '11567','64259','86749','37046','72724',
                          '55679','18520','40476','74658','43436',
                          '16717','16514','77609','51314','72936',
                          '67719','67947','44228','15683','34334',
                          '27123','95238','50478','69776','80064',
                          '84386','34028','27460','70139','63063',
                          '38479','19503','24247','50358','60475',
                          '27798','69283','36034','60412','91521',
                          '74937','57394','73029','70980','98895',
                          '54943','91918','12757','29176','12115',
                          '35356','17133','79948','80877','87542',
                          '88672','81734','36399','28440','72805',
                          '85170','25579','81244','80409','42303',
                          '71492','10909','78520','45798','78261',
                          '94824','33546','32990','37026','10031',
                          '10357','78020','76839','18400','92301',
                          '55295','33244','96773','28994','46030',
                          '84631','62302','98073','10684','41408',
                          '81121','11126','58594','38949','98429',
                          '81419','76364','93698','72201','10604',
                          '15977','82970','17077','18984','90407',
                          '95034','28737','69352','88191','33088',
                          '97917','82700','53847','83057','13585',
                          '92523','71574','17003','21150','28901',
                          '69633','29971','67827','39066','70694',
                          '38413','78187','87653','62568','84943',
                          '76560','24774','41029','84767','97036',
                          '14615','63917','46309','28216','46020',
                          '27680','13719','79099','22263','73957',
                          '65783','28082','52240','31088','57642',
                          '52714','70964','40465','75458','75453',
                          '84142','30908','27039','97451','65966',
                          '28557','56322','75455','74394','69112',
                          '41462','64500','49166','29856','20266',
                          '83342','85798','21401','80460','84696',
                          '59556','26273','10139','58363','66420',
                          '63552','92865','71822','47450','90047',
                          '91706','38731','23276','85273','70518',
                          '29678','59831','74930','27322','52864',
                          '17447','66768','71868','84878','71937',
                          '48095','74366','64581','58801','10492',
                          '46738','71395','43549','73785','19600',
                          '43434','98114','85015','24792','97635',
                          '83123','56050','58917','40067','30320',
                          '42738','67157','11875','58075','94499',
                          '62054','43913','75130','60790','57859',
                          '31230','28825','86639','54654','28034',
                          '67417','97364','34212','76356','51635',
                          '45838','44314','25814','72515','40639',
                          '98976','16343','17375','93512','91946',
                          '97161','55068','52772','36533','32097',
                          '82598','50418','47605','56130','56425',
                          '73773','57377','27692','26466','32815',
                          '62564','91801','29688','27865','46102',
                          '15315','74269','31757','79083','57753',
                          '42888','82550','39450','71837','21144',
                          '34953','16774','56109','63477','34911',
                          '95996','29078','11185','67099','27940',
                          '32461','15252','58925','79329','89518',
                          '51953','31560','27089','82371','19869',
                          '27337','29630','91307','18648','51836',
                          '12363','13626','92283','50316','65404',
                          '72726','67884','60036','32189','13129',
                          '69190','87799','12908','69513','51968',
                          '45466','42563','36069','77476','26930',
                          '19134','25024','60162','49046','50715',
                          '89208','57374','40937','63032','41800',
                          '66409','19909','39457','44108','43757',
                          '45012','63189','81214','41285')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1999
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '85484','84475','72699','79891','23778','75664',
                          '93855','68071','73560','52340','48511',
                          '61273','90340','89846','56659','15506',
                          '85365','11076','70510','57697','10230',
                          '25870','73214','83665','33679','97307',
                          '82264','12212','25912','10053','96936',
                          '15282','76572','35172','27841','58404',
                          '54538','55881','27359','93212','28319',
                          '83050','89139','76113','96384','89965',
                          '90634','90959','96123','94986','32207',
                          '61085','95259','45705','13743','76316',
                          '61057','37783','52083','41770','35539',
                          '32654','32555','22143','29634','69038',
                          '93043','60194','51509','28745','63129',
                          '89621','82768','36394','16033','21530',
                          '68359','80953','77088','44084','29652',
                          '79361','96133','55337','93186','33169',
                          '86323','66004','62085','44812','68448',
                          '61774','70654','41992','78673','75245',
                          '37840','16524','60439','94927','48654',
                          '34951','87836','28412','62650','87465',
                          '84323','42553','45547','34381','46821',
                          '45797','72161','56402','63875','79148',
                          '82664','82771','15766','19360','20276',
                          '57657','64762','26585','66780','98610',
                          '61255','26351','54979','26794','61615',
                          '96346','90506','61441','67098','99164',
                          '64360','48908','72837','40152','69981',
                          '81512','88104','20784','70002','40556',
                          '14468','88394','35634','59816','84563',
                          '90570','27513','65203','68297','28709',
                          '43784','86429','48256','45516','10020',
                          '67862','12647','97157','88070','98616',
                          '99876','48009','20929','89997','57263',
                          '95211','99016','50031','31102','55958',
                          '55156','45545','95156','69925','24485',
                          '21890','11765','65029','46515','63865',
                          '40059','27684','79739','43499','41960',
                          '72884','15875','76028','23735','94162',
                          '48090','72713','70779','55996','46935',
                          '11964','43603','28531','33958','59092',
                          '57506','81861','34561','27837','61328',
                          '22471','34927','77233','11630','29801',
                          '48546','27772','99477','13706','75045',
                          '29145','18018','36603','18470','77463',
                          '72820','42599','71609','44797','28563',
                          '36699','91066','71814','23183','61625',
                          '49595','11072','71053','74567','76638',
                          '49194','15398','91260','72883','10326',
                          '47150','38123','32662','45253','92267',
                          '34074','95737','62079','40458','26529',
                          '51029','78382','71420','90239','42050',
                          '73020','99631','88741','82683','40650',
                          '44157','53438','42588','29824','57714',
                          '94682','61011','98697','16042','24716',
                          '40610','87308','83869','24354','37349',
                          '12611','48895','33674','58082','10919',
                          '84661','44541','98420','60084','55874',
                          '94189','85552','91240','45996','99863',
                          '97342','65609','65431','99096','19561',
                          '31720','60378','36235','78601','73296',
                          '34209','33687','59203','43979','76032',
                          '47949','22279','95282','44739','90566',
                          '41205','15158','58539','76771','49288',
                          '79345','67147','33000','54120','36020',
                          '10615','65488','47189','30988','23356',
                          '19015','40939','19379','16022','99685',
                          '45822','90042','97955','75447','27969',
                          '20605','92097','89382','66475','86693',
                          '23242','27495','41244','13329','34490',
                          '52908','14870','59909','77432','47866',
                          '62260','38945','50071','73762','26644',
                          '13989','83005','28168','62784','86284',
                          '61083','72220','66694','29090','92113',
                          '89303','87100','89562','99172','20343',
                          '69671','76735','94889','73187','67267',
                          '87133','96170','29913','89635','76396',
                          '76559','90649','85795','99262','50117',
                          '10619','54812','52438','77459','74248',
                          '72553','31190','69329','42119')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2002
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '18833','21043','16498','67749','19107','51080',
                          '77327','18471','40755','13121','23219',
                          '71208','52797','61689','62689','13469',
                          '17266','13522','33524','64992','35594',
                          '60105','42313','78247','56109','30125',
                          '53642','30184','49414','31450','77957',
                          '26962','93497','84063','55610','65139',
                          '50623','46396','81564','70240','80086',
                          '93383','24921','58750','49995','69512',
                          '92313','12125','59572','69827','65684',
                          '11242','32220','32740','71728','90103',
                          '24603','70307','40591','61282','27648',
                          '81443','30408','26056','64870','54832',
                          '97510','68288','89708','90654','23540',
                          '79261','11884','71193','92947','60993',
                          '19485','80573','47778','16814','67463',
                          '63837','91339','82456','42109','16372',
                          '13916','33120','10331','35349','53582',
                          '79112','52954','62519','92408','23784',
                          '33813','32125','74411','63651','37852',
                          '38839','93656','76203','80999','13231',
                          '39140','86555','53168','42325','83751',
                          '55109','37800','45996','69446','92750',
                          '23289','44551','92667','13725','50754',
                          '32204','52761','18836','53059','33335',
                          '82132','47475','75143','14703','40022',
                          '42554','21384','22741','11867','51746',
                          '73095','60855','32738','23971','68450',
                          '70910','44233','17426','33355','89846',
                          '82653','30383','75664','40857','81788',
                          '75691','97378','80740','65415','32001',
                          '87636','60900','99808','58107','16723',
                          '54599','62724','11793','16731','63191',
                          '21457','86643','81250','73364','87349',
                          '54023','54765','44026','29820','96626',
                          '23191','11527','69193','64085','65928',
                          '99751','79342','40514','28512','65299',
                          '22858','20504','28649','94174','11461',
                          '27791','70917','72719','88423','27977',
                          '19297','40574','99279','38002','99265',
                          '53796','72278','10585','90896','24059',
                          '24442','37069','10294','70275','31673',
                          '47894','15035','30488','56644','89369',
                          '31401','86529','39194','48000','34820',
                          '66418','63825','18701','74775','52656',
                          '33402','21346','78632','63778','52678',
                          '14216','89926','27945','64641','59483',
                          '81633','19899','95221','67272','55332',
                          '28922','45532','34097','13217','55451',
                          '18880','94389','89443','87751','67928',
                          '30831','42319','18487','42663','81152',
                          '12165','63564','68003','15889','97412',
                          '32865','79273','80505','19601','91350',
                          '59677','14000','82185','65382','34130',
                          '70738','22148','83043','62560','11740',
                          '81893','31288','31225','77877','32318',
                          '46712','88875','28241','40493','75911',
                          '81589','31633','42833','96075','69123',
                          '51997','25286','67930','28286','49530',
                          '81240','83461','54092','66419','81333',
                          '78723','44278','81115','24872','46177',
                          '24388','21101','89139','80120','29944',
                          '62634','56902','92718','46570','32530',
                          '87631','92107','68507','59970','98204',
                          '19919','97251','49937','77796','76919',
                          '20348','81120','94696','99421','30242',
                          '78896','47566','62079','32914','95357',
                          '12328','98625','23353','88721','83649',
                          '71773','50383','10632','90664','65359',
                          '15205','32355','74879','36874','21749',
                          '83987','18095','79907','66556','94877',
                          '84528','43035','94354','47145','39819',
                          '93813','27042','23147','35463','21018',
                          '78054','14718','97757','36038','62540',
                          '20055','66396','24692','38823','11205',
                          '73891','47447','15132','45940','23685',
                          '60150','99025','35190','92539','32414',
                          '58774','58102','87188','66371','70286',
                          '78713','80533','25629','28992','85066',
                          '68332','43186','48414','74264')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '37464','53493','74036','26524','25709','37152',
                          '34595','64263','95335','59571','90196',
                          '55908','36136','66725','70736','71462',
                          '27592','39696','30837','76151','58905',
                          '68818','14660','88756','77057','54318',
                          '70396','22289','38094','78715','72152',
                          '15164','97905','74281','11492','57546',
                          '28304','83052','24544','34690','22738',
                          '30741','28324','85976','70368','67819',
                          '88185','21060','96720','69754','63722',
                          '48456','44367','50399','38724','80303',
                          '52651','24966','24811','53243','50017',
                          '81515','91802','53573','59421','90723',
                          '22588','86032','77428','61659','37411',
                          '55093','48366','88149','63357','30043',
                          '83138','62275','22367','97581','89510',
                          '99109','65957','62934','68244','77424',
                          '93088','48023','43380','43812','48600',
                          '31904','51412','75905','13828','34210',
                          '46416','96315','29998','80242','18513',
                          '85600','35432','83319','34169','28875',
                          '50571','71258','70264','58095','47006',
                          '61860','60562','58370','64713','65886',
                          '84634','99647','73891','26550','81152',
                          '17203','91526','69562','66779','84783',
                          '75921','75988','25603','84709','75579',
                          '51021','35910','94990','80465','75907',
                          '17510','76238','27468','87531','14122',
                          '44151','67845','81421','43189','69836',
                          '31880','86627','12599','63488','28204',
                          '47026','40773','98999','22287','93375',
                          '20013','18893','50393','74492','41461',
                          '45286','70353','71943','39025','35008',
                          '16502','50692','50972','46974','66705',
                          '89986','67729','40146','80584','57191',
                          '49296','34128','41890','32107','73993',
                          '28563','56216','69950','97080','58022',
                          '20985','77262','84815','48572','84259',
                          '42826','98276','33255','39973','57861',
                          '55784','36999','70597','16838','13975',
                          '26071','87308','68172','92108','80869',
                          '10480','97869','22806','83534','81806',
                          '19877','78182','93399','17838','62805',
                          '46183','51514','29671','73428','31958',
                          '13954','95394','83200','25085','48007',
                          '79515','84750','31805','98755','61883',
                          '74870','77048','64368','12042','85598',
                          '61270','91774','81400','11740','83244',
                          '98989','82645','67569','70611','83900',
                          '10074','74378','24749','10766','54284',
                          '24105','81170','44406','59614','87231',
                          '95555','64810','46956','13026','46298',
                          '91601','45121','36507','41034','56065',
                          '43087','42287','14305','73196','20627',
                          '86116','84958','94641','57273','17274',
                          '84761','81028','79727','37069','98800',
                          '73964','63628','70830','36104','41573',
                          '47310','78403','71517','63308','79058',
                          '90406','87886','84363','17460','95814',
                          '78921','62218','69528','59503','54086',
                          '23859','48015','40904','63942','11774',
                          '16810','33225','64387','69837','69956',
                          '64336','38727','91182','22363','77290',
                          '14383','61741','43510','72117','50991',
                          '12093','91498','99904','55249','53726',
                          '53585','74296','29326','15286','29442',
                          '80186','15707','64651','66143','93883',
                          '64377','49699','98245','59982','73996',
                          '83755','90081','22433','46239','73912',
                          '25873','12861','64331','92549','95307',
                          '68045','56146','52660','14512','84834',
                          '99362','19661','19560','69757','52721',
                          '96061','24018','96134','75557','18708',
                          '44273','39139','84049','56298','14291',
                          '41488','74278','93053','18792','66229',
                          '69407','42280','77536','42528','65029',
                          '92325','42450','73985','70739','75475',
                          '74504','43652','36052','71432','18500',
                          '79455','60011','57613','25287','81921',
                          '79534','80084','12034','37223')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '32311','19902','14821','41527','21906','11517',
                          '21300','82483','40798','77325','15898',
                          '23150','86146','96761','22918','37679',
                          '19395','21361','70180','14263','63472',
                          '56887','64565','50328','11523','83514',
                          '45068','92819','20678','89632','29051',
                          '95439','94557','44821','46249','39810',
                          '41080','95879','12239','71456','66740',
                          '43847','66580','88031','68386','39014',
                          '97799','51069','98523','46415','61830',
                          '89329','83686','89954','45044','10939',
                          '28863','81709','43496','56638','29458',
                          '10608','44011','69763','45054','64682',
                          '44198','40621','45415','29144','17639',
                          '13940','89310','48676','90989','44726',
                          '62189','58220','40657','47687','67717',
                          '40457','39271','52215','35514','25921',
                          '60116','33021','44224','33766','96750',
                          '97642','88309','40895','74717','16387',
                          '85852','99132','53266','57507','60021',
                          '31692','97111','46291','10715','49042',
                          '12519','87498','87615','39408','20165',
                          '14029','66752','49260','91802','40120',
                          '59132','38359','19872','25357','20127',
                          '79991','71048','98079','64979','82993',
                          '51749','59998','76926','27790','24856',
                          '70319','34362','32204','61050','64107',
                          '72760','89618','88517','55145','35047',
                          '16799','39407','35335','65670','17327',
                          '33892','21854','32642','55954','37512',
                          '66047','27962','29371','38310','98457',
                          '48145','43723','87864','10765','13076',
                          '27598','44469','43821','60661','15919',
                          '48839','75446','25242','91181','96342',
                          '48955','63870','98580','42351','92639',
                          '97885','47957','35481','84133','66782',
                          '94333','82140','63769','31497','66725',
                          '20412','49544','57642','94864','64424',
                          '80602','85401','29001','60807','82221',
                          '81797','62704','52601','70080','30426',
                          '14950','91742','69424','69678','34837',
                          '24993','18889','81408','25257','21246',
                          '20281','83703','59005','83655','55373',
                          '29233','16418','65460','69503','84578',
                          '33551','88371','45462','98191','52692',
                          '34057','61107','80858','95067','10758',
                          '22066','99118','66627','24046','75586',
                          '70010','81401','89055','44052','90826',
                          '79505','22417','25738','53057','77358',
                          '43378','96361','76846','47666','74216',
                          '50446','41702','15787','20384','95852',
                          '86863','30896','78432','35575','39007',
                          '62114','53144','44403','71616','82959',
                          '71865','86800','66658','73766','76935',
                          '38101','52059','36738','46319','66976',
                          '52062','22410','54016','47586','85617',
                          '52068','93160','71971','91948','95442',
                          '98908','94053','58544','13473','66261',
                          '66296','70796','71357','50512','29533',
                          '90949','25370','81142','32129','34054',
                          '59302','81558','85185','51301','67527',
                          '85412','33915','60056','10951','50568',
                          '16171','31286','48472','35630','15044',
                          '24784','69787','59954','67625','34403',
                          '65144','65695','59917','53340','94889',
                          '72864','71651','98169','74156','49616',
                          '29149','82389','48345','23928','78765',
                          '81168','93161','13532','62937','72883',
                          '36240','37541','60555','48149','83433',
                          '15275','37518','57673','29319','94155',
                          '35469','86373','80665','75132','91487',
                          '73866','93376','44275','28549','93043',
                          '26980','42955','24368','78273','13951',
                          '71070','54291','10135','76147','36384',
                          '96507','16120','76197','87573','22827',
                          '26935','11737','34845','30262','10933',
                          '19896','42023','21935','87432','75395',
                          '90297','84245','11813','16903','96997',
                          '41834','38618','38236','24601','32557',
                          '30443','19425','46096','40843')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '57141','32444','52307','67197','60967','82310',
                          '89718','94807','22192','80220','97539',
                          '65747','57650','83656','51067','38429',
                          '76905','73803','21912','31258','44095',
                          '65514','95481','20847','82761','42443',
                          '73371','20488','56918','68141','58337',
                          '63575','73303','37031','29011','46580',
                          '47773','63038','30282','99955','75138',
                          '57244','80881','65201','74096','44665',
                          '77814','68995','35013','34644','95944',
                          '82169','42429','65308','77639','25815',
                          '13604','63110','93007','81623','90001',
                          '32626','16156','77253','12270','89595',
                          '30654','96304','70849','25277','84962',
                          '69135','67164','44055','70359','34985',
                          '86411','73419','63367','21444','13902',
                          '55895','43606','58644','87012','32557',
                          '90382','10661','13278','22281','46839',
                          '87633','33926','16264','57130','49965',
                          '32658','66395','55717','55473','41486',
                          '44853','22271','13252','25156','14551',
                          '25006','41836','57467','10955','14273',
                          '87489','60423','74533','54303','62866',
                          '41807','14792','38488','53403','65104',
                          '97784','30418','85485','10582','82434',
                          '74931','73642','97276','74654','52146',
                          '88496','59673','99318','99497','95784',
                          '94587','85238','58790','16845','97630',
                          '32203','41878','62377','43260','33884',
                          '58354','40414','78896','18835','63849',
                          '53988','32928','68993','26689','63162',
                          '90079','86075','74652','95430','90448',
                          '58001','54207','20039','41911','44626',
                          '56535','16884','98543','12914','46071',
                          '36469','20300','71556','53657','77640',
                          '30496','68854','56353','99141','30558',
                          '69661','59166','42185','61157','76556',
                          '81110','27034','41366','27272','44026',
                          '11843','44223','53894','22151','98139',
                          '82775','14816','62437','29874','81428',
                          '70625','78621','37920','83441','42889',
                          '24378','83866','91446','25178','75640',
                          '92070','56175','22652','90125','47404',
                          '13028','62574','41094','29355','72905',
                          '72235','59341','55233','55008','28201',
                          '62601','22246','68876','69910','32688',
                          '70239','43039','31938','33404','77115',
                          '70435','77038','92470','41743','12393',
                          '75883','58499','69588','95438','55340',
                          '36229','81784','61961','97131','23925',
                          '94985','20788','38723','95748','56001',
                          '40510','60621','13771','46486','77661',
                          '65656','24315','37517','75448','65791',
                          '80889','48777','58139','61279','27083',
                          '52315','19516','59295','34407','58533',
                          '58329','96428','43640','82724','18784',
                          '40764','48778','21127','81507','34221',
                          '26767','42363','80630','40221','67914',
                          '56937','51989','22344','51642','37417',
                          '57313','74913','79229','70744','90117',
                          '68055','51788','62077','43657','14832',
                          '36427','86394','86639','78050','23773',
                          '79164','16913','64017','38575','95602',
                          '99830','52346','52840','89427','67175',
                          '51276','28085','25038','95032','61504',
                          '33482','17466','25704','75994','62393',
                          '35602','17273','75013','51182','99956',
                          '98073','11939','36580','40602','86770',
                          '61889','38815','33476','94730','52742',
                          '81717','54819','26931','48989','11995',
                          '74004','78367','86622','64600','69967',
                          '47679','99361','84006','43193','23075',
                          '91975','88606','10021','25246','48673',
                          '54043','68922','34768','60057','81642',
                          '87395','25278','87312','90078','68329',
                          '35173','11393','28083','54573','78525',
                          '25452','27320','52266','38235','68110',
                          '31247','27939','32866','38262','33107',
                          '62636','85544','95303','62278','59747',
                          '22505','87434','14683','10749')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '64632','76324','18286','18536','81565','46269',
                          '61435','95284','17786','60139','40650',
                          '44587','44138','17608','14506','25933',
                          '84285','26768','33423','74612','54075',
                          '55764','96127','94485','93329','10019',
                          '27295','33610','36823','23456','18148',
                          '68208','20684','70998','18407','83460',
                          '95382','71285','30669','35274','26313',
                          '72158','72419','30880','46229','90094',
                          '31940','54256','25000','38782','35417',
                          '86018','42313','91566','44659','89955',
                          '12517','77264','55072','48072','11835',
                          '57518','29989','89658','78136','95987',
                          '56966','85286','57452','95988','78441',
                          '14788','13016','17201','38531','36794',
                          '89216','18741','82717','43015','46146',
                          '30390','67371','88613','90922','25891',
                          '77218','71393','67139','99346','20093',
                          '40142','38163','57230','88366','77760',
                          '94400','85746','97795','96314','96815',
                          '21531','40777','24578','34951','60282',
                          '39338','95921','62567','41050','69796',
                          '75805','31128','69497','36300','93299',
                          '24166','11673','64784','17162','62497',
                          '68918','81647','87431','62172','11717',
                          '83124','98758','56020','13324','76478',
                          '62345','75353','81753','34866','22474',
                          '92209','74774','23084','56200','90453',
                          '63322','28852','98284','67328','82298',
                          '20888','44665','43722','95030','57279',
                          '29248','70949','42682','85984','54598',
                          '60331','24135','20495','68826','17246',
                          '28340','99079','37144','88274','29957',
                          '81068','50282','81438','43765','43979',
                          '70688','39759','59096','70051','28036',
                          '41373','56068','33993','90316','22341',
                          '87852','60917','65315','49670','86617',
                          '26183','43490','60691','15107','25294',
                          '32672','12549','69938','95831','85375',
                          '29549','48577','99391','13005','42614',
                          '95038','68556','59696','56013','24379',
                          '58561','32381','22189','19540','99855',
                          '81614','73535','94022','55109','76250',
                          '39129','56672','13849','73050','24100',
                          '28603','93903','32112','21102','69309',
                          '81967','40456','84822','77365','12145',
                          '81255','51030','76018','72050','41477',
                          '88529','50840','77804','79843','30024',
                          '42072','19703','31910','49885','80348',
                          '15208','20426','22103','21984','98881',
                          '12550','55279','24620','35175','18848',
                          '57161','26981','14321','34051','11184',
                          '38276','41679','72285','92076','30737',
                          '58110','82369','62632','61511','20340',
                          '15693','77425','75653','40695','17200',
                          '26450','19060','36182','59200','13581',
                          '21569','84665','62953','23056','72228',
                          '63105','28139','81493','96175','11564',
                          '70480','30540','95952','64648','95228',
                          '11972','95543','17428','22812','37179',
                          '86970','31222','29302','38950','32755',
                          '87640','22607','83336','54115','75801',
                          '41641','66847','49934','86910','81556',
                          '43667','30715','77515','87890','16921',
                          '72153','64585','63984','19055','22179',
                          '78116','93265','28231','36470','21243',
                          '81264','53834','21285','56650','44448',
                          '40856','89623','48679','22027','22759',
                          '12776','38966','16541','27438','58869',
                          '92791','68087','62493','44685','27425',
                          '95395','24708','80853','49869','56152',
                          '80401','87676','17724','61002','40469',
                          '31699','21289','44797','85453','60006',
                          '72755','19065','83420','17928','44601',
                          '89332','41036','65016','67296','58879',
                          '10670','30318','91765','23903','46447',
                          '41828','19010','95082','86044','97693',
                          '94384','17316','53998','46897','38358',
                          '71977','38057','59723','51438','46636',
                          '94625','32481','32258','79746')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 1999
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '76560','73575','37981','11712','94257','96108',
                          '65551','31212','92137','24954','11855',
                          '32929','64280','29634','59841','30893',
                          '97132','20107','59481','91219','81863',
                          '48846','61204','66748','48126','89208',
                          '67994','23322','41489','68258','73196',
                          '84986','66666','34501','53893','33405',
                          '26450','99328','30293','38467','31394',
                          '37774','25558','62379','81751','53645',
                          '86353','77723','71164','25705','16878',
                          '45853','48381','65705','94424','95599',
                          '72656','29433','48619','69027','63287',
                          '76479','91227','92782','72947','87916',
                          '34581','14209','80730','20684','52404',
                          '25376','62665','91099','71737','57702',
                          '28291','84106','65289','76943','95253',
                          '51860','91030','41704','40763','35229',
                          '36746','61404','49620','98571','37743',
                          '35143','93869','52637','15629','28209',
                          '14522','89157','74770','11981','11803',
                          '44228','14094','82701','93627','37403',
                          '45381','25128','35015','97089','43091',
                          '59548','10421','14984','55002','72866',
                          '74203','64611','39222','72978','18531',
                          '64838','65545','82622','39424','60729',
                          '17152','14603','30274','96354','73581',
                          '42398','56769','95907','27146','89243',
                          '48434','15463','96093','20357','44022',
                          '67242','33030','80501','38906','13640',
                          '87379','13489','78870','12236','26639',
                          '92455','59397','60445','78337','69781',
                          '65679','39220','86344','65878','42066',
                          '33845','63241','13997','75932','24169',
                          '83371','49151','49719','17911','94337',
                          '22905','74362','93950','20309','47310',
                          '76567','91625','30078','99133','26681',
                          '23159','54491','15203','55310','89856',
                          '76367','34326','57826','62878','95335',
                          '71812','13311','25527','32203','71979',
                          '32057','66702','26241','75030','33376',
                          '44548','13061','67258','51369','25550',
                          '71787','58353','54354','75350','28547',
                          '57503','28756','79316','95896','17290',
                          '77827','47029','62322','11235','48442',
                          '41141','89833','30402','64544','34461',
                          '24429','38807','18250','57918','53358',
                          '45077','22395','18150','62171','35777',
                          '63687','78862','84134','62911','18432',
                          '45929','82476','30153','56068','75609',
                          '74681','43267','16924','47645','52338',
                          '28042','42473','92500','14243','38971',
                          '10479','14879','38741','20416','96796',
                          '33497','17414','38738','78773','77041',
                          '32753','92762','28409','72073','40270',
                          '83526','88699','68312','10378','30412',
                          '14216','70115','91519','92617','15301',
                          '42557','33807','21442','52208','36463',
                          '92670','25164','16467','43482','89735',
                          '12051','72838','69955','80721','22563',
                          '56510','49551','55547','79318','50491',
                          '35390','81402','55822','55148','87723',
                          '18407','89954','38205','47921','70839',
                          '20473','79488','50313','50138','32155',
                          '22673','12399','69315','87652','53822',
                          '77182','36735','79458','93986','44185',
                          '36323','24550','31067','22706','58257',
                          '85151','29115','39634','48090','90729',
                          '52813','40490','55368','13467','69585',
                          '52020','81061','35571','86700','62714',
                          '33532','53236','23814','63261','66248',
                          '93412','39610','97901','53177','24107',
                          '57170','45431','91162','10931','10540',
                          '40625','96259','37023','61326','86772',
                          '37109','21736','60100','35038','66782',
                          '81187','42850','79693','33650','13335',
                          '60127','16470','58271','62229','79822',
                          '76783','62571','68326','59565','49506',
                          '70571','59059','50966','40829','21438',
                          '87790','37746','98199','15359','45276',
                          '65178','76642','44335','59240')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '42263','11392','10532','99331','39578','34547',
                          '18988','85571','92222','87805','96794',
                          '59609','99642','30975','47315','81594',
                          '59643','72846','66968','23269','68292',
                          '78364','13247','18546','18944','67418',
                          '91078','53254','40839','88441','48348',
                          '58029','69626','32205','35117','61329',
                          '61362','87218','47563','29020','67208',
                          '23783','18801','30389','80527','97089',
                          '31886','40924','93161','11229','66455',
                          '26803','33257','37076','79170','27527',
                          '19740','79859','73448','46881','61269',
                          '48385','32262','64163','64387','45948',
                          '87101','24181','17038','72513','98554',
                          '74572','91558','13717','71851','61839',
                          '78376','92403','91971','98390','17401',
                          '42602','50809','25417','56777','44840',
                          '17679','61956','59813','11615','97964',
                          '85575','80058','22244','30189','21768',
                          '23336','26366','56691','78912','40324',
                          '30004','96670','93297','59082','56655',
                          '90057','90909','27571','32194','35574',
                          '46447','18644','91537','95576','60233',
                          '12058','51538','95104','41077','93919',
                          '99797','71382','94815','81600','57036',
                          '91749','54342','32831','41731','68131',
                          '39163','15746','39858','20113','28510',
                          '70603','91940','41915','90846','50367',
                          '31824','83431','58221','25972','88245',
                          '30200','40532','47875','97817','40173',
                          '11312','62714','42022','15290','56571',
                          '20244','19951','39520','44716','59088',
                          '66929','60467','88422','67682','71880',
                          '36574','12696','98110','94355','33345',
                          '39366','45307','54148','13641','68349',
                          '48202','44653','51387','63588','69349',
                          '71856','82611','18012','88509','41620',
                          '14448','39463','85525','93206','61536',
                          '90528','51064','88986','85621','76986',
                          '31732','73552','42993','52709','19334',
                          '63927','58601','96895','42018','44082',
                          '41403','77916','67258','25445','52209',
                          '72468','95239','94191','83477','98048',
                          '51354','37619','84063','86025','37494',
                          '21166','34548','54399','98170','60558',
                          '46113','29191','86566','91979','35922',
                          '33286','13788','26032','22783','49973',
                          '41335','59516','62926','63609','55420',
                          '39822','72805','65032','39841','80136',
                          '49665','54204','64247','41059','97969',
                          '13894','80105','50876','13405','42072',
                          '92807','89933','67360','41667','74409',
                          '90034','75747','23030','84888','74542',
                          '59844','13903','96086','86764','31874',
                          '68429','89250','13787','50632','28467',
                          '64126','30163','91096','97682','11647',
                          '61833','62766','48535','78183','26373',
                          '22752','50756','49890','41455','69984',
                          '43093','12102','45528','32010','18431',
                          '97528','69335','87577','44769','55040',
                          '58593','92194','17731','53319','54308',
                          '84721','33059','90757','74563','84855',
                          '89330','35123','45075','50319','85484',
                          '91473','74267','71128','71490','21506',
                          '37247','64992','86159','61198','57185',
                          '45408','32893','26063','76338','58943',
                          '83883','81137','11770','57446','70867',
                          '39478','94009','28918','30067','45436',
                          '11236','10408','30827','38961','23826',
                          '54341','79206','38344','33943','58906',
                          '65344','14941','31777','87233','94073',
                          '15471','92727','64645','25792','23016',
                          '21695','23034','98647','77248','69985',
                          '57777','69263','70024','53252','14513',
                          '85830','16857','44487','49156','72883',
                          '15918','52777','45243','17725','17734',
                          '13097','45989','88268','19582','93089',
                          '86296','57705','36070','71599','12880',
                          '53021','59942','44585','39503','17664',
                          '87547','99532','39443','35839')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '72218','77561','76885','81690','12862','35286',
                          '67231','78505','86680','63412','53428',
                          '82432','83657','38771','26823','37178',
                          '15258','17265','56603','29894','85486',
                          '22117','93772','71331','98403','46809',
                          '58366','62521','42229','70246','30578',
                          '65866','33911','52521','11047','23005',
                          '24618','49492','89718','60404','48232',
                          '21232','38923','57373','88187','91725',
                          '99573','73362','49157','71408','93590',
                          '53956','73852','39767','64760','42809',
                          '91224','34223','24342','69948','24231',
                          '88893','59449','85000','11865','39614',
                          '96856','87516','59123','72135','56512',
                          '46553','62612','33983','47296','86628',
                          '23216','55443','36407','27224','93342',
                          '95271','79627','89281','88771','71607',
                          '57616','12014','47487','44401','58965',
                          '66644','40193','40341','98419','43027',
                          '81964','79916','65029','39204','59142',
                          '65314','47366','21541','36288','27591',
                          '83285','76768','82938','75523','69506',
                          '34216','56471','85643','95930','75133',
                          '88501','51057','48147','58169','34868',
                          '34391','59927','26837','30993','27257',
                          '43963','85026','95564','42038','20452',
                          '43663','55450','92399','41299','15886',
                          '18320','24014','45829','72317','36436',
                          '14618','81336','41076','77577','47891',
                          '85175','74856','66582','41712','86518',
                          '54920','86133','51381','12062','38671',
                          '15198','84379','92795','40718','75342',
                          '17414','11128','70604','15547','68655',
                          '96120','63401','98822','43598','73547',
                          '91193','79836','56392','35887','44768',
                          '25898','12485','13022','58962','75817',
                          '60367','48863','66696','43135','88596',
                          '90599','38587','78763','66686','97455',
                          '93188','62625','96231','15928','86925',
                          '50926','93917','16855','71072','24193',
                          '89102','22573','21349','94291','40496',
                          '15293','26056','92460','11905','27745',
                          '31961','38304','52269','69113','33897',
                          '97547','98932','44703','41424','85577',
                          '77834','44093','67542','79867','39194',
                          '77579','34212','58068','56271','82030',
                          '55244','73550','24161','29046','79668',
                          '63766','27455','42943','62044','91133',
                          '46535','47056','14495','52287','63008',
                          '21137','99027','20679','75621','60409',
                          '23533','75404','59452','37890','87878',
                          '41441','90382','94753','95669','62892',
                          '67878','80968','76237','25045','91901',
                          '23012','67445','58271','82700','70744',
                          '23622','61676','14840','62884','60141',
                          '79145','98546','22298','49026','72688',
                          '38837','14214','93061','92241','52664',
                          '61372','66830','17801','97459','28915',
                          '29065','43061','84573','74817','15670',
                          '25050','52805','75786','58821','52990',
                          '92377','68694','57729','66463','31853',
                          '84179','12396','79696','53570','16981',
                          '18427','11532','77125','95467','67724',
                          '40615','82263','41912','95817','81265',
                          '41103','70902','49064','79633','16503',
                          '47354','80199','45409','63736','80081',
                          '24922','97771','69846','85079','83517',
                          '89868','97020','56621','14966','78311',
                          '12521','31575','78074','75025','45542',
                          '48545','87376','14047','98082','49278',
                          '18436','51062','66120','57965','72650',
                          '91828','24962','56699','28221','23620',
                          '55318','17536','61083','27906','24998',
                          '33864','36735','81035','72523','53468',
                          '81348','52576','33178','35023','39477',
                          '36466','86839','76063','70159','78327',
                          '19362','40295','15473','15709','81460',
                          '74752','34323','71844','14672','29070',
                          '88924','46461','84001','96610','17644',
                          '74722','49429','58973','19498')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '75469','55647','18047','76975','96719','49121',
                          '59120','77333','80418','17202','16076',
                          '76048','35762','18327','76773','41352',
                          '39189','24695','32202','86362','27027',
                          '45643','25686','19013','36341','87566',
                          '68536','71665','48878','88228','38180',
                          '34758','47038','87274','27914','83637',
                          '55518','67192','34563','82829','70104',
                          '67445','31834','72366','63114','18710',
                          '65656','32522','96933','62595','59300',
                          '38136','72488','45325','60883','11901',
                          '48319','82360','28566','51835','62796',
                          '69567','85181','90149','75000','30901',
                          '26332','58740','20485','40262','22271',
                          '59131','22884','25248','50410','67213',
                          '51960','12779','97306','76352','70091',
                          '79384','79969','32334','88354','96360',
                          '18155','15532','22553','16684','84225',
                          '84678','46669','91330','32047','75759',
                          '53722','15830','31359','46459','33746',
                          '43250','97602','80373','86279','55885',
                          '43503','87679','83989','53260','35102',
                          '61929','24730','72086','39207','38750',
                          '83768','52097','74775','67851','23701',
                          '80146','60115','57632','74103','92207',
                          '33319','53393','82539','87198','74209',
                          '27294','43767','66854','36381','75470',
                          '84060','49830','61645','79740','14880',
                          '41094','38655','96981','73225','26375',
                          '68539','65955','67012','72284','63061',
                          '74079','45809','42938','11732','83452',
                          '59204','81984','71961','33738','78662',
                          '53808','44505','14500','27738','19224',
                          '44581','72497','72787','69316','84623',
                          '14390','11308','16747','37829','16792',
                          '20178','17454','32772','96901','65415',
                          '68551','86236','94292','86759','25576',
                          '95250','54058','82724','66017','54776',
                          '85582','46144','80160','49387','73809',
                          '61779','64787','68295','25993','72534',
                          '74087','10929','45068','78254','14333',
                          '49102','13118','71963','91296','47407',
                          '73430','61751','45381','13360','79959',
                          '41995','89964','74135','98517','32464',
                          '41568','89077','88588','28903','59447',
                          '44567','67506','52451','25729','71632',
                          '31898','88437','31999','87248','41103',
                          '14173','25740','43722','36652','67973',
                          '73995','59582','67863','61686','76190',
                          '57761','50761','45017','46823','54388',
                          '98559','70069','18715','21649','94412',
                          '77394','93180','17752','89342','36663',
                          '10779','95401','21502','25871','59839',
                          '23542','66656','80423','71792','76001',
                          '42750','48791','75222','30092','14191',
                          '29846','74138','64973','96744','85819',
                          '62862','37256','69513','82909','40337',
                          '34915','62169','98300','35861','39187',
                          '34388','79304','19730','53922','10686',
                          '92457','96980','29633','20953','39277',
                          '52037','45814','89494','54129','44692',
                          '54244','26143','31771','62104','65517',
                          '58643','97195','29704','79253','74212',
                          '25506','63641','50689','90602','44697',
                          '97291','47826','57303','93077','50350',
                          '21327','17382','50011','84895','44942',
                          '73451','87537','17150','62605','74900',
                          '58042','26792','63152','32998','79941',
                          '34538','46121','33820','78751','13177',
                          '79618','84649','76310','47518','35173',
                          '11358','36796','37621','40821','18146',
                          '16799','56584','97883','21385','79351',
                          '47899','24767','57048','27982','14787',
                          '15156','25261','41246','21064','52338',
                          '13650','88223','38718','95300','53082',
                          '13089','31077','73312','13769','63261',
                          '64706','79798','19191','86904','44701',
                          '79025','43308','40257','37655','39345',
                          '69538','74650','81459','61721','18207',
                          '10768','18537','99024','26258')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '91725','36047','29193','19364','78332','50344',
                          '30831','23688','49172','67183','45618',
                          '60317','94417','85352','99438','68196',
                          '96145','12164','11514','30800','79545',
                          '98555','29560','13810','66306','13539',
                          '21417','30343','20778','69148','86552',
                          '72441','75620','54393','98190','56741',
                          '59862','43973','56105','42039','59021',
                          '41092','53713','67674','85465','31791',
                          '95758','43949','20804','30049','84966',
                          '50274','30172','27599','55097','71706',
                          '98297','47557','72744','10442','73829',
                          '51065','16410','18613','51749','36980',
                          '60044','46844','45080','61655','98217',
                          '19290','84522','95977','40640','48691',
                          '95917','13805','32698','21348','67290',
                          '85186','18986','98913','34663','14563',
                          '98593','26132','12362','97136','39220',
                          '81020','82856','63904','46515','24374',
                          '93467','22961','29905','64083','14352',
                          '50813','51151','36709','85430','76425',
                          '43968','15467','68127','45772','27533',
                          '79903','21017','45677','76797','66033',
                          '76492','50453','94530','26860','78785',
                          '47302','19240','46015','41951','13383',
                          '19655','26306','43378','96558','67276',
                          '73423','34849','62420','53406','51354',
                          '91187','46154','98245','59860','88587',
                          '82868','16258','43529','11483','42326',
                          '18902','11640','12243','28263','71276',
                          '13405','30420','21688','90478','23841',
                          '80600','26779','95786','23524','79452',
                          '14360','81635','45737','77576','10122',
                          '40620','59520','93335','94658','95571',
                          '11069','89192','73377','86953','21526',
                          '99208','50247','91517','75693','65828',
                          '90689','14062','94104','33972','78831',
                          '77649','60793','65886','68527','34165',
                          '34596','40839','30993','61423','19659',
                          '80195','56318','56341','54181','22800',
                          '94771','38447','18216','73702','76196',
                          '37684','59808','23959','40880','32628',
                          '48566','98532','18853','73159','22893',
                          '62758','88218','56010','54637','68020',
                          '40789','97096','80867','28904','57619',
                          '80781','93564','61863','87362','27706',
                          '75206','62413','24007','83650','93192',
                          '25823','78940','55230','83511','82319',
                          '75975','22584','90375','39607','72221',
                          '58462','51407','33990','20020','24111',
                          '25972','83397','22427','85456','11961',
                          '61353','53235','78666','90584','41110',
                          '71938','56401','82534','60804','79354',
                          '36036','54529','97140','42433','48155',
                          '64892','46547','58059','70105','34308',
                          '99585','69483','44552','68157','97604',
                          '37438','90351','49564','60378','88212',
                          '38561','91300','59163','23953','36856',
                          '11467','67642','17745','34766','38022',
                          '49930','53547','57107','23701','69668',
                          '39966','33954','35880','19872','41876',
                          '17868','33436','89413','86592','65600',
                          '92152','81391','79436','11874','84625',
                          '52066','25091','35209','18920','78774',
                          '58580','25111','25321','56868','82083',
                          '90953','11302','20102','49423','87991',
                          '43947','93202','40041','33515','63287',
                          '39803','32656','52665','40643','33328',
                          '23542','66728','67496','58663','12412',
                          '85607','18792','88230','78308','62447',
                          '86605','97334','55201','37502','93924',
                          '73759','44689','60283','13652','99279',
                          '42156','29884','68133','94212','32456',
                          '55908','10889','85216','56267','32191',
                          '93103','49984','25891','11472','54650',
                          '18027','70342','11822','84671','11470',
                          '95173','72742','39351','37999','78566',
                          '49403','76853','10048','39032','38658',
                          '38764','13635','93693','21786','69972',
                          '62511','68043','84062','43489')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2002
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '62779','58342','56863','13647','48820','36189',
                          '44171','28745','39266','35475','93364',
                          '78970','70954','22939','57705','72211',
                          '42911','29422','83260','48639','76408',
                          '36034','29399','38736','18926','20586',
                          '84213','17876','32143','54847','60276',
                          '67041','83633','36642','50543','13599',
                          '57092','96152','64777','33322','36783',
                          '37725','99022','11393','33793','66032',
                          '13862','88505','80555','93378','20525',
                          '43420','57364','93298','95598','16740',
                          '15471','79033','17711','37810','34451',
                          '35343','76767','86081','98762','60714',
                          '39123','50135','12044','40805','48424',
                          '38100','48306','31518','77195','43768',
                          '59165','37743','25098','66624','66772',
                          '99243','57561','92939','70446','66151',
                          '72764','27134','73177','73004','61491',
                          '11440','22838','44351','28274','33219',
                          '50319','60897','57160','71721','97177',
                          '20994','30230','49467','64108','89254',
                          '11632','65590','62683','16939','34042',
                          '10106','74463','75019','42590','55408',
                          '41674','49715','35114','11369','25767',
                          '94229','25869','50359','55822','68448',
                          '45742','21536','40361','76713','50713',
                          '16305','27937','10194','82869','14673',
                          '61301','73470','12390','36671','29386',
                          '11350','71626','29795','26227','39876',
                          '94946','47739','77239','38281','11165',
                          '92028','16187','60988','85935','21910',
                          '46383','98276','36903','36946','76702',
                          '32089','65378','62534','51423','88793',
                          '80473','56901','13863','73002','80107',
                          '98734','42878','48515','20984','88217',
                          '57165','72893','64614','86066','87307',
                          '48546','37336','96248','96995','66565',
                          '58845','86233','25698','57421','66243',
                          '23109','43327','54214','99964','30613',
                          '55370','49343','57355','43763','39146',
                          '64525','80815','34640','80030','79206',
                          '65010','59395','84792','15423','88063',
                          '62249','20611','62004','98428','82593',
                          '59007','38890','94825','67748','60676',
                          '96895','85807','78523','16479','56494',
                          '24541','68024','39339','41727','89802',
                          '44864','38815','81750','25340','78151',
                          '68234','39353','63018','13110','82563',
                          '88865','19311','37526','72341','23181',
                          '73811','95981','71214','11326','73107',
                          '48245','81309','84087','21594','37991',
                          '75387','45434','34378','68765','15687',
                          '46309','67209','53424','96757','26929',
                          '91558','46371','97622','21615','95391',
                          '40119','67384','38681','21571','23617',
                          '45695','77333','20929','64773','86389',
                          '89405','16568','73649','97596','34442',
                          '42642','42132','78288','62470','62442',
                          '45549','31874','40389','20667','36645',
                          '45322','40594','43625','44760','54339',
                          '51634','85819','76962','93631','74272',
                          '47852','74634','14269','94242','76213',
                          '80609','28620','57613','31422','87347',
                          '93690','94456','20108','67329','12278',
                          '16469','91334','93275','83638','77023',
                          '26999','53246','31380','89635','34281',
                          '77744','88583','95936','65697','66585',
                          '11037','85919','27262','11019','52277',
                          '48473','46045','67167','68250','72812',
                          '74284','41278','35928','84974','91207',
                          '85643','95437','66857','75899','92039',
                          '88368','55215','85026','18282','28155',
                          '55111','53609','93736','72230','79347',
                          '77396','25285','43490','49399','65607',
                          '79864','96550','83932','83468','74087',
                          '83412','33818','17160','84123','47906',
                          '77213','68297','28387','40444','15528',
                          '85778','22590','63344','58723','53477',
                          '65291','18882','32160','42234','96524',
                          '33586','71371','24169','48203')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '49770','50155','85134','58226','35915','12253',
                          '33032','64143','92459','36330','15014',
                          '62038','14074','62040','73460','49311',
                          '20021','40850','52259','54582','71629',
                          '17462','62432','76910','21270','88580',
                          '98634','38435','64097','75254','43109',
                          '42757','71411','75071','32013','60093',
                          '69819','35738','26884','73789','11635',
                          '32766','72918','43005','78153','93684',
                          '36093','89410','43609','47559','15495',
                          '88284','94123','55061','80443','60326',
                          '89290','74616','75735','46700','74667',
                          '10951','36670','59718','92495','51380',
                          '91379','39489','42926','62279','70994',
                          '90751','65024','85271','93781','43043',
                          '67141','96978','82720','57021','71549',
                          '51883','22787','14921','94168','13954',
                          '34448','63918','71394','84249','23515',
                          '17589','76886','93035','66010','31546',
                          '19912','80068','72759','80776','69834',
                          '84505','85589','11175','34583','30826',
                          '16206','49849','48117','20700','94133',
                          '97724','40583','99984','73075','90674',
                          '40608','78915','82869','17749','95650',
                          '59989','52676','23208','91908','21272',
                          '18683','83873','82736','99145','47918',
                          '66815','76183','78615','67926','56284',
                          '68198','41791','27027','23338','33642',
                          '25478','65609','70311','12337','35223',
                          '22770','53147','17900','41460','44857',
                          '27814','54289','31851','62977','51547',
                          '28344','80349','61433','81856','18082',
                          '69112','45965','68626','58927','55085',
                          '75870','92039','16220','80132','67294',
                          '22652','86671','72301','97387','19388',
                          '75453','22013','53330','57062','76736',
                          '75839','26887','53183','75933','48555',
                          '58521','50144','45547','60151','79418',
                          '47039','96286','28560','91107','36758',
                          '61898','55879','38282','64116','18991',
                          '94068','26150','21451','76281','83478',
                          '79542','14707','30131','37904','87672',
                          '16825','95857','37988','89378','97590',
                          '71725','10373','88129','89561','68896',
                          '37615','33955','83546','45998','58496',
                          '72013','55551','77753','98191','22858',
                          '28190','84767','34830','88896','85901',
                          '57860','33769','66924','81978','89753',
                          '87576','17169','17778','50666','33783',
                          '77779','30990','62682','53350','78963',
                          '87820','67376','33239','50540','11093',
                          '13273','37014','54670','44028','59021',
                          '65121','15417','53810','91833','22924',
                          '82665','56604','82477','96086','38486',
                          '46622','65236','34047','67410','82036',
                          '19740','87761','77230','99646','12254',
                          '51087','89164','91293','42436','30654',
                          '20457','97789','34570','32825','35666',
                          '11840','39457','32886','62747','12751',
                          '35523','73273','30814','35769','74278',
                          '64888','42102','85189','48484','42526',
                          '53702','30319','71954','10230','96630',
                          '32737','31516','38366','77173','78862',
                          '17556','37044','63691','38333','99049',
                          '86167','85327','68657','60827','21498',
                          '98898','72753','74924','35510','64733',
                          '37109','63342','11902','32873','41545',
                          '47999','86385','69876','67839','84581',
                          '93383','71018','48576','45311','31770',
                          '76449','90326','94718','23911','77132',
                          '56597','49164','65777','76644','12021',
                          '80828','87123','77908','83099','34694',
                          '68978','16430','84253','83933','21684',
                          '30377','54888','55084','29093','86726',
                          '31096','85584','78512','62486','95753',
                          '88160','74141','29849','63665','59152',
                          '80871','56990','60039','41670','26730',
                          '71915','98171','62209','84140','96241',
                          '72064','17460','60044','89087','73124',
                          '50845','61585','83295','85792')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2002
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '93407','87053','67994','72002','32580','12927',
                          '71423','53955','63957','33519','63460',
                          '37120','18486','31223','36620','36675',
                          '81209','87836','13487','46869','55994',
                          '65628','45998','34549','35382','78217',
                          '98579','14745','35517','58481','31875',
                          '83237','66865','50268','34112','59711',
                          '76091','84439','16005','65163','88853',
                          '43518','68736','34086','99808','35697',
                          '74572','18632','52734','68677','12298',
                          '47628','85236','39868','15758','38090',
                          '42313','62684','86119','89487','79881',
                          '11987','28106','89601','88300','51734',
                          '84767','70029','33414','53123','44241',
                          '25669','10526','73658','66053','95080',
                          '46206','32983','27763','16044','14393',
                          '42970','83784','76733','66540','38441',
                          '60869','35364','35980','92457','24643',
                          '65066','73612','18547','41541','68895',
                          '54424','66475','17877','26805','54925',
                          '34442','42820','44646','66734','14498',
                          '58673','51185','19326','27224','78446',
                          '79926','28533','42243','70178','73563',
                          '73524','69750','81204','54664','36592',
                          '32678','69537','88808','10109','89042',
                          '53092','15351','72550','34888','82035',
                          '86607','33427','51060','74846','86218',
                          '76151','51590','29208','56800','73155',
                          '46889','33588','61496','13552','57486',
                          '65661','53190','32318','35120','48231',
                          '34460','33180','13409','69632','99481',
                          '46156','44550','41116','99943','75224',
                          '18564','64725','51676','20592','41175',
                          '55293','36036','35084','78728','29159',
                          '66511','51348','28456','23200','97441',
                          '10893','63304','27072','34667','65814',
                          '70725','91668','95049','66462','49771',
                          '12705','86009','59174','78403','14512',
                          '40780','40903','82500','53998','84817',
                          '85386','95458','73657','44765','21967',
                          '73101','34839','93262','46583','29255',
                          '70720','51202','27003','72514','51793',
                          '41944','13849','97541','43005','98354',
                          '50625','55613','97488','61085','32804',
                          '43468','55640','66841','32036','47342',
                          '36747','43785','94800','33623','41688',
                          '11598','62772','10823','60287','73613',
                          '60637','38489','18473','98529','49909',
                          '57602','87033','10036','24392','88380',
                          '24844','27576','61703','82707','21024',
                          '88590','75776','70568','63885','80164',
                          '91074','40432','99575','69623','29012',
                          '91843','25830','12291','51339','40192',
                          '55427','90713','41781','13469','67836',
                          '49478','97109','38592','67623','19786',
                          '13100','28580','45636','74698','20658',
                          '17201','99544','40569','57789','21701',
                          '18464','41307','90184','72168','96488',
                          '37601','94977','42557','86072','77487',
                          '51527','79894','54668','24513','30581',
                          '88731','50824','46013','25610','55185',
                          '86992','12451','56580','50384','84769',
                          '29695','85798','72815','42087','67030',
                          '37364','15870','60807','72867','59789',
                          '12247','60923','63697','79088','42544',
                          '88561','63391','46549','55168','92340',
                          '58905','88909','28572','34712','52145',
                          '57408','88570','53091','10407','11751',
                          '90801','99574','27187','34537','75289',
                          '58746','28608','19855','74728','49672',
                          '88862','57203','67455','48534','19721',
                          '40231','28060','67920','95243','75754',
                          '77836','32307','30149','41650','62592',
                          '53183','56428','36335','83594','51481',
                          '74494','67971','62341','43490','19407',
                          '45722','79518','78380','35699','56627',
                          '11986','14580','48268','93713','66204',
                          '11943','16828','47320','73940','17575',
                          '23971','41034','54975','53811','41029',
                          '81475','35280','41559','40799')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1999
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '69480','76534','67502','86825','96133','67918',
                          '99817','86370','44753','84658','85358',
                          '20228','83231','52339','12003','51545',
                          '51657','34287','22067','67812','45934',
                          '79084','56558','85734','70532','99800',
                          '59950','16659','17739','82708','48274',
                          '96597','35128','31415','43372','89341',
                          '24582','36267','22611','49238','77691',
                          '90351','51861','29485','87074','16440',
                          '48069','46693','16460','63895','29609',
                          '76306','53373','51969','72513','83249',
                          '15861','91622','96348','15424','24304',
                          '45131','68797','43674','45020','58869',
                          '23248','69447','56851','73775','56354',
                          '64081','34838','73139','48760','46280',
                          '36117','54998','10343','14517','57339',
                          '94254','76140','61683','14292','86102',
                          '92977','63689','12543','89190','41638',
                          '70276','13241','98919','64618','27528',
                          '77955','56911','97469','66702','64074',
                          '21687','89358','27458','39517','66881',
                          '77828','30383','92632','98778','57513',
                          '41669','62430','55135','56536','76404',
                          '68316','42407','38826','85169','81924',
                          '75068','22714','77355','81009','91513',
                          '36993','99285','85942','27194','47131',
                          '41312','15796','63686','97153','21072',
                          '50685','98451','58388','32102','44086',
                          '93243','39378','97015','20908','14084',
                          '42017','96600','30615','69644','56357',
                          '89528','86894','25979','25912','55672',
                          '65514','55538','33055','65833','62099',
                          '28549','89339','29178','13780','69296',
                          '47935','42468','96140','23832','12709',
                          '42657','40969','94752','13222','63253',
                          '63590','87969','67666','58086','34848',
                          '36075','39226','44730','56510','41063',
                          '94117','30804','64806','60531','94426',
                          '71508','16314','51702','71798','28487',
                          '81455','54571','44243','44315','54615',
                          '45785','46257','96941','46163','74376',
                          '75441','41886','82709','95540','52848',
                          '52797','19178','95211','28748','36734',
                          '67816','97878','22097','79501','26420',
                          '38959','84412','77497','49242','69146',
                          '89093','48378','78091','55586','13062',
                          '41854','41641','42830','88247','28809',
                          '71415','36167','44398','29029','50416',
                          '75685','13340','74787','77089','21689',
                          '83652','85807','58901','53593','10874',
                          '39368','44852','64379','99023','56549',
                          '15080','16930','30218','50020','46246',
                          '86264','46968','90722','48540','91809',
                          '39848','33208','23851','64474','74875',
                          '69638','51270','49663','90365','91985',
                          '76141','56111','93403','58731','80726',
                          '64851','24413','78387','24849','89336',
                          '41912','72975','77426','98980','21288',
                          '60007','49782','40824','49937','66226',
                          '10021','55330','36859','37686','85658',
                          '23977','40085','26616','73070','84982',
                          '92252','20495','78219','79347','97091',
                          '13052','77624','54586','26568','71023',
                          '70036','74632','16086','36788','78453',
                          '28899','69144','94789','21156','28718',
                          '16368','76366','85078','90692','66951',
                          '95635','24390','59566','18236','13699',
                          '15100','17326','90682','91938','32250',
                          '76794','58044','47693','59207','71994',
                          '36454','24420','13272','71668','28152',
                          '89730','76048','61157','44320','67845',
                          '39303','18865','61314','85035','21331',
                          '68022','87165','47812','16023','88305',
                          '97861','26800','27575','49000','71216',
                          '37978','77575','76253','10177','98386',
                          '73564','63725','46771','16484','30881',
                          '39135','88245','46642','67086','34367',
                          '97695','49305','64170','14715','21763',
                          '37683','78777','61489','86466','61877',
                          '85041','93531','81322','25789')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2002
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '84357','47619','26433','25216','63974','52342',
                          '16415','23849','76883','82927','45331',
                          '29645','61360','18705','94523','32445',
                          '35250','85093','91606','22202','60208',
                          '77572','90394','27815','83132','11569',
                          '30919','44281','15111','54383','60950',
                          '15679','14658','22445','17731','55660',
                          '70065','69313','20468','86656','33686',
                          '65089','85904','88292','32895','86853',
                          '81679','12653','40257','78243','45319',
                          '68555','77324','89811','36479','20199',
                          '58274','50468','17852','86709','49770',
                          '76018','73649','64194','12273','20239',
                          '60688','66035','91188','87385','43726',
                          '40908','55349','42552','13281','20480',
                          '94862','59091','18417','38273','74344',
                          '18014','59400','10900','73318','58575',
                          '81695','88685','86224','13891','93794',
                          '79611','94616','23397','55035','88462',
                          '87855','14776','74323','51632','32835',
                          '89081','76860','65899','50004','78026',
                          '74292','25972','67782','60474','77302',
                          '29662','26173','29656','99455','33196',
                          '67141','71129','77273','73821','24156',
                          '44750','87714','19405','48003','15798',
                          '85883','70025','90114','99519','27338',
                          '68563','48542','67708','29772','47296',
                          '51495','13348','87307','34615','13917',
                          '54878','28216','14246','28539','30457',
                          '60863','82851','82969','53961','56470',
                          '74982','37177','18371','15053','67375',
                          '41167','35120','75981','12120','59559',
                          '78551','43647','66083','85200','84850',
                          '62330','98000','39842','43702','84918',
                          '48159','37315','55434','53335','12386',
                          '41966','75846','53159','90906','66930',
                          '65892','78175','87024','41979','16724',
                          '49729','70635','40090','53003','47885',
                          '83670','23070','79215','15860','34759',
                          '71041','40582','56112','47115','91245',
                          '24530','13108','80811','46559','98786',
                          '12901','81773','39374','70202','99447',
                          '32205','11457','53478','84266','60095',
                          '65768','25190','85427','45832','61327',
                          '90363','64960','55129','90473','69895',
                          '55904','41451','56039','21010','16416',
                          '70225','73556','99910','55741','41892',
                          '62727','56795','92083','21387','22100',
                          '46066','23665','73430','96426','47925',
                          '55195','58246','80442','61702','53683',
                          '61125','59992','61800','14189','67649',
                          '12110','10861','70414','42599','90154',
                          '72027','46757','50412','36895','43341',
                          '89400','58994','91406','60512','10279',
                          '39802','42398','14311','29358','11839',
                          '69158','32144','29123','89654','82194',
                          '66269','20242','64704','93908','39326',
                          '44674','25063','63382','67239','11507',
                          '87663','64866','69167','41232','88482',
                          '72504','71995','42188','22212','79074',
                          '68755','80159','34762','53419','18023',
                          '69465','60070','95820','73163','54788',
                          '14800','57428','54228','40105','20469',
                          '44569','70389','29122','69394','24706',
                          '83031','33454','13370','21375','31635',
                          '53137','46786','22936','32435','30396',
                          '71203','83326','32545','43554','28832',
                          '69593','40722','21714','78723','38774',
                          '17672','66957','22833','97696','15708',
                          '28468','43745','91352','85660','26299',
                          '37359','17102','69315','13605','72973',
                          '20317','81594','47289','20216','64174',
                          '73152','37340','53394','33197','53761',
                          '76621','57922','24666','29441','72306',
                          '26459','29521','11684','60568','44521',
                          '88489','31201','93453','35392','44655',
                          '67218','54573','69190','83341','65602',
                          '68120','59984','55955','90635','28963',
                          '73054','71394','68162','13740','26041',
                          '28590','42416','42517','28804')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2002
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '41881','20395','81519','87646','52901','10427',
                          '65832','47644','34525','31420','82342',
                          '13055','84309','18577','39645','57444',
                          '58557','55337','35025','63449','82357',
                          '26797','97602','76144','30614','13161',
                          '11453','27322','14382','69739','21735',
                          '39826','76417','49386','11029','74536',
                          '23864','40212','96961','55502','25997',
                          '97416','81916','87842','98355','69118',
                          '14025','55136','84086','50025','82526',
                          '18614','31412','23752','23252','32559',
                          '29127','40683','48626','67812','42770',
                          '38770','35589','90258','80353','45191',
                          '22279','98993','24450','27240','91725',
                          '76630','74054','84160','78796','64381',
                          '41869','47961','38340','79721','64427',
                          '67259','89645','72351','29252','89521',
                          '86449','88309','44629','24857','17628',
                          '34202','81332','46806','78940','51077',
                          '78694','26842','93444','50536','18023',
                          '70380','70894','38859','50634','57812',
                          '79283','39270','49220','54510','78263',
                          '83604','11139','99534','97260','94109',
                          '81466','92877','66940','43613','56689',
                          '14951','56451','81600','67321','81438',
                          '30251','54263','30644','93216','10565',
                          '81182','68791','35665','51744','72407',
                          '67623','74725','84762','22589','51709',
                          '68895','36121','12767','26937','35183',
                          '51949','58648','92103','25617','22481',
                          '37282','33799','45088','23089','21720',
                          '17552','40623','69745','54537','87232',
                          '84852','18745','44272','23902','17110',
                          '58224','44785','62330','64722','86381',
                          '49184','90047','60173','18195','33316',
                          '43436','31473','19282','80876','18914',
                          '68391','75212','62267','41759','59406',
                          '20827','79437','91248','48225','48716',
                          '26255','91250','35990','63560','50283',
                          '65380','86300','15789','77638','21156',
                          '54514','15159','13471','94430','14073',
                          '88693','35975','15034','13326','34771',
                          '66790','62435','52083','14144','17590',
                          '76839','89622','72942','38893','58101',
                          '14744','45703','85682','83263','88968',
                          '52627','47520','63332','62805','10127',
                          '20443','36170','59636','13000','49283',
                          '47108','42093','77582','47525','55620',
                          '13798','68951','80308','42000','15271',
                          '31129','15016','45092','76504','79589',
                          '35188','65587','14094','71481','75303',
                          '64010','10382','64434','66608','24269',
                          '85369','91700','60909','87453','20573',
                          '78562','44674','70329','12971','65725',
                          '76840','71325','29499','94069','42035',
                          '74285','49164','61335','25832','34628',
                          '91573','68096','80664','95318','52913',
                          '27911','68057','26713','46480','95588',
                          '52234','14746','62742','36189','37070',
                          '70746','65656','10759','37011','54311',
                          '36745','89051','78640','51858','12545',
                          '85975','40139','16589','48466','29632',
                          '68259','82777','62349','33686','11190',
                          '76669','63633','10923','97315','59403',
                          '29043','59436','69771','96994','56936',
                          '71409','70807','97801','51209','47899',
                          '38646','27968','76992','59349','11846',
                          '26584','96919','43943','46541','10398',
                          '32076','65183','58267','54587','49757',
                          '62781','55614','25392','68757','98316',
                          '60397','93326','34174','18977','43003',
                          '36609','60177','98107','16997','70234',
                          '10652','90023','82891','75780','10046',
                          '23242','40872','54851','45490','87105',
                          '48761','89551','74784','96006','16229',
                          '68036','25840','27073','55585','82788',
                          '40325','76948','10746','56381','89187',
                          '35401','46330','34750','78114','37085',
                          '86623','70970','18663','14466','69846',
                          '85548','25331','85112','81911')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2002
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '72069','52593','37688','16795','56240','75117',
                          '89918','26434','57525','72667','42560',
                          '46243','11185','41668','22732','34905',
                          '98581','80268','39482','99312','29647',
                          '40007','29221','78031','85266','43032',
                          '87976','54909','76925','91135','93756',
                          '28862','68998','42483','46701','45034',
                          '14794','16854','69575','67734','42830',
                          '28626','64382','41454','40624','92024',
                          '33800','24027','58920','97347','10579',
                          '23322','67488','11169','76253','31062',
                          '66533','47195','14945','45854','67122',
                          '88693','95739','39388','42571','44446',
                          '76711','84074','42381','90113','47172',
                          '68905','85370','43674','80873','25979',
                          '68896','31421','84095','86856','23018',
                          '84603','49184','61249','78622','94050',
                          '67883','51052','88845','32971','94744',
                          '92832','45831','42455','79767','19815',
                          '30761','96876','46057','81033','68672',
                          '64954','77253','81228','63273','52875',
                          '45361','84253','48206','51955','57497',
                          '18334','43682','82046','74137','16839',
                          '52755','99777','85098','54211','33103',
                          '87237','81672','32028','66572','28994',
                          '93861','10196','43876','33784','97028',
                          '83103','70399','64372','92976','40422',
                          '81577','40719','38479','24777','72610',
                          '86996','81599','50017','59632','83581',
                          '75791','11431','35181','93409','61879',
                          '41119','83198','65491','31289','22410',
                          '68538','14721','12582','97937','82029',
                          '93163','94697','89736','60179','64989',
                          '56004','79821','49891','98816','37863',
                          '19199','33289','98524','82600','84798',
                          '72011','56051','46336','61500','30394',
                          '78812','75169','53310','70229','16941',
                          '21018','12523','25655','46192','78434',
                          '75020','96714','70477','68003','22865',
                          '72627','36618','29320','28489','43665',
                          '75241','72203','78353','73803','88550',
                          '88848','28913','94280','40122','30356',
                          '18851','97227','37761','16162','75930',
                          '71504','43485','89580','47402','65619',
                          '97116','32932','84126','55597','92397',
                          '73422','59183','51362','82143','56009',
                          '64195','60514','33058','62630','75083',
                          '33926','84702','34539','13756','40760',
                          '93125','31969','73052','10391','11981',
                          '48372','29971','60546','91650','42465',
                          '54160','39018','29000','85354','59805',
                          '26297','14982','11676','72004','16693',
                          '15295','43480','14605','31296','75922',
                          '60868','96129','11800','47034','60529',
                          '96319','97877','72809','61930','48616',
                          '97666','95020','37697','91203','53728',
                          '69862','76014','76840','31599','82843',
                          '90548','56533','82108','70722','41268',
                          '72634','24377','75393','62060','62481',
                          '41571','96125','31360','38698','23558',
                          '20925','67522','43541','91620','41462',
                          '76580','44773','81350','18194','62098',
                          '52010','88252','55235','51475','27973',
                          '44083','36683','93184','51410','95222',
                          '90814','70023','54814','77191','73665',
                          '89022','56319','77238','98558','97104',
                          '56829','92578','38800','38824','84384',
                          '42289','37713','29202','52963','15743',
                          '41085','26939','10341','91547','95828',
                          '40181','50195','30736','90625','88480',
                          '85129','85511','80334','68737','22474',
                          '28705','77767','14329','94508','10622',
                          '22494','55644','60977','86799','49429',
                          '53006','39863','80960','76384','19268',
                          '33176','43977','83317','99206','83531',
                          '23892','40898','15065','27064','99404',
                          '31813','94478','34727','58562','43748',
                          '60955','45969','85349','15982','99846',
                          '79721','10637','39896','57180','62290',
                          '85194','43898','10325','79691')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '20923','33561','46089','33526','31822','33398',
                          '19509','49136','57600','62450','75129',
                          '83286','41510','84601','37276','89612',
                          '57276','15267','10950','38421','98582',
                          '56506','44263','22910','56560','44051',
                          '93998','41115','54528','71999','66162',
                          '11774','68458','32033','47412','43142',
                          '48742','64470','71405','15784','16055',
                          '74293','36525','35012','98910','39547',
                          '25612','72315','75842','86557','82125',
                          '42742','75105','38998','17168','28157',
                          '45423','59170','84285','63270','47225',
                          '97034','15795','91534','70754','46802',
                          '96119','96270','18044','80765','56439',
                          '92905','10053','90968','58501','16937',
                          '31802','92819','36372','73889','47753',
                          '97995','19280','42965','49847','29202',
                          '34902','98999','99801','71944','18261',
                          '87765','50551','91848','50702','31726',
                          '98123','14479','99210','42996','36942',
                          '87302','19616','41624','54939','45174',
                          '22702','78331','56682','79012','70547',
                          '81328','43025','71545','50417','81942',
                          '74327','96573','31981','48128','47674',
                          '26755','39543','83243','66167','35129',
                          '45934','24204','75945','81761','55893',
                          '45378','76076','26678','17820','23478',
                          '94360','59836','43853','36817','59233',
                          '85490','34728','31135','90347','82602',
                          '50300','61808','84622','91491','30151',
                          '28033','16861','54493','35799','80384',
                          '91613','25711','65038','41672','18869',
                          '33383','34912','54138','59296','74957',
                          '87292','21652','86533','86171','25607',
                          '81579','58006','47267','92536','83587',
                          '79421','63365','80909','23854','57959',
                          '19109','58235','64730','37173','89391',
                          '70623','37395','81941','62327','51876',
                          '35469','81272','47137','19433','59038',
                          '30478','17980','26895','76646','85927',
                          '57661','34996','67417','31167','13696',
                          '93161','82982','27599','29435','94758',
                          '47057','37941','71050','95531','63545',
                          '59703','16307','69370','21444','29427',
                          '59164','18768','32329','28976','14540',
                          '22708','45454','19115','16715','30657',
                          '84699','39585','46239','48161','57339',
                          '68889','91224','33769','28087','60569',
                          '10562','39109','47819','52407','59625',
                          '52050','41218','87980','77480','59714',
                          '13342','78261','20475','36146','50574',
                          '87904','22325','70940','80218','39126',
                          '35413','67222','26812','13581','49506',
                          '15285','12931','30908','97690','23554',
                          '53440','35997','50907','83451','27603',
                          '90717','46754','25138','98623','18843',
                          '97965','75450','97068','39177','49552',
                          '94872','47713','55839','15332','69428',
                          '62621','98827','64033','89986','91480',
                          '46713','94119','14639','24317','13080',
                          '11574','90081','30412','23104','88887',
                          '87498','76082','47706','54572','42548',
                          '96983','84610','49840','63295','45265',
                          '94098','21398','33474','74304','24495',
                          '33716','23616','35968','45641','17064',
                          '41409','63761','67278','99817','80334',
                          '27438','44368','87697','37798','73320',
                          '52519','95334','92640','52489','55916',
                          '29097','54625','85239','41305','58553',
                          '63366','80073','95732','11568','72736',
                          '27713','84522','74385','65899','12359',
                          '58150','45921','81439','96021','42917',
                          '65200','71583','29350','42773','10787',
                          '31444','28187','58798','49725','90529',
                          '83607','41701','73483','94085','85660',
                          '17011','45239','43258','13935','95857',
                          '23737','72512','92581','76966','42285',
                          '40378','17551','89642','16241','84826',
                          '71320','86890','86796','81636','56839',
                          '90817','80942','80357','58473')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '53312','83964','13385','86093','83195','73991',
                          '42295','71437','10114','32077','72052',
                          '92622','97174','80907','41414','27405',
                          '75074','96127','11609','89310','27106',
                          '66241','53256','81208','54596','49235',
                          '38766','89869','19787','68139','40031',
                          '61747','52594','45162','78750','60830',
                          '90193','34511','54072','99034','43347',
                          '99481','31982','57410','75308','10455',
                          '20842','24871','26241','98539','15895',
                          '67652','31334','15604','80218','82552',
                          '19710','68276','94997','39852','32222',
                          '39938','34227','77644','52040','30028',
                          '29111','18044','34579','80444','31554',
                          '98834','91393','88594','40824','82758',
                          '69608','91325','42351','70250','95074',
                          '22835','43256','96797','40938','91595',
                          '69699','50277','83836','45518','10992',
                          '96443','53075','61144','44629','28974',
                          '35129','16077','18935','16636','10254',
                          '99610','98748','77448','75107','53950',
                          '25014','66602','69161','80193','41187',
                          '73537','30896','27213','28252','94772',
                          '71183','59408','62508','17055','71616',
                          '35610','64066','69377','94714','27532',
                          '72853','50208','15486','62535','61181',
                          '28729','96916','92362','95162','20520',
                          '89950','67208','10293','60186','39387',
                          '59670','29322','41419','63761','39651',
                          '15809','72930','58942','69859','43760',
                          '82248','59720','73811','34573','49492',
                          '33189','80246','10759','89125','27698',
                          '17706','29817','99248','53031','65327',
                          '81327','67476','62698','65856','65197',
                          '86004','18421','44340','14507','90398',
                          '31462','14084','80458','87527','92640',
                          '74979','44215','11546','37670','11926',
                          '83867','49668','45347','59881','60925',
                          '17642','47078','18290','71687','27010',
                          '26328','47633','52292','16293','71643',
                          '73922','95700','42684','38139','92577',
                          '70491','14061','33693','81564','85013',
                          '83412','23759','68645','95755','87648',
                          '21244','87274','81002','80365','28560',
                          '18732','48102','29348','56873','56534',
                          '53369','50202','31033','72496','14479',
                          '28655','82417','31247','10062','89287',
                          '44368','14128','71439','26990','43382',
                          '36676','65827','96131','22153','17876',
                          '22203','34087','73408','84929','40443',
                          '78585','50427','98741','80872','97153',
                          '80311','65058','57950','58133','65852',
                          '48287','61475','51450','13617','83302',
                          '88530','80203','90309','80650','80686',
                          '51879','41788','48351','32771','30371',
                          '59661','74881','72654','46020','64386',
                          '86416','60358','46175','30792','25535',
                          '60544','91897','65212','83331','22247',
                          '95640','29331','28564','94168','17184',
                          '30867','50869','36277','15260','64025',
                          '70648','45293','40352','78053','75318',
                          '38531','24354','75822','23929','89688',
                          '57382','20501','59858','64657','93001',
                          '83847','22737','46844','94565','32989',
                          '69661','83708','10354','85854','92669',
                          '92373','93309','74335','47959','59323',
                          '88105','26298','69403','50934','86395',
                          '78010','14410','61762','23555','49984',
                          '19502','54131','75353','33758','59931',
                          '52610','27321','25516','43695','97919',
                          '96042','64414','86888','76891','72645',
                          '16877','89308','15287','39447','37853',
                          '47458','43263','93343','71475','38264',
                          '27195','19732','59559','22147','85671',
                          '28764','18710','19214','43966','17273',
                          '32301','83147','46797','83429','75089',
                          '81731','16401','34845','92419','76631',
                          '85164','13448','57405','43381','57453',
                          '79198','13469','89667','47119','34145',
                          '35762','50349','66098','18436')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '33154','10676','27743','45925','89820','38556',
                          '84536','51045','36322','89183','17407',
                          '29401','18007','61294','14758','28661',
                          '57668','29874','58393','71225','83017',
                          '54171','12874','42122','73282','80407',
                          '45885','12139','99791','53865','54699',
                          '69963','13335','98909','19373','53585',
                          '79172','25673','83200','37768','74571',
                          '72218','27902','57695','89012','76184',
                          '30704','16589','84544','85792','34955',
                          '46309','64767','96205','33323','33812',
                          '26047','87368','90161','81393','32888',
                          '78084','63907','10590','19161','23190',
                          '77870','19894','41039','42370','95180',
                          '83035','89105','97453','77565','28772',
                          '95119','74104','91595','32736','17011',
                          '20444','22398','32449','97651','46146',
                          '15760','92709','19260','96256','39334',
                          '13452','29688','99470','98644','95400',
                          '25021','89397','59194','38558','65635',
                          '95086','84072','40050','13174','37251',
                          '66882','14518','48938','93858','38273',
                          '93040','46352','71693','16071','54968',
                          '36420','42688','23443','18362','30817',
                          '48392','47654','58059','25894','90544',
                          '37523','62266','61305','87689','15157',
                          '94994','57070','66214','65645','29120',
                          '33757','55509','44543','36094','73791',
                          '52661','92094','37449','22167','27433',
                          '80121','82040','54562','48927','14817',
                          '57363','14887','53806','43201','39393',
                          '51649','98407','54217','97918','95438',
                          '76350','46605','87465','15018','59100',
                          '64912','66674','45353','56042','49172',
                          '94908','97178','48897','77872','46077',
                          '34336','41918','53141','92059','17648',
                          '13475','14814','20653','65374','97543',
                          '22559','34816','94128','44675','10920',
                          '72506','32159','92863','28357','33050',
                          '30857','78291','11021','63224','86755',
                          '65399','55255','55801','35375','64453',
                          '83974','83011','64010','59573','85367',
                          '53259','62770','47974','55647','82373',
                          '52795','28434','59212','77267','66155',
                          '23910','86383','37154','69258','71676',
                          '48902','81388','29816','83670','83158',
                          '16630','84172','49617','58572','49456',
                          '58837','45105','58997','79537','66734',
                          '96937','20904','25456','47067','14026',
                          '19636','70368','53564','27131','78898',
                          '30082','93652','98769','61999','83220',
                          '95795','43962','90325','14527','65701',
                          '74779','61628','53917','79873','20226',
                          '66293','19643','75667','53774','28633',
                          '91581','44117','39094','24274','43399',
                          '72753','71594','10233','11665','48627',
                          '23355','50029','92968','58335','96020',
                          '85972','83772','51154','71995','16812',
                          '91313','64935','17565','72928','36727',
                          '71606','91226','26834','37245','33021',
                          '64910','71139','88632','84409','50320',
                          '66356','99090','17499','32600','16998',
                          '53889','97691','42985','97370','38551',
                          '42141','41270','86865','52170','62081',
                          '81488','45708','29664','57673','57111',
                          '56327','31552','55295','24208','82701',
                          '77289','90230','87461','51868','17745',
                          '73759','41811','20884','69175','82585',
                          '41142','15304','23557','10342','47534',
                          '24644','47009','95540','48055','99944',
                          '49965','41459','23294','30127','53894',
                          '77497','29198','27999','75488','86236',
                          '77840','13000','76178','33904','61244',
                          '66143','14755','48968','46686','28641',
                          '71159','46742','46430','29105','90669',
                          '67383','65418','35105','58031','90086',
                          '15570','86421','61035','87482','33868',
                          '22150','89096','60371','77912','87778',
                          '27809','14126','50248','11442','26611',
                          '98436','94564','19091','94568')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '67106','38412','89421','63473','55647','47170',
                          '92652','60496','76745','81756','83428',
                          '19598','11274','17862','82794','93057',
                          '81606','96237','45601','55479','81794',
                          '13399','49310','19121','12319','41744',
                          '96497','63519','67752','37483','43291',
                          '96918','38500','89395','57090','15928',
                          '41487','27339','28386','78092','45420',
                          '90250','80092','30200','83149','97013',
                          '76358','81561','81079','91911','36323',
                          '93698','77716','10871','11142','41505',
                          '91627','59883','34087','31281','22882',
                          '77663','16127','43829','40740','41944',
                          '35746','43926','97542','16450','76786',
                          '76733','78679','76868','55101','14197',
                          '14475','34604','19452','49113','80905',
                          '14196','87874','68280','42240','79584',
                          '86777','86699','88492','56340','62345',
                          '33306','69274','25377','90403','88839',
                          '54914','88754','95657','67510','22102',
                          '78999','24036','89337','40402','87901',
                          '45721','33417','56307','50707','69829',
                          '76692','30452','53336','31708','59003',
                          '11361','76597','42040','56534','50802',
                          '31473','62844','16973','21346','65056',
                          '88381','79470','15193','35523','77422',
                          '82582','88620','10136','13704','11585',
                          '74733','60094','82952','87008','38014',
                          '73114','31176','94348','29288','39360',
                          '22595','24182','52891','52839','40865',
                          '30217','41358','51526','19690','36090',
                          '81934','88568','83844','96459','82720',
                          '51717','41100','76489','25711','88781',
                          '82089','25683','92187','11553','67111',
                          '66923','84458','89926','83890','29229',
                          '76560','25663','87977','79909','43623',
                          '87536','18366','55811','47251','32742',
                          '10928','66864','70015','77331','84933',
                          '82900','10101','95422','30209','22545',
                          '96093','10356','92330','33112','50820',
                          '25925','71481','13917','36882','33386',
                          '13236','98286','32945','47668','77045',
                          '88040','38801','28805','63784','36308',
                          '98699','31050','84757','90838','17976',
                          '86747','44460','81736','69640','15043',
                          '73370','65960','47571','36954','93468',
                          '10657','11234','83582','27660','82866',
                          '24585','40697','29742','97699','14587',
                          '79483','58865','82372','52171','15374',
                          '66445','77590','45103','32657','46184',
                          '63290','29448','79796','36837','27584',
                          '61728','53601','61935','48795','18824',
                          '38371','40356','34165','13081','54604',
                          '48234','71672','22148','52601','35437',
                          '25494','35428','33105','83959','53923',
                          '27308','18054','43758','17107','71144',
                          '97448','83054','14789','97192','19949',
                          '15337','46705','94795','14732','38598',
                          '34279','98973','11079','60516','44009',
                          '73627','89839','50399','58076','84101',
                          '41850','14909','10740','17461','81465',
                          '71204','30709','72620','11462','59527',
                          '89902','19634','10398','78133','29290',
                          '78349','72073','44191','61707','12136',
                          '91346','72897','11391','34988','35600',
                          '12302','91364','36380','31377','14179',
                          '88746','28210','74357','81435','22083',
                          '78472','44927','84442','95397','27751',
                          '63764','52444','20120','30111','48870',
                          '88027','74295','47883','65818','91163',
                          '14103','23247','34163','55995','48270',
                          '59519','57715','44289','68163','62111',
                          '34704','83849','46617','13267','15390',
                          '13497','55510','29165','27069','17890',
                          '88086','26941','78476','58129','24043',
                          '94385','43673','32357','99214','39107',
                          '29020','50054','12116','29049','48018',
                          '68618','99810','22533','21240','34997',
                          '84093','55731','23162','26827','16382',
                          '76425','92017','17307','38364')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '10999','46363','95310','13932','83245','51504',
                          '87196','18372','89851','77506','92192',
                          '58900','35853','90552','46177','90790',
                          '24730','79089','49349','47153','33804',
                          '73970','15332','53904','56841','25082',
                          '48715','16436','36947','86062','11890',
                          '54173','95934','68374','67217','19760',
                          '88824','19723','40114','34924','69421',
                          '55432','10730','69637','48591','77331',
                          '78296','25805','77836','46455','49835',
                          '66042','24346','13625','60697','86924',
                          '79665','14472','32020','76260','55924',
                          '54415','94774','40533','63398','54066',
                          '41528','26992','97182','70815','51935',
                          '76419','72150','75042','70011','33553',
                          '99754','67893','11894','60939','35019',
                          '36075','12641','29358','68728','67840',
                          '20360','24893','39845','90687','22455',
                          '66451','43376','14847','82380','57088',
                          '81870','14620','50626','46528','32660',
                          '50340','59837','24639','48899','11743',
                          '18936','24023','33462','42907','54904',
                          '79605','49458','69541','20955','95965',
                          '56705','33250','78644','80937','12280',
                          '61486','44309','60056','80642','65181',
                          '92726','37005','65112','48678','82712',
                          '97274','14643','16620','85010','55917',
                          '99975','39127','13733','59581','26029',
                          '61831','66082','81585','38433','77733',
                          '16463','57961','25552','57443','75858',
                          '41918','55314','79857','97802','48398',
                          '66556','74402','81716','59639','36620',
                          '40478','87697','56897','75335','83253',
                          '87317','72052','46818','69707','47122',
                          '76397','11340','36767','39348','82279',
                          '94140','93118','34012','25988','69725',
                          '16571','96853','25681','29609','59101',
                          '95323','84542','63642','73192','64963',
                          '19130','33358','97804','43099','87533',
                          '99386','65583','45183','15482','95485',
                          '62675','80105','28964','70431','70370',
                          '78968','26963','96268','20128','35479',
                          '90446','66412','81411','27041','68422',
                          '38513','44572','59428','82617','26552',
                          '33326','14234','79666','26167','92825',
                          '44710','81665','75122','32421','77712',
                          '76864','53696','53169','80338','35039',
                          '89953','79590','71714','70393','30582',
                          '88828','56267','81436','27790','79287',
                          '51441','81269','90594','26490','75559',
                          '40337','15886','63247','99089','90730',
                          '40796','41347','49648','25287','19779',
                          '78814','25516','71553','21055','59504',
                          '57277','66450','80114','79238','49462',
                          '85077','66307','18550','58104','66865',
                          '22431','34400','40209','25883','41904',
                          '46481','80694','81485','38008','38575',
                          '34369','68751','43801','24483','26258',
                          '70270','14413','33467','81700','80407',
                          '53668','21536','65661','96044','63786',
                          '80706','39703','48681','75232','10339',
                          '11402','49744','16665','74986','20857',
                          '78360','93963','61456','57605','77019',
                          '33418','81571','29666','21298','61019',
                          '54383','62736','70419','34920','88268',
                          '77179','16255','33563','94798','93599',
                          '63224','73263','76874','45016','90933',
                          '25807','57360','64316','27978','53279',
                          '19116','68306','54497','71855','95588',
                          '61322','51804','13570','88636','64530',
                          '88261','38226','67886','65195','78908',
                          '20091','88842','76001','61217','63882',
                          '55696','83003','11943','42468','76033',
                          '33055','44889','78858','88710','33510',
                          '71255','49890','79791','72592','44935',
                          '28829','45384','60062','20388','19423',
                          '79168','29119','72503','80582','36848',
                          '62529','13489','61014','78645','25560',
                          '69942','75231','26300','48556','79474',
                          '60318','89264','23806','42817')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1999
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '19421','35309','97749','37140','96525','24864',
                          '89299','93704','67435','68311','92595',
                          '22374','11443','74103','38543','21334',
                          '11330','12594','49784','56619','78787',
                          '89495','54705','76090','63751','59716',
                          '17946','46920','80107','12562','78144',
                          '18325','19914','96444','23052','61692',
                          '58256','47353','56029','96188','90497',
                          '45963','13890','15574','70504','40105',
                          '65633','38990','37641','90539','89837',
                          '20853','39075','59688','98043','23994',
                          '73476','83310','21114','38314','99908',
                          '20143','69134','84505','71871','98656',
                          '41163','21641','11104','35489','72962',
                          '60605','97955','78772','44679','37019',
                          '78374','70268','31221','21606','89647',
                          '95180','65569','73539','63475','80482',
                          '89474','51194','61293','68051','86670',
                          '37646','45352','48036','95465','27490',
                          '98137','69475','74102','31928','64392',
                          '19031','97333','13264','20527','58292',
                          '76834','88339','88272','30968','30489',
                          '60734','46663','86872','97986','50118',
                          '86181','29081','45062','56532','99090',
                          '81974','21172','58440','31885','62333',
                          '58747','66635','34742','92383','76026',
                          '55832','53356','23362','45794','30426',
                          '67449','11407','74653','16571','40621',
                          '59776','36509','84029','88229','10123',
                          '98689','79912','22638','92818','74435',
                          '72557','24130','80733','98975','86513',
                          '63209','58366','22894','57256','82126',
                          '63155','10596','54133','46856','11343',
                          '96197','82425','84057','89728','60750',
                          '86553','52195','27945','49027','33785',
                          '21662','97448','20866','46295','88199',
                          '73081','89464','99120','68287','79354',
                          '84613','62081','40447','74066','94740',
                          '45718','87952','10638','14260','49532',
                          '20692','82612','22196','94099','22310',
                          '67068','69938','61500','92243','98776',
                          '46701','69398','91403','30890','81502',
                          '68613','54501','19247','73094','52103',
                          '16467','59772','11141','72577','78682',
                          '14028','50302','58533','36957','51574',
                          '55303','47989','75889','21489','12783',
                          '67656','18344','36034','39671','25902',
                          '43377','30139','68915','73932','14860',
                          '23755','22470','47846','45516','63932',
                          '45012','21670','97583','15563','90058',
                          '16882','37286','39538','53282','24967',
                          '38387','87342','72866','84777','75938',
                          '82516','69660','29105','29449','17683',
                          '30232','83638','36142','34925','42048',
                          '60222','33067','43299','47315','52495',
                          '33659','67927','68238','19875','85608',
                          '47494','11754','77427','31241','90511',
                          '50479','58454','62335','23658','57184',
                          '80104','35141','26976','49211','45330',
                          '87521','24894','15735','51629','98246',
                          '59645','50809','29445','41506','12138',
                          '18674','45171','50555','92915','11502',
                          '10852','89525','99733','65495','22512',
                          '34326','52809','64056','14501','46065',
                          '72057','17357','28661','11214','21397',
                          '37653','65757','93831','48584','17447',
                          '24348','33542','91574','45546','72268',
                          '59034','26861','18205','81803','59123',
                          '44902','96921','94617','37291','38980',
                          '63699','78129','65255','57667','79749',
                          '95494','75391','53758','19038','99045',
                          '58263','89776','85358','42302','57000',
                          '82327','50633','64996','45568','99365',
                          '56473','70835','47813','92113','56684',
                          '17416','81640','54445','71615','72779',
                          '63975','51293','58083','97838','48206',
                          '71442','78516','87869','94504','30828',
                          '50569','27623','30860','84560','89175',
                          '24034','11099','71038','93452','86544',
                          '42231','62400','41184','98839')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '58288','98669','69935','23922','18782','54258',
                          '51634','84288','84615','51861','17747',
                          '63233','53634','55872','64019','21481',
                          '54695','84565','86777','25914','12368',
                          '16029','18424','82227','92193','63631',
                          '70900','43774','46489','19439','39329',
                          '67663','30594','73345','63388','83772',
                          '44754','25952','74821','97744','16549',
                          '32067','59395','86517','70617','58397',
                          '63069','31112','71217','35462','96712',
                          '85245','79625','31296','56150','34774',
                          '20579','67685','65888','53638','41465',
                          '50864','41085','29378','44130','20219',
                          '35726','29264','52990','49768','68805',
                          '98868','88891','52175','66621','95171',
                          '99964','34791','98736','14985','49635',
                          '71648','38116','70017','58477','13196',
                          '97844','49952','41832','45937','61175',
                          '60193','62424','41094','87560','18373',
                          '10462','62378','52432','24491','17229',
                          '25622','23444','73683','91988','61115',
                          '31165','64584','11818','49942','94519',
                          '19526','16932','13909','61701','64767',
                          '34906','84773','56549','67587','55456',
                          '79076','41286','56644','76957','56391',
                          '52633','14608','37637','92713','92157',
                          '44261','28748','41665','96035','27999',
                          '91965','10176','48358','31730','55165',
                          '35621','63333','43653','53875','66750',
                          '46650','94757','91951','83594','88911',
                          '23152','74410','94587','61340','72805',
                          '72584','66378','34135','14214','44471',
                          '23933','97878','48133','46507','27030',
                          '40955','71309','99722','32200','20801',
                          '68328','65468','99915','24661','84188',
                          '22850','18115','63550','82840','35283',
                          '92860','59148','40426','19548','18023',
                          '50662','29523','41057','90104','10243',
                          '13084','78376','74117','26016','12673',
                          '71933','53113','21097','79105','26488',
                          '76930','99165','94878','77305','14036',
                          '84219','74009','85985','98632','19357',
                          '14934','81821','73386','77829','31768',
                          '89674','97331','83649','27284','21782',
                          '11310','75843','89256','80466','17417',
                          '92344','61301','84530','26670','89536',
                          '97660','78518','64942','10878','53006',
                          '90280','98652','21547','52888','49040',
                          '24762','13431','63315','90893','67890',
                          '13362','61686','15241','69681','66416',
                          '55136','88681','83895','67898','33471',
                          '69562','56386','50703','24745','30745',
                          '10031','72694','16496','79270','61026',
                          '76780','90486','90663','33748','91730',
                          '11321','89877','96185','11680','12837',
                          '46127','58549','41054','49357','95950',
                          '50504','14438','35291','87988','57749',
                          '57180','68086','85277','65712','71242',
                          '38646','25287','76281','54511','11994',
                          '13980','36917','26074','82466','33256',
                          '88216','49744','31264','34449','86661',
                          '93927','89532','54747','45423','48240',
                          '90141','78829','99518','78465','84122',
                          '33076','42460','88032','70773','91459',
                          '87872','79617','37033','46454','78926',
                          '99674','48402','11728','65428','21936',
                          '98373','44167','16659','38386','59032',
                          '99655','74660','12178','98128','53465',
                          '52517','36657','96973','53091','63525',
                          '92445','99507','55236','14190','55724',
                          '72140','56263','60850','39554','85118',
                          '34069','21075','67323','78058','39034',
                          '59610','85585','24594','91871','17926',
                          '27585','84480','76419','40040','56949',
                          '26794','59662','96659','89020','50932',
                          '41748','13344','90128','69488','71558',
                          '43201','18160','86164','46631','76228',
                          '33609','51443','28978','30808','66617',
                          '69363','13021','64242','71635','59484',
                          '32715','89731','25103','64907')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '17522','51953','63415','42265','47309','85599',
                          '83793','44185','32916','23467','33800',
                          '68404','60274','61126','62223','36740',
                          '36701','58819','29940','68857','95556',
                          '94284','19539','15702','63595','63274',
                          '99073','57594','74029','30141','91952',
                          '29140','13744','49558','26915','55812',
                          '52504','48859','63597','55757','80821',
                          '84540','49019','98383','21931','71460',
                          '53542','44192','46284','20293','27991',
                          '28151','85420','55831','40868','39973',
                          '42250','15878','95403','37928','45358',
                          '73612','16951','78823','24202','23226',
                          '83837','94463','62145','82151','15487',
                          '33300','27785','75440','43822','30179',
                          '97872','71361','28562','93454','28241',
                          '77953','71579','17140','88410','65497',
                          '53454','16194','11959','20423','56914',
                          '81615','68918','85674','73814','83622',
                          '30216','86961','94612','74428','11303',
                          '36645','51252','73318','33787','24188',
                          '79086','75529','74955','20245','49341',
                          '23605','11794','44205','33380','25753',
                          '73120','77593','52078','13600','42300',
                          '40387','63746','66465','50339','41786',
                          '72351','65577','70268','64687','31056',
                          '51550','15134','10638','61960','77209',
                          '41218','51829','64183','97066','84379',
                          '47347','13709','21433','92750','86092',
                          '37913','28428','50078','94786','41439',
                          '34483','77261','54901','60732','94552',
                          '91929','18360','70961','45260','91965',
                          '17640','97866','30893','30978','17317',
                          '33114','82671','89737','78875','16745',
                          '79647','90801','71948','78448','61790',
                          '86154','69322','47117','34143','90094',
                          '98641','76983','45653','98088','31956',
                          '65936','51459','49132','83362','14671',
                          '63107','57274','46997','71705','15650',
                          '19020','36804','29106','39469','68283',
                          '38436','30671','56466','63174','52306',
                          '83994','13583','88960','13169','31351',
                          '17930','90566','39583','57268','36313',
                          '84115','77546','80700','30502','46559',
                          '88169','11173','90242','68782','55639',
                          '68752','49432','89072','28270','38006',
                          '82129','51214','71319','54200','34899',
                          '49145','15980','27024','58580','82363',
                          '63090','21813','57462','82188','12556',
                          '98855','56251','58406','92020','45737',
                          '75726','84054','75320','29211','83928',
                          '76872','94002','38425','77336','72794',
                          '17025','15485','64866','84004','24238',
                          '94039','40878','43113','75948','42752',
                          '17479','37847','82555','42646','68352',
                          '13062','52299','52350','15284','39059',
                          '87087','75137','55880','35262','81575',
                          '80422','76079','35044','36747','73885',
                          '20373','14722','74973','20275','68895',
                          '22906','65128','43088','21648','77089',
                          '42918','34908','72538','47839','98214',
                          '96691','71202','12757','89217','61368',
                          '70207','65649','66802','33775','35151',
                          '29381','31652','37488','78927','67659',
                          '46966','35799','67192','83963','64550',
                          '31191','20132','81268','81830','10041',
                          '33918','44875','80891','91181','76010',
                          '61659','30667','87041','35645','18466',
                          '23449','87861','22553','85306','48352',
                          '76174','88592','49645','23204','52845',
                          '78838','89520','57389','75280','39581',
                          '40360','61239','76317','11638','37664',
                          '15562','85925','65304','52765','96157',
                          '80449','47600','69744','74979','85462',
                          '87231','73716','61458','10655','73866',
                          '79839','16068','28089','74071','47855',
                          '93232','60057','22138','52001','39948',
                          '23885','89155','16838','84127','29627',
                          '70014','35630','70760','42606','55514',
                          '47063','78869','49284','98824')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 1999
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '21597','52707','79443','30297','28153','97692',
                          '75720','55183','34153','15131','99407',
                          '61100','50841','29081','20359','47426',
                          '18056','67398','28218','33239','28626',
                          '32880','37953','88673','89874','66959',
                          '69016','73857','31273','26826','15575',
                          '26674','43884','99365','81029','95607',
                          '64492','32414','63680','88543','38509',
                          '59509','60912','33357','14879','61708',
                          '45237','68861','21340','62459','16175',
                          '13824','34984','79455','49143','76200',
                          '69137','45831','26335','79019','69500',
                          '45084','59907','41789','54828','68135',
                          '93612','28932','18386','17697','63915',
                          '86117','53201','69834','22448','24286',
                          '55980','52624','53398','83041','47289',
                          '90297','18164','19423','51732','64870',
                          '68388','38958','72294','92448','41023',
                          '25801','87137','82699','14479','59069',
                          '64571','32732','58379','51944','90097',
                          '13901','14494','62049','94781','49213',
                          '22310','67965','32002','45726','89011',
                          '19573','38248','70277','10250','15204',
                          '73175','93079','25407','83032','90230',
                          '16357','36349','27164','81339','89852',
                          '45110','79210','41950','26219','88584',
                          '81030','83610','95147','83941','62377',
                          '71555','51325','63192','17264','30078',
                          '26627','70376','45546','19927','55069',
                          '72854','13692','44502','85788','58172',
                          '42860','17500','78176','62265','61600',
                          '70092','44439','64737','57746','33742',
                          '72622','47787','29653','20029','14983',
                          '48226','33280','46592','96919','96147',
                          '10896','96220','76604','73568','21378',
                          '79466','79847','17277','68483','27448',
                          '69632','31700','75805','54185','83001',
                          '32054','20506','11377','75589','16569',
                          '90053','25858','15883','70210','71854',
                          '16121','73532','54994','15345','56809',
                          '60734','26962','12322','25533','65803',
                          '95213','64527','13770','88897','39782',
                          '31928','97697','18438','15634','62725',
                          '13472','34205','54449','14835','46912',
                          '72009','89715','76136','38621','16996',
                          '75394','10459','43385','10534','87227',
                          '90781','43167','77517','66081','99779',
                          '37062','79090','91943','99328','89088',
                          '31300','53455','22384','80064','38938',
                          '47928','10148','85859','44210','53665',
                          '75971','42978','22185','35207','99598',
                          '94777','24390','14273','33161','37140',
                          '78305','16170','48775','24779','18712',
                          '53830','55852','64271','14021','95602',
                          '94794','50978','18664','49558','66307',
                          '45562','64383','26963','24232','81413',
                          '51494','97225','93234','31250','38360',
                          '30565','11418','12011','12214','45096',
                          '24949','34131','91227','20316','23108',
                          '84579','40264','23918','26848','95979',
                          '15405','95100','71969','93459','37210',
                          '25937','47990','64550','97650','86970',
                          '58170','27879','85378','38777','73894',
                          '79903','31097','76985','59270','69309',
                          '13400','80960','68654','33941','64311',
                          '85205','12853','25777','16841','29312',
                          '19367','53294','59391','20934','40155',
                          '36262','58474','85020','90787','58962',
                          '69604','50340','85794','69789','59794',
                          '91252','11985','73510','32857','96467',
                          '20719','48617','79264','16204','43488',
                          '37141','78134','28954','92215','11335',
                          '19690','72326','27667','76183','21881',
                          '67828','86220','99708','67994','94098',
                          '94369','42784','22169','63676','94373',
                          '36543','58072','18414','20850','32056',
                          '74879','65418','87654','56481','49792',
                          '65178','26747','25787','45773','71019',
                          '79149','94699','76500','81047','16152',
                          '25200','19435','21198','70479')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2002
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '84820','22443','96016','63551','70659','20167',
                          '25015','78278','86862','71025','19089',
                          '64088','34680','31569','69298','86314',
                          '45053','68938','47039','18157','45874',
                          '19685','16379','46703','43561','84092',
                          '65937','78283','97523','52495','14225',
                          '94870','13630','21850','13714','24914',
                          '54507','51617','58370','45372','52700',
                          '38678','18712','26026','21607','16475',
                          '23909','22964','33307','60197','70207',
                          '56369','59232','87687','94802','17273',
                          '38215','23237','35480','93989','71708',
                          '13109','77584','45399','10405','40356',
                          '47460','11434','40493','40878','36524',
                          '62611','64604','24586','26045','97819',
                          '90171','83859','90619','80267','36101',
                          '10060','54955','27619','37355','78073',
                          '73184','58228','96780','65134','87832',
                          '54192','31419','35076','54741','58268',
                          '31110','53103','64993','43812','36966',
                          '52208','27535','84146','60737','72769',
                          '45971','44110','26646','22943','37008',
                          '26122','43380','97704','57693','34308',
                          '11693','82410','39906','28619','77762',
                          '57666','95886','54457','17506','72709',
                          '79263','22733','44431','11452','96842',
                          '52680','51735','44271','75037','28837',
                          '51860','26107','66288','94088','36996',
                          '74504','22650','48166','78368','13273',
                          '15977','18942','28011','39766','18066',
                          '30803','99947','85949','89330','52842',
                          '14117','36576','15609','12002','60587',
                          '32142','77598','42289','52312','78772',
                          '66550','54813','46052','96311','37973',
                          '26698','41113','49318','30136','14352',
                          '34903','16502','89365','73441','32561',
                          '55025','27855','31886','70827','82470',
                          '88672','24471','37342','99003','33443',
                          '28054','56766','99017','89595','46001',
                          '56246','33947','99550','75892','44135',
                          '54011','29353','56669','93870','93339',
                          '11343','32841','67687','48639','10334',
                          '11576','50741','10502','76516','33600',
                          '97845','46363','15043','93529','71486',
                          '32062','19281','12630','57170','48205',
                          '61140','25270','62872','36239','71362',
                          '65645','18564','65128','77486','58374',
                          '12294','49027','25587','60914','55091',
                          '57311','81869','69573','83616','58816',
                          '73162','30480','47540','87154','87745',
                          '42845','65701','32476','17055','87197',
                          '73971','55384','71233','83449','83036',
                          '11316','99084','43345','54412','45061',
                          '35185','65677','66573','76382','20879',
                          '39029','54734','87627','38413','28995',
                          '95014','97167','94324','53727','74024',
                          '74257','48026','69094','85649','56141',
                          '60095','49770','37317','33681','48753',
                          '43690','57685','54619','78494','98645',
                          '40060','24574','58016','78084','23577',
                          '21489','48333','42429','80536','51197',
                          '38535','78765','20911','66083','86562',
                          '14944','62468','53708','40959','79455',
                          '67852','19715','31456','12849','65472',
                          '26724','53446','36328','17542','56150',
                          '54740','43024','61970','38444','27854',
                          '72386','28125','58280','60231','44341',
                          '30468','46447','35555','97909','37990',
                          '61560','29414','66916','18391','39844',
                          '78753','91331','41396','90348','50102',
                          '49903','52206','66141','43377','43041',
                          '79081','96642','97627','26726','35726',
                          '34907','84522','46204','39601','73413',
                          '11336','90984','74208','79791','32993',
                          '56165','39065','15371','88529','70918',
                          '76088','65308','12367','68027','76099',
                          '62787','94745','11979','96833','80954',
                          '39872','60488','68680','47632','69290',
                          '58298','11429','79585','44244','77698',
                          '28312','65630','56379','40714')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '77212','90667','81481','92085','29044','67464',
                          '46705','57776','68045','93745','57436',
                          '39120','38294','10840','98886','43497',
                          '20400','77485','20246','52224','78512',
                          '69574','38191','67831','72956','62500',
                          '15520','15778','95798','43244','31394',
                          '54356','33119','20178','27768','40652',
                          '15728','75892','94904','70821','68823',
                          '48950','99022','91734','36356','69534',
                          '14681','31205','26675','13900','11461',
                          '12703','47484','38102','19566','61922',
                          '43733','75334','91941','23203','89827',
                          '56356','39434','54100','59472','47272',
                          '93058','43129','39436','83043','67108',
                          '75100','83811','77749','61962','13566',
                          '64481','96849','43186','42542','21851',
                          '78365','49053','16051','86206','29699',
                          '35151','45636','83953','88037','15696',
                          '14676','31993','84917','62778','66344',
                          '58568','41495','17186','22077','57532',
                          '71333','32495','57947','61802','99709',
                          '20606','83869','84567','80412','79895',
                          '37889','79633','84396','93045','78317',
                          '36876','66322','57780','51202','92747',
                          '16446','20010','13834','96447','74145',
                          '22608','51390','96450','87710','23475',
                          '54191','93954','43264','38703','81615',
                          '30452','92896','22465','69840','42691',
                          '97383','77388','79175','71501','75102',
                          '24022','81813','68152','17766','71909',
                          '35323','94368','74798','89065','65798',
                          '29970','62167','20318','47028','39442',
                          '60329','51709','85626','37466','43385',
                          '46430','67438','65024','64119','99515',
                          '57317','83944','70461','33845','50072',
                          '64208','92285','28420','26364','10973',
                          '50807','70667','34395','84606','59552',
                          '65515','84189','29952','23502','64143',
                          '60277','98509','22776','77806','35635',
                          '16590','45003','25927','44314','24270',
                          '97804','45663','72000','10880','69694',
                          '30453','56825','11511','31086','30940',
                          '40966','11636','22692','70183','92215',
                          '10571','72360','25051','10088','84854',
                          '80986','61945','83242','67416','14179',
                          '57498','64542','78260','93564','10617',
                          '34040','94069','13617','60192','85042',
                          '55843','82822','59370','32625','69515',
                          '92116','14852','78894','67727','65344',
                          '59923','35223','21053','74677','93375',
                          '17143','37315','16819','75904','65232',
                          '53020','14945','62601','61997','47500',
                          '90869','11939','56231','67974','79069',
                          '50446','19415','84512','21821','34533',
                          '34154','38040','35008','29100','14565',
                          '54763','16457','76814','27771','15656',
                          '55629','19835','46712','23747','10703',
                          '56411','45559','46031','17812','48472',
                          '73516','90241','32522','17834','11980',
                          '39522','92750','10307','62966','21932',
                          '17724','77238','78282','30106','41230',
                          '87419','23652','10040','28965','13668',
                          '38577','66865','24631','27344','65709',
                          '26289','52588','36671','68354','76011',
                          '77278','52311','73757','31890','97322',
                          '55554','97534','94452','90692','98624',
                          '48607','72093','18794','32543','28819',
                          '90776','53672','56676','42920','24454',
                          '74406','33834','37427','18517','75020',
                          '54001','67498','39519','35652','89797',
                          '37966','96544','20681','32366','83321',
                          '70426','59828','90318','33958','20308',
                          '10465','56536','43288','86280','23526',
                          '40149','57764','94792','41636','17753',
                          '85031','31003','64024','46333','95235',
                          '87508','96348','46182','91396','65600',
                          '50488','88457','65838','62486','32415',
                          '60895','72379','52456','19300','13394',
                          '72754','91110','71980','68544','37104',
                          '46204','33319','78501','94314')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '78332','18032','20230','84741','36062','86624',
                          '95914','91178','99787','14767','19270',
                          '22782','11708','22341','41751','54731',
                          '65655','89639','35964','71661','20180',
                          '68239','91324','90149','45353','42795',
                          '91401','15788','19555','91342','53569',
                          '65673','58742','50466','86898','99511',
                          '50621','65183','17126','17527','48659',
                          '95859','43180','60508','71093','91522',
                          '65533','61983','35577','30804','39390',
                          '72489','35369','22071','73974','75667',
                          '37065','38083','72897','87036','21606',
                          '47949','43493','93092','26904','75941',
                          '51327','34195','84605','68353','37760',
                          '88081','67174','27116','93920','19184',
                          '97021','68937','64546','64912','10116',
                          '77479','93213','46766','98165','42890',
                          '78524','36022','24932','88280','18997',
                          '83067','73656','71843','76735','97110',
                          '53125','49460','82939','30740','91710',
                          '90120','80119','25190','61363','13822',
                          '20042','70286','60402','93039','18360',
                          '85525','53223','20820','47455','14881',
                          '52007','27697','45417','71838','58408',
                          '76590','87586','94998','47755','98748',
                          '29815','86900','18419','22718','89053',
                          '20505','46139','34062','95779','67812',
                          '97028','36626','68752','59803','49292',
                          '41512','78734','96687','77492','15266',
                          '53279','30574','77246','56409','95356',
                          '71230','69070','29188','54184','55797',
                          '87958','80114','64717','13638','11414',
                          '78592','56927','39081','51585','54806',
                          '47362','27302','72148','97312','46902',
                          '15164','38796','83271','21652','35953',
                          '97938','11145','45932','46060','17574',
                          '30475','40924','17579','62848','22864',
                          '97948','61600','56595','47753','82885',
                          '24180','69190','91130','29752','98812',
                          '80060','41496','83728','40110','53339',
                          '18655','28859','58490','43641','71163',
                          '39978','83961','78882','69668','70841',
                          '57320','61205','16753','36328','75125',
                          '16265','58311','83735','60128','41385',
                          '77650','24623','28746','98596','73096',
                          '43351','69500','11680','67713','87963',
                          '86677','79115','67335','98907','79453',
                          '75912','55273','61933','15081','96537',
                          '59411','59365','40458','24299','11580',
                          '59812','72994','36501','36390','26231',
                          '86078','46534','48392','75745','84682',
                          '39649','14028','38205','40790','20876',
                          '39089','53024','18879','94523','71610',
                          '84933','32004','89548','98282','33788',
                          '32541','57131','50015','21011','43930',
                          '85739','41094','82305','77984','98020',
                          '76923','91457','91588','38373','81302',
                          '18383','59016','12302','41615','89115',
                          '67747','36937','19000','37213','43730',
                          '71780','16779','98511','42135','24395',
                          '39953','14205','99164','68926','44074',
                          '27422','26947','68415','75513','53849',
                          '33882','51368','37375','42254','25246',
                          '91388','48472','76981','64251','88708',
                          '95066','99554','13149','10792','15136',
                          '24730','52818','74039','75000','62461',
                          '94190','54110','27879','78435','67260',
                          '50066','99655','36401','33951','39123',
                          '77214','62342','63974','96312','70947',
                          '23549','86093','92114','38871','57763',
                          '56194','70059','32901','96565','57594',
                          '35071','64814','20901','31272','12433',
                          '14614','41874','84852','48697','97396',
                          '88227','80523','95923','75812','11588',
                          '37430','10242','16688','30846','40463',
                          '84405','72617','26072','15411','54623',
                          '15858','34602','56193','36449','81076',
                          '56596','63509','53424','44138','78803',
                          '89722','82323','55220','16894','26357',
                          '13608','71680','43250','70487')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '16089','35135','65094','18533','98062','68513',
                          '13689','83398','18087','69503','34111',
                          '64230','10361','12925','24462','41200',
                          '21850','65974','68029','94246','49830',
                          '65575','92375','90233','18352','34744',
                          '79047','65875','87160','19845','92565',
                          '66659','51176','57368','50945','75284',
                          '10925','70720','71030','76150','20592',
                          '31617','63253','83229','51555','30777',
                          '25690','25865','19033','51521','33789',
                          '59935','54790','72071','61313','68968',
                          '93584','97410','18460','64614','32473',
                          '42458','59867','61787','17945','18855',
                          '90031','94097','97775','94043','84681',
                          '41329','86579','80573','16852','22072',
                          '51553','43099','27793','96244','32429',
                          '24175','34231','54721','19734','22332',
                          '27835','20671','65590','69295','82070',
                          '83687','37847','54632','45265','89629',
                          '18908','50822','80659','58094','95078',
                          '65402','68286','34629','80237','60264',
                          '52912','82765','91480','89538','13476',
                          '24455','15341','18386','90050','98534',
                          '73770','11289','39999','85819','67609',
                          '76700','14953','20863','42186','70961',
                          '81404','57149','41360','47122','65582',
                          '21043','55317','16064','96530','11881',
                          '48171','39234','45533','68250','11023',
                          '69450','72723','75313','85004','66406',
                          '69546','97951','82977','41662','46698',
                          '28082','47313','39824','61430','41433',
                          '86598','81518','61861','21871','41201',
                          '14939','91113','70491','38308','50167',
                          '60562','59064','25184','92467','17815',
                          '56814','81730','91954','35888','41350',
                          '83785','37632','45001','45129','38776',
                          '94277','30168','71172','12920','32466',
                          '39478','89179','49143','87745','51531',
                          '58095','24075','71738','58464','52424',
                          '92185','18688','61661','35060','66011',
                          '98692','12633','24136','18165','22213',
                          '12933','80360','21296','78690','96820',
                          '99507','14866','26683','36316','37335',
                          '13457','35178','44232','52593','90001',
                          '15042','58914','76174','66488','54844',
                          '42022','91395','14505','63870','54550',
                          '21156','66774','50348','76740','30713',
                          '82281','93255','71352','84305','80094',
                          '51074','45332','99818','33384','89100',
                          '38560','20417','83872','13381','57925',
                          '91951','58558','40550','85492','14827',
                          '21072','60100','56890','16437','85273',
                          '69809','52537','64973','10966','41510',
                          '30227','41308','72660','63299','20240',
                          '90320','81465','63402','31383','72756',
                          '74654','11485','99185','86456','53023',
                          '58102','45406','21293','70916','71883',
                          '21874','92926','91898','78163','61004',
                          '52411','10140','53030','53928','52309',
                          '82960','32359','31877','73402','69550',
                          '32589','66524','23838','60902','19052',
                          '57512','32530','26537','37785','45697',
                          '63813','20324','58070','63608','69392',
                          '26236','38433','99662','39515','62077',
                          '24300','34261','54806','63097','94795',
                          '35885','60699','84848','23914','45521',
                          '99810','56978','20195','67800','81645',
                          '43761','46846','43766','45780','12606',
                          '56577','89474','22024','59341','24305',
                          '22612','51035','77153','39106','71583',
                          '69251','49763','46584','61271','55824',
                          '75457','63393','35632','30256','53848',
                          '49238','83119','19696','76093','53658',
                          '72763','47907','93534','17687','27040',
                          '40287','49539','88322','51530','53381',
                          '34543','14283','23749','57333','99916',
                          '27653','23250','66686','58236','49171',
                          '61560','99117','49663','35668','15690',
                          '19948','13436','34269','99995','17989',
                          '70774','45147','61127','49486')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '32667','29810','29243','58870','42177','73304',
                          '40807','11590','88200','73100','48563',
                          '46643','42413','87995','33995','42058',
                          '49969','18326','69064','63192','56898',
                          '65741','73941','87057','99801','82076',
                          '89455','51144','86657','90691','54659',
                          '86972','48833','10550','51430','28010',
                          '49747','96928','10532','54299','31321',
                          '51625','76398','35388','65683','43949',
                          '24423','60199','83104','80000','76067',
                          '26212','25226','63134','71242','11325',
                          '75759','30450','48517','53512','21865',
                          '99414','71828','33901','79771','12464',
                          '28469','45593','28758','13382','74575',
                          '43087','72953','52768','83693','91892',
                          '86062','16117','15499','98617','71952',
                          '33291','65184','63115','63804','68687',
                          '37914','60236','28232','96436','61270',
                          '40157','28221','16130','15645','68213',
                          '13072','90022','71631','72208','26611',
                          '64946','81308','90899','27423','41893',
                          '83122','96367','56838','88240','31392',
                          '54121','25481','69996','56618','59536',
                          '16948','42569','23625','67179','46283',
                          '27505','85648','88831','41710','10834',
                          '64804','20879','64579','99559','44939',
                          '47419','34870','87978','60037','84247',
                          '68070','60467','71729','72458','71988',
                          '32523','12029','32837','50066','60947',
                          '21883','62329','52375','57405','58498',
                          '49321','25122','76286','53828','20860',
                          '50597','27535','37457','71268','82115',
                          '86465','93728','34460','81693','11464',
                          '88994','45630','31769','62865','51653',
                          '88295','72464','71603','12258','80946',
                          '59112','39444','33627','32067','57885',
                          '88983','95152','72698','39606','48073',
                          '19922','78330','32177','47588','47678',
                          '17498','29093','75821','19954','92524',
                          '28148','45570','88274','93248','54823',
                          '49889','51573','66031','27986','13742',
                          '98896','72172','44844','88958','59132',
                          '64323','71036','33585','65237','68798',
                          '99006','24381','14123','54087','90181',
                          '96912','56342','43244','93516','24907',
                          '23701','56501','18438','28506','15388',
                          '89405','73599','98874','96362','98407',
                          '98020','70142','42481','29270','38807',
                          '57842','89882','30359','31825','42802',
                          '95619','81115','10462','45533','57183',
                          '77367','28218','71917','10485','82460',
                          '26070','33174','42834','28117','92606',
                          '94927','77026','15591','71358','88038',
                          '23790','57563','80956','18428','29698',
                          '37793','73677','96653','22513','77501',
                          '49561','54908','86915','82699','27517',
                          '77676','73332','67927','83193','98443',
                          '77006','29016','38297','71023','26190',
                          '95474','55192','11486','63040','41312',
                          '67422','59055','36499','80469','67385',
                          '34019','96956','65733','12714','71075',
                          '88758','90894','14319','71751','31996',
                          '51028','98609','95914','99654','55164',
                          '73787','51692','60416','47439','84130',
                          '91848','94449','90913','13839','76025',
                          '88695','55815','83251','29336','89255',
                          '33338','67372','32654','27055','76265',
                          '43855','79259','48608','24697','81393',
                          '36741','98540','36300','28911','33838',
                          '93426','78872','76260','89223','65262',
                          '64117','19027','25619','85872','50369',
                          '56406','87419','92351','19911','12364',
                          '45331','86790','77016','72783','36976',
                          '17707','44115','94711','47798','32080',
                          '55381','83932','60330','47910','79328',
                          '44772','82312','94593','77897','40627',
                          '75671','98828','72929','57943','43754',
                          '48960','25884','87928','13633','39564',
                          '18819','67799','62815','91073','13641',
                          '30626','63721','18966','78483')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '18921','72112','27608','78836','23325','68378',
                          '29568','85874','67449','74778','69980',
                          '10419','98825','82254','80031','60004',
                          '80253','48186','76290','82165','89966',
                          '92948','39090','68687','38535','83191',
                          '61393','88563','38573','38791','13254',
                          '52786','20168','69548','36696','56440',
                          '75129','10207','96046','18522','29429',
                          '79004','77248','65514','60245','78798',
                          '21622','51843','89420','32982','87569',
                          '24232','84330','60508','98617','59933',
                          '11626','64819','51382','87938','22498',
                          '95121','99841','75497','28213','15138',
                          '69147','16712','24572','54007','67777',
                          '13992','83417','62389','25376','87940',
                          '61824','58971','68072','54637','60261',
                          '22890','82674','83979','55998','45576',
                          '68304','54785','59154','91814','60027',
                          '90685','70757','43268','94712','95693',
                          '19959','33479','56465','43573','51303',
                          '93310','23964','85621','19436','55726',
                          '33613','51033','79530','27281','76798',
                          '31406','68982','11168','57007','80744',
                          '10839','35231','68919','33087','42991',
                          '81985','86312','60306','57930','84962',
                          '25513','78629','60749','27187','91000',
                          '60949','22885','21046','88893','88472',
                          '97098','95082','96942','34062','85896',
                          '70710','36423','23049','86935','61090',
                          '23238','32074','54286','15780','85275',
                          '94681','17716','32944','87933','85626',
                          '93051','80259','83577','93307','65192',
                          '53775','89613','52936','58688','45941',
                          '96386','79903','38876','88845','35604',
                          '87425','52518','15156','64282','62604',
                          '66754','55469','15565','48121','71888',
                          '48467','54438','28127','52615','52166',
                          '39099','69990','99251','36481','24913',
                          '50741','55677','33157','66255','18672',
                          '90404','94156','23688','50063','81080',
                          '91237','35988','97788','52486','11904',
                          '95926','44923','28434','58005','94808',
                          '99334','21080','70563','78362','15920',
                          '70857','94230','42042','29662','20092',
                          '63198','90962','55904','86155','75276',
                          '13651','74288','82104','97498','84546',
                          '50995','85452','36710','15267','12504',
                          '21586','36418','67545','45566','88098',
                          '25892','52604','38193','14762','91452',
                          '74635','74429','25504','22427','76703',
                          '24259','39630','54889','52648','61640',
                          '65780','73020','80686','69050','22937',
                          '10386','88010','11663','73182','74020',
                          '46470','33607','97920','89393','33349',
                          '72722','84726','87710','98787','75334',
                          '14212','81194','18087','79962','56770',
                          '28406','45614','16022','42227','98706',
                          '79081','60006','19106','13547','43404',
                          '94458','62732','96462','92570','20271',
                          '27911','85336','55363','34981','27099',
                          '96100','89706','78573','70884','47315',
                          '92110','52593','96355','16648','30440',
                          '79725','28169','69630','67692','96342',
                          '24490','46636','19671','26948','95096',
                          '68258','25724','73184','91688','31193',
                          '87756','67582','53234','65761','17142',
                          '26021','17699','10684','47047','42438',
                          '83852','98491','90016','37468','27019',
                          '65516','20029','13747','20626','25563',
                          '34733','41585','44127','67562','65384',
                          '81730','74838','28539','42959','47890',
                          '90676','34740','37398','53872','80899',
                          '23951','52294','77025','81655','17383',
                          '48881','23494','56679','59712','71134',
                          '49476','33696','84030','80694','46213',
                          '87915','17008','61210','12761','31920',
                          '35478','57025','63891','34233','51078',
                          '43948','64691','81791','90728','93690',
                          '93269','91082','50186','36974','91841',
                          '80797','32173','22066','25141')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '85185','80275','79735','43046','88962','54348',
                          '93956','87225','52882','15310','15249',
                          '95292','86469','89056','49893','25499',
                          '34525','85436','81729','44506','19014',
                          '28520','40969','54406','91170','95382',
                          '17329','72263','97697','20536','66328',
                          '25557','28733','12297','52007','97405',
                          '17709','45775','74508','99820','93068',
                          '59150','92314','22317','88004','41387',
                          '14286','70170','79686','58172','14314',
                          '79925','38328','89482','74055','45024',
                          '43765','49245','92662','58446','84844',
                          '53829','88941','46125','38632','12977',
                          '74903','13090','68459','16254','12938',
                          '50920','39780','53387','69041','44091',
                          '16717','58270','57684','12689','44625',
                          '43866','63146','79759','95071','71258',
                          '34163','98414','75938','52001','85866',
                          '32549','79035','11052','85874','73570',
                          '39930','31870','15277','68179','42964',
                          '37524','62176','74613','10913','56314',
                          '74661','93903','78279','84212','10170',
                          '47857','44016','43192','65525','21453',
                          '70480','13236','92076','69885','57227',
                          '36023','90453','17769','71905','65409',
                          '27386','12531','42123','68955','33594',
                          '33032','56416','48030','50585','38111',
                          '90186','74175','12483','25984','18968',
                          '27008','86033','69263','10036','23509',
                          '23585','18719','78433','65102','78615',
                          '61449','88002','10564','37730','95125',
                          '23549','74950','82471','69915','26857',
                          '59119','68824','16889','97411','71529',
                          '53613','41062','60898','63670','85777',
                          '48211','42812','81919','94003','73096',
                          '71009','44129','80133','48940','13780',
                          '60900','19161','25037','50851','28142',
                          '44971','70991','27835','33667','20883',
                          '26781','16561','50683','36816','85719',
                          '87568','72415','14372','91555','10597',
                          '57847','43252','11283','56652','63059',
                          '97925','78507','96547','67805','30031',
                          '35176','10457','39622','82820','47750',
                          '67513','54141','77769','10967','81190',
                          '54015','31945','74169','11998','20458',
                          '76211','88553','41761','64040','25621',
                          '76216','45593','34250','78680','84185',
                          '16227','70750','92564','27649','38274',
                          '89137','59385','74408','49680','84563',
                          '83926','51697','26991','28576','68126',
                          '15762','16159','75106','15341','58871',
                          '11158','93405','90351','98279','75235',
                          '67788','46082','70487','29172','41083',
                          '71664','16873','26668','87374','39658',
                          '60109','11143','12253','44222','70150',
                          '53265','91191','45871','22015','37937',
                          '86606','66447','42834','67260','86222',
                          '21605','38442','50079','70194','81611',
                          '83695','31517','42543','69053','53997',
                          '20488','35071','36111','28291','64543',
                          '65129','44395','93933','20160','71505',
                          '37575','62159','68212','91405','24090',
                          '51343','94444','31946','41404','57525',
                          '94151','68121','10805','83438','33226',
                          '70087','40772','12738','99145','43778',
                          '71866','84107','79622','66174','98244',
                          '54514','48553','63814','93463','63097',
                          '27496','96619','97412','60495','81075',
                          '60552','89467','92253','33917','60528',
                          '44294','52983','28713','31092','82169',
                          '44326','56001','68973','39880','16433',
                          '99978','23349','67917','26701','88960',
                          '86887','66200','66053','16683','63909',
                          '29820','89202','75295','65056','48409',
                          '69256','31631','37174','77628','72452',
                          '35212','60910','49076','52752','55031',
                          '65437','78910','60955','18981','62234',
                          '89373','88074','15961','71655','65662',
                          '10288','14529','96203','52299','21085',
                          '78278','47046','41535','80533')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '94908','94619','62415','79809','42741','76687',
                          '80221','10933','22175','53812','57362',
                          '28781','41928','90500','86940','80118',
                          '59710','14715','16350','81991','65434',
                          '81720','21647','49762','23838','62020',
                          '57985','49285','79771','80986','39613',
                          '21422','26257','61648','19079','64981',
                          '91433','60201','52418','74421','83401',
                          '96405','86245','82425','39221','66978',
                          '53393','77006','13259','30311','76311',
                          '59959','89549','40878','55584','90284',
                          '39522','41601','61123','12225','18287',
                          '81893','32939','10224','82800','18298',
                          '94380','42800','25249','44104','55016',
                          '94585','43257','76984','23162','75669',
                          '47878','68765','45406','32634','21632',
                          '52891','83447','52604','41400','72626',
                          '17838','67269','48551','23412','56878',
                          '23588','97212','35552','86967','51459',
                          '11105','79554','23110','12291','75599',
                          '28057','54925','80680','69084','17090',
                          '15940','23645','23821','77416','99073',
                          '18415','77504','78345','26954','57647',
                          '96496','97126','78112','36126','65497',
                          '76704','63387','89396','60869','94339',
                          '46560','30803','48630','12874','53440',
                          '46179','92963','90432','69450','27751',
                          '92067','17279','84828','53193','40050',
                          '74404','86714','61292','67754','75325',
                          '70556','59373','26631','26788','88767',
                          '36175','98603','91955','43928','68752',
                          '80292','72504','63139','73291','53192',
                          '70241','54747','92668','54985','69963',
                          '97764','42521','59300','17580','95598',
                          '47713','40781','13547','54609','73443',
                          '23601','37255','70227','90729','61626',
                          '52692','41048','54668','49075','38600',
                          '79811','48881','60165','95731','28689',
                          '64574','53493','86143','67123','90600',
                          '64671','74956','26504','96048','74700',
                          '63955','89095','95419','94341','14531',
                          '75347','79360','63244','21485','39266',
                          '72069','79400','50953','60265','90131',
                          '14651','38488','33599','14655','70996',
                          '18958','12614','55572','74652','17518',
                          '82210','31507','38062','80617','68449',
                          '89325','83546','60721','40367','77704',
                          '15816','51611','87556','55372','40124',
                          '97673','87820','33879','40243','36751',
                          '76853','85684','19071','20279','12507',
                          '57382','59075','31980','30191','38460',
                          '67721','16194','31967','26961','80722',
                          '35310','89909','91476','45783','64531',
                          '57549','44954','23982','46064','84032',
                          '83918','63029','21292','75566','73864',
                          '38529','85810','44235','33902','88357',
                          '66677','98975','84986','83844','79337',
                          '52298','34433','12699','53929','27603',
                          '58861','80136','92933','84546','40646',
                          '66501','32647','31005','91898','94299',
                          '52245','67618','43423','93525','39556',
                          '39352','34532','50214','52511','70455',
                          '32092','97282','82592','22961','76470',
                          '96437','67121','70606','74567','25913',
                          '85542','14965','13583','89493','20745',
                          '76076','34152','57851','39868','62443',
                          '68790','81073','18621','46331','90760',
                          '64359','75028','77343','85521','51504',
                          '92738','83062','88185','15451','61731',
                          '90885','22632','80181','59199','40568',
                          '86942','51488','74471','52478','31214',
                          '27338','51920','52956','55239','40208',
                          '63750','10631','18355','66872','43290',
                          '56218','92408','49179','87730','77918',
                          '72272','83483','19820','87292','23473',
                          '62809','76447','30424','98020','40349',
                          '62931','45321','32992','85715','93509',
                          '68606','25485','21171','97733','66854',
                          '11826','96317','38526','49454','12239',
                          '23392','69397','35958','51897')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '50300','83313','51331','40930','46937','25401',
                          '60407','49709','59115','37111','55990',
                          '26409','83004','81953','33852','34874',
                          '14191','15896','73673','64598','85029',
                          '31003','66770','88971','10755','93404',
                          '71726','71149','22529','16007','79692',
                          '78905','29830','73720','55212','21892',
                          '43452','21103','58970','22857','20387',
                          '32179','55419','20378','55722','64056',
                          '55331','12478','82212','34385','32669',
                          '77207','30574','25277','41055','19518',
                          '88984','30470','90438','86555','90825',
                          '12413','43660','88729','95057','59071',
                          '16307','75079','57772','50553','36586',
                          '25595','72477','71267','31628','87662',
                          '13045','51472','99200','17196','80186',
                          '85884','41891','85196','54835','23574',
                          '41989','14376','92261','80601','11993',
                          '35404','42872','83658','71129','51296',
                          '74264','24470','12662','43519','36107',
                          '95698','54041','31440','99668','53209',
                          '61559','87513','24127','86356','21049',
                          '77345','21677','56458','41697','44215',
                          '60075','76954','10442','82751','98436',
                          '13951','63867','45936','85851','82590',
                          '38435','57756','36506','25933','75223',
                          '63804','19106','18834','89095','72485',
                          '79127','89391','94879','99915','93932',
                          '75204','75281','50387','13515','41534',
                          '46165','28561','96583','35929','95088',
                          '36932','42570','84981','55976','81808',
                          '74937','36259','53722','40458','16924',
                          '57900','70716','57889','21607','63484',
                          '32580','47003','48953','65719','54047',
                          '39713','19398','41195','83701','65369',
                          '59624','16461','46162','99505','11076',
                          '58242','78098','49687','17498','34025',
                          '59642','74747','42060','76587','93091',
                          '98196','29114','11761','87141','44655',
                          '14095','77481','79348','12232','70205',
                          '53366','60298','53681','59882','78296',
                          '56702','55696','56753','90360','46244',
                          '42277','14018','32152','26406','77733',
                          '66749','33307','53711','52678','63960',
                          '33617','92686','89942','63901','52574',
                          '99810','38355','50976','75341','16628',
                          '54152','86257','80265','32678','35400',
                          '52262','59636','32199','77946','54329',
                          '48615','89730','87306','63303','21775',
                          '24358','97957','23406','87432','27843',
                          '47980','57448','40592','41263','13665',
                          '31419','11290','84154','38106','96504',
                          '74702','60138','60258','16114','87072',
                          '15321','65496','48132','90998','68256',
                          '53744','30318','39069','14093','78413',
                          '50028','29897','21656','70010','69375',
                          '99704','31470','71776','36007','46935',
                          '97747','68227','72731','83081','67657',
                          '97923','13014','85950','29846','10148',
                          '42582','31074','86921','88142','41661',
                          '92415','89146','89060','26012','48434',
                          '60159','35079','44525','23042','52663',
                          '58882','98671','90043','34125','88340',
                          '70906','14092','93613','67410','77521',
                          '49330','37731','47910','61864','63897',
                          '81785','56164','43280','39929','55937',
                          '98534','86509','18423','24796','12074',
                          '39265','81104','67583','68778','58448',
                          '89842','19683','84233','88291','98390',
                          '35977','62335','30692','90802','48965',
                          '85094','21187','12647','90297','36387',
                          '83597','89253','21238','70520','54445',
                          '39633','16180','86073','30263','20740',
                          '63821','29614','39777','66628','76765',
                          '34344','57170','19008','63388','19829',
                          '44966','21812','82437','57905','21067',
                          '71249','79218','63346','89534','43302',
                          '21257','28358','40287','48585','50500',
                          '98017','41643','28696','60576','41292',
                          '54882','84885','93147','35168')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '98949','56907','31419','42815','56739','43338',
                          '95302','47753','11357','40908','13191',
                          '99213','31010','99563','92687','65966',
                          '79216','55622','17818','75096','83147',
                          '14545','73752','52614','42776','63602',
                          '83899','78215','79581','43357','11221',
                          '16297','37652','71148','61856','19724',
                          '50082','72389','54728','93271','46055',
                          '32620','96504','49229','32187','91931',
                          '61122','16099','25729','84062','36526',
                          '78618','54328','28978','25495','19444',
                          '75810','98335','19998','55109','85914',
                          '27302','11519','93450','21602','46397',
                          '81937','30575','21307','81435','42551',
                          '98112','26590','44765','72878','75757',
                          '67461','38132','31202','16017','71353',
                          '97910','14840','16229','54940','15687',
                          '80723','66447','67469','79563','33171',
                          '73310','64109','46816','78412','10102',
                          '32342','66220','29638','86001','74222',
                          '38032','95745','69561','74606','31873',
                          '51210','25518','13438','10050','19639',
                          '38960','37029','16696','79442','38319',
                          '14819','43041','93540','98618','42544',
                          '73040','14548','82478','43447','46962',
                          '27254','99444','48825','88886','88113',
                          '68755','18666','93182','49568','36914',
                          '29045','69871','75527','89905','17191',
                          '26751','31255','59570','51692','47722',
                          '90335','64918','80605','44898','58404',
                          '36401','51849','88921','42747','93372',
                          '75524','47264','66041','37919','10223',
                          '54388','15670','44740','26978','68132',
                          '53564','14778','47454','57325','76840',
                          '63153','25126','46673','10919','81877',
                          '66092','51161','36570','26379','74197',
                          '91566','15202','14725','52088','66853',
                          '13824','54901','14051','53950','41835',
                          '89260','85628','50988','71864','47659',
                          '16492','70305','31517','21003','84285',
                          '65977','74086','69151','61987','72284',
                          '56086','61914','98175','46987','41096',
                          '90199','75466','64299','61757','15535',
                          '40829','41050','95361','84923','50862',
                          '40259','55883','40577','62618','43354',
                          '85302','43641','93876','41739','99399',
                          '21657','93314','93309','89370','30016',
                          '33034','49074','97273','81142','80036',
                          '94627','75584','26258','77785','37482',
                          '45192','19402','65240','71275','80454',
                          '51125','91757','75512','62775','83416',
                          '94074','65317','66303','29615','37830',
                          '85297','86528','59611','21175','91305',
                          '78735','51205','57418','98537','21324',
                          '61961','44896','89939','83691','92456',
                          '33151','24741','17860','57890','36100',
                          '17778','34337','92000','29979','49663',
                          '31138','39378','99642','20304','81346',
                          '46287','59368','35514','79310','35316',
                          '10355','50583','58478','91049','67949',
                          '83779','13746','26698','95966','99546',
                          '10122','96805','22731','90603','17239',
                          '29328','44097','75910','13209','57320',
                          '18240','58840','50542','33376','46637',
                          '61413','11870','70903','42441','88106',
                          '13422','69158','93306','28566','64420',
                          '26289','28909','38291','49086','25377',
                          '78793','87355','36753','15067','40018',
                          '41176','18932','44913','22376','54961',
                          '23645','42017','36201','81942','58177',
                          '63558','54798','90692','46416','31395',
                          '61583','70403','80245','94171','38979',
                          '89666','90428','47716','26290','93639',
                          '41805','77002','34802','69270','90192',
                          '60228','48483','21697','47541','21763',
                          '11412','34637','47248','28716','33409',
                          '52667','30013','97396','48335','98665',
                          '52201','92389','19989','75400','92745',
                          '48008','19262','31214','33121','47458',
                          '75735','80385','96482','90753')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '98651','44332','11317','26892','40420','71956',
                          '64507','92671','92597','50363','97126',
                          '24969','70456','40591','81241','90725',
                          '50223','66858','41646','62909','88541',
                          '50535','12065','70537','82938','31686',
                          '89331','28286','26419','35736','12139',
                          '74731','55142','12009','85336','85750',
                          '96035','51185','83529','86995','86276',
                          '98593','64176','97372','18020','77972',
                          '80560','47074','61714','56607','49630',
                          '81131','45474','88549','27345','81867',
                          '82811','42261','18539','60137','23836',
                          '52572','18300','71596','12827','19566',
                          '68462','41507','58011','50305','36668',
                          '60326','31585','16045','47380','76396',
                          '35084','69137','93161','46399','66460',
                          '56467','22394','14677','56882','21388',
                          '17328','82905','24426','32354','98435',
                          '31416','34524','92762','75147','91751',
                          '21405','10091','30957','17269','58402',
                          '73913','67248','66220','32821','49793',
                          '92737','37488','33202','36378','17347',
                          '99760','71760','37654','87407','24182',
                          '81710','28834','13517','75986','66365',
                          '18422','41116','21043','32725','56076',
                          '29723','12920','98138','42714','54786',
                          '13911','27955','80575','13209','63679',
                          '55147','95100','11774','96982','61955',
                          '87671','53340','62693','18879','26532',
                          '32783','92785','21457','49073','63878',
                          '52994','62595','30915','24168','26874',
                          '13441','57062','97519','58888','15839',
                          '74428','68922','55996','58309','72337',
                          '56232','94261','79433','20657','46739',
                          '39118','46094','48778','59436','48164',
                          '98144','21270','62288','31896','72822',
                          '35569','25833','68015','30849','41485',
                          '13351','76105','81821','10523','41077',
                          '85337','16446','86545','65854','12805',
                          '43950','42962','95717','45139','32384',
                          '73448','18833','89570','29574','19002',
                          '16908','60332','79083','32656','90267',
                          '99480','22841','79194','73451','32075',
                          '81519','79822','95558','28289','44811',
                          '88025','88668','93609','27701','65207',
                          '10635','72168','76675','59678','69894',
                          '91056','97671','46090','42903','35177',
                          '93313','25823','12234','83512','44474',
                          '66483','20186','52747','58878','77833',
                          '73397','37669','25278','84794','32643',
                          '50457','78465','83551','72521','18041',
                          '91966','23652','65269','23236','66258',
                          '65307','68437','33556','67440','35229',
                          '74619','86855','13594','49511','65560',
                          '55540','20285','56332','15424','94476',
                          '34549','50925','24188','56765','15401',
                          '49538','55431','97558','25303','18799',
                          '93569','67633','97296','11368','42428',
                          '79028','68161','30180','87054','61163',
                          '21014','33850','85762','83248','23945',
                          '77107','83468','22538','99097','39677',
                          '13119','38616','61465','57804','23175',
                          '38362','34618','14575','29475','86787',
                          '21512','25687','29109','64788','88645',
                          '37480','33523','59358','95340','11921',
                          '79361','86827','26663','87519','69197',
                          '85070','43677','44226','48119','78329',
                          '85746','29229','23568','19371','68434',
                          '42110','47853','30321','67718','61298',
                          '93662','70124','36558','78176','93476',
                          '88802','71908','94795','81712','70641',
                          '19627','35220','21093','78048','20386',
                          '80353','82754','89356','36468','25876',
                          '55456','76669','19436','18455','87856',
                          '50339','94815','98778','79168','33662',
                          '71393','80100','69985','28822','19369',
                          '66035','19447','95188','72235','86311',
                          '74041','79252','27810','54511','96576',
                          '77022','34658','36548','14518','23100',
                          '93433','69499','17152','20044')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '11975','43578','19664','91453','16921','66307',
                          '50374','60607','32451','38816','77228',
                          '25176','99806','21079','83310','33753',
                          '90280','64086','72286','41675','77348',
                          '74493','22831','85314','77904','87430',
                          '77956','48106','18101','41429','71149',
                          '77805','29637','85533','85547','77144',
                          '20687','77284','42301','43655','27361',
                          '63486','62866','69054','51383','56104',
                          '46393','15861','24183','67618','29089',
                          '82168','76015','95593','97257','70641',
                          '58760','95572','57261','21750','71330',
                          '39381','46192','64788','77698','49265',
                          '28676','62343','95807','39160','42310',
                          '14436','92802','46405','21150','87847',
                          '69088','21873','95401','71179','79687',
                          '74158','84876','25178','11914','58955',
                          '10823','53598','33130','23927','92279',
                          '99809','11955','82695','67352','77995',
                          '20155','18824','59168','23054','32872',
                          '46613','91592','64388','28302','79441',
                          '59449','74948','35945','47139','42871',
                          '22542','27372','85192','56271','11206',
                          '30018','38085','94969','71094','97168',
                          '51486','15733','58091','63268','10907',
                          '50469','99333','58138','34650','67472',
                          '27675','10484','63676','12213','61103',
                          '12922','97110','75929','62183','92145',
                          '93517','72001','17983','97860','63818',
                          '11041','73286','93151','37937','90256',
                          '79111','45123','87462','88223','29698',
                          '79341','57405','84169','52862','36858',
                          '99871','28168','19473','28796','30544',
                          '65163','81734','84790','28404','27241',
                          '94359','67947','55833','36524','10793',
                          '13382','26513','21818','38866','35076',
                          '14989','37228','30712','29244','68868',
                          '46344','99020','30901','76135','10169',
                          '70705','81530','98096','46697','23090',
                          '39966','58615','49075','76035','39065',
                          '46028','42710','50265','16153','98836',
                          '81380','53031','97080','94593','38842',
                          '80411','98399','95563','71100','90228',
                          '79920','53140','92610','16850','10089',
                          '69135','90591','20984','29997','37056',
                          '32423','37250','61970','21201','60668',
                          '21423','52012','93507','58931','72106',
                          '41525','61026','15326','43433','95345',
                          '94975','48091','22576','85972','96601',
                          '90309','39624','13961','31523','86344',
                          '45575','72297','23686','57414','38739',
                          '66496','26509','23581','38672','76468',
                          '43090','76481','39416','73636','68385',
                          '46527','84534','20283','16884','24117',
                          '42584','12015','24837','13699','20745',
                          '26842','84717','64938','38377','41380',
                          '15206','38772','85847','77056','36366',
                          '43592','67944','82991','77352','43368',
                          '61206','59476','82585','64465','36832',
                          '15933','78144','49529','10477','37919',
                          '32715','48611','39232','49598','60539',
                          '65003','25240','18974','37310','31171',
                          '95486','68116','17521','43605','75273',
                          '27326','52986','18378','73196','14649',
                          '85098','68429','86694','80865','34342',
                          '80408','34730','33622','25873','38942',
                          '24419','38331','40855','75172','24489',
                          '72813','37177','78546','30299','97921',
                          '31702','83743','76328','62262','94949',
                          '32103','22871','13226','37329','59252',
                          '13086','66481','72395','90362','26650',
                          '76797','39148','96800','41534','67050',
                          '35765','69824','27887','28150','12996',
                          '64590','85040','91470','35216','83460',
                          '63183','14355','98541','89452','32550',
                          '25601','58643','37666','78632','42044',
                          '20979','76919','58069','21886','77690',
                          '30175','98765','81864','71158','90426',
                          '80692','82751','17912','68048','86572',
                          '24536','81605','44817','17104')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 1999
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '11008','84978','21421','81627','91111','33564',
                          '28727','95520','69744','13357','43568',
                          '48876','86021','50020','71586','77746',
                          '33050','84579','57854','16061','87254',
                          '62358','12664','35965','61195','46404',
                          '62772','72393','21822','15248','23479',
                          '89365','48120','65928','44652','22517',
                          '83270','29098','72236','38791','88628',
                          '61805','72557','68584','94330','63448',
                          '57704','90495','57360','78925','91863',
                          '37552','86279','58363','56740','16346',
                          '28305','52091','93692','97731','15961',
                          '42493','86163','74400','88782','86887',
                          '30693','43989','35435','35101','88892',
                          '66710','51399','68421','86643','27113',
                          '33721','55534','93522','22706','82697',
                          '86858','68677','51348','88515','45874',
                          '47358','51384','43135','46131','39277',
                          '29093','40005','18928','84603','71918',
                          '95925','90894','64827','25169','42323',
                          '89511','82760','32811','93256','18347',
                          '69163','21518','52982','71092','76842',
                          '95459','34887','17830','97431','18961',
                          '48928','66109','31917','68776','93941',
                          '77983','37769','94911','25975','27126',
                          '31487','77592','42292','81667','48168',
                          '15151','86432','13096','67468','56391',
                          '98735','84043','24247','45952','90317',
                          '81964','21026','49855','93433','84392',
                          '65730','46985','66466','41203','84347',
                          '99293','99446','97386','23889','34016',
                          '51606','45064','72412','89498','76411',
                          '45950','54905','13289','16023','42733',
                          '80130','12993','76532','95589','38002',
                          '34933','70442','25386','90164','11658',
                          '49748','70757','95625','25686','87908',
                          '24453','94124','43602','98638','90341',
                          '72683','38486','77428','96780','26514',
                          '95301','81268','30947','54341','47069',
                          '54212','50131','53943','47153','70131',
                          '26674','43004','80338','12791','77211',
                          '11459','58860','54051','52434','67043',
                          '20952','63388','12253','64579','41528',
                          '14256','47004','83189','45124','56087',
                          '70669','34383','92652','10739','69106',
                          '23817','69018','76932','54790','97440',
                          '99643','83406','77005','18759','48367',
                          '98325','90513','31345','82356','64413',
                          '34507','22635','39554','45404','97033',
                          '63196','11671','27920','94504','24359',
                          '62350','93384','45805','12097','29785',
                          '17737','20068','37752','73980','84612',
                          '36794','26852','15505','81837','33450',
                          '23459','95221','33467','14467','89439',
                          '42606','17766','24877','23496','37821',
                          '56563','92648','90247','66184','13099',
                          '68549','69774','82657','59226','95038',
                          '37784','84638','88133','76954','68845',
                          '63148','98772','40654','64620','60257',
                          '82649','13491','84720','33226','10093',
                          '43972','64237','96360','22200','91573',
                          '32342','47466','76005','26169','51962',
                          '63768','24066','35338','61913','94864',
                          '94896','10111','63392','45973','85643',
                          '33504','60923','10724','67012','65782',
                          '40774','17097','85495','65305','26844',
                          '62594','11948','67075','97929','92813',
                          '59059','66381','33347','46389','21000',
                          '38315','19095','50966','38183','58013',
                          '60219','44526','47156','22767','19764',
                          '73688','54947','26883','53734','73103',
                          '22213','32907','33835','60689','34872',
                          '45790','20769','59346','63020','85923',
                          '11701','66205','79946','54298','38702',
                          '54570','56895','51428','86853','79248',
                          '29754','50515','34724','15575','29316',
                          '84863','36483','60739','86918','62237',
                          '89681','17129','34447','20366','73112',
                          '23154','44860','85095','40920','85407',
                          '86645','54897','27349','10152')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '83737','36029','40235','95856','72200','26082',
                          '25932','99443','85259','92313','22556',
                          '48187','89213','66538','17085','43961',
                          '41690','35139','24026','71573','95108',
                          '87071','68534','10032','76312','51084',
                          '19109','94028','98012','29146','94628',
                          '73335','64619','78720','96098','12388',
                          '85923','98986','22711','73555','77203',
                          '46287','16113','90199','16493','26028',
                          '31849','36165','40841','63427','60173',
                          '18569','22108','18873','92168','52614',
                          '46244','54552','43170','30132','98822',
                          '28607','94007','20604','35990','35201',
                          '70844','62390','16962','69114','77829',
                          '51656','56585','53153','19346','64925',
                          '37538','51072','37485','96370','34086',
                          '82573','98536','34215','36445','22212',
                          '91842','58567','45897','21470','76343',
                          '83491','23322','14981','30326','60335',
                          '83031','35672','70551','76363','17875',
                          '41756','69858','85014','34752','83388',
                          '65548','34922','87877','43669','23072',
                          '71886','77868','92884','47719','84929',
                          '72528','48181','52987','75584','44094',
                          '14849','49910','32063','47150','87708',
                          '71183','84051','54640','45031','23988',
                          '78006','49356','57390','93816','47758',
                          '55602','92057','79711','28803','11696',
                          '83202','76598','47585','27189','71352',
                          '33549','47945','36757','58480','66467',
                          '70718','31715','83379','77625','90569',
                          '97111','75113','34879','51651','49058',
                          '82624','74570','20119','71845','41272',
                          '12652','18536','37072','94005','33019',
                          '29543','72635','34997','42319','79276',
                          '13402','99053','93599','71540','21598',
                          '24302','98783','98409','47139','54466',
                          '53926','56639','99848','33281','11608',
                          '76771','24100','25090','16096','59429',
                          '76742','33680','37290','64258','33357',
                          '33722','41947','96225','20060','34278',
                          '72343','66429','91975','49070','45396',
                          '14693','53345','13858','43348','68091',
                          '98931','66037','39687','71765','82486',
                          '11768','35022','36494','13579','42560',
                          '10319','84874','42052','42185','17463',
                          '97810','69034','96681','12357','87420',
                          '53745','80828','80469','18904','17732',
                          '32910','42469','25060','93496','27792',
                          '85971','54548','41922','61192','62037',
                          '33011','43198','25510','91981','51818',
                          '38299','33461','99267','62429','87804',
                          '53117','14498','88476','43571','71099',
                          '26204','95927','36083','75177','27667',
                          '23424','48492','92307','17760','62772',
                          '39754','66629','77087','86928','27023',
                          '60807','34797','89886','57179','12515',
                          '76021','65819','23135','17247','50480',
                          '43131','41126','61806','63836','95843',
                          '66209','48599','46609','99817','50370',
                          '49755','63600','33928','63094','78911',
                          '36923','56245','77651','14082','72285',
                          '80934','75331','43960','46230','34707',
                          '23579','58498','28819','83140','80744',
                          '89182','80149','26709','46124','84413',
                          '44898','91140','10077','76104','55364',
                          '55048','30055','62818','66920','34894',
                          '24087','71148','95254','57544','92515',
                          '69367','55986','61536','69327','28389',
                          '11119','46535','23380','83747','28682',
                          '50816','71805','89977','87226','88714',
                          '36434','63498','26752','75702','86903',
                          '37211','85393','92517','33856','46057',
                          '27444','45501','88466','14559','10999',
                          '18062','81208','62496','36517','78293',
                          '78209','39903','21447','26333','32353',
                          '81981','29019','45255','66932','82946',
                          '56498','59464','19746','84138','88210',
                          '16498','85244','49870','70824','66687',
                          '53662','10087','13517','93680')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '55498','76974','56475','35011','61028','46257',
                          '60371','42967','28508','83698','26925',
                          '24475','69756','99493','40250','56666',
                          '77513','29251','88156','77092','14858',
                          '37891','14546','42117','75480','28804',
                          '74897','87113','50936','87485','93478',
                          '26339','22044','51775','34259','17960',
                          '90563','22126','74198','46208','91267',
                          '56554','40477','94028','64290','62799',
                          '94534','29960','74838','20321','43082',
                          '74048','37328','38665','85883','95479',
                          '15167','88417','18879','63766','78878',
                          '60756','80040','49072','18068','68568',
                          '90236','36802','51233','84006','98329',
                          '72125','18373','38635','24138','49881',
                          '52270','11275','41568','79399','87732',
                          '59708','96633','66449','28375','55054',
                          '35883','64226','12994','69958','32742',
                          '33615','34326','74230','78859','99974',
                          '90435','33993','14799','96641','70442',
                          '88012','81694','51737','96194','13760',
                          '65555','47443','60023','69819','69966',
                          '94375','99666','14756','20282','15588',
                          '47628','70656','97131','80172','18073',
                          '73511','35876','55092','44267','37887',
                          '20343','70029','61553','97468','80773',
                          '60424','42914','55117','15687','71224',
                          '71769','88255','77388','27700','20595',
                          '63419','33386','69596','76418','62363',
                          '90239','60892','65122','15120','20635',
                          '21978','47714','55877','24958','76758',
                          '29335','94379','23063','36972','45443',
                          '34380','68733','69187','84480','11059',
                          '43207','39533','46110','64478','20845',
                          '86311','92906','57244','61467','34690',
                          '38211','68089','95228','27290','55194',
                          '73529','15901','99834','14024','23160',
                          '99939','84375','92053','83908','21447',
                          '80214','10696','33004','38993','72698',
                          '17667','57934','60260','99427','57158',
                          '77185','41379','23555','43344','70881',
                          '48168','96588','89939','50404','43190',
                          '81978','95186','89897','58417','50651',
                          '44031','14050','87011','49179','85632',
                          '56348','76565','91078','72389','48248',
                          '23291','10332','73344','28336','46717',
                          '42834','97377','23064','61910','82642',
                          '88520','45961','74405','69028','79930',
                          '35905','68853','74225','82542','21535',
                          '36268','81891','40733','65870','94110',
                          '22052','21158','55599','88113','51310',
                          '34224','43016','34073','44695','81319',
                          '80850','17754','11414','11816','73666',
                          '20084','22354','28143','72295','56727',
                          '61524','40286','79155','16512','70483',
                          '10736','35649','46515','27610','77021',
                          '47640','39628','67330','94506','18891',
                          '19808','64886','50020','92376','71870',
                          '86209','49808','12110','71689','74194',
                          '89396','38059','11075','99370','93436',
                          '59203','11394','62434','62123','69043',
                          '25044','88653','25150','61149','49445',
                          '68968','46501','63204','20841','87632',
                          '98779','59532','81818','30741','14994',
                          '72561','99278','17259','75030','56491',
                          '57698','18577','71369','22259','77636',
                          '75898','12156','51039','71777','54275',
                          '14903','52950','11222','58954','56292',
                          '25136','75015','43290','29217','27010',
                          '63533','27281','43755','12183','41730',
                          '12000','38855','10636','55879','10457',
                          '97558','48183','97921','99693','49925',
                          '29694','87711','60280','37023','35541',
                          '84589','52651','52592','11107','44070',
                          '27272','93533','74757','24959','93325',
                          '68928','52960','75583','22351','80871',
                          '83170','38357','82962','34708','41253',
                          '15035','43596','46095','80617','53778',
                          '82195','90829','98818','17746','11485',
                          '37699','33543','30692','46394')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '25217','40172','17782','92382','53467','97173',
                          '23830','72152','80233','71954','81510',
                          '60932','27857','41288','36948','14508',
                          '75544','84633','82422','56020','17210',
                          '18471','56061','44687','88309','68960',
                          '87582','28254','86984','99198','57609',
                          '48757','23822','87032','84651','19161',
                          '41024','56778','97459','72133','86376',
                          '66287','38280','11132','10841','76677',
                          '62520','93694','47594','57912','17966',
                          '53868','57829','17390','61615','50306',
                          '30403','52013','70029','90692','77687',
                          '78725','87384','33097','27562','30900',
                          '95205','56371','54501','39531','49726',
                          '14533','23042','10364','26638','91323',
                          '96337','11802','97109','46666','76327',
                          '51772','61996','46224','13961','14580',
                          '77756','30990','45258','51126','59244',
                          '53673','39395','99290','67940','37685',
                          '26291','68169','95774','21503','68452',
                          '37342','31116','91506','85161','52639',
                          '94919','71332','95145','92752','13050',
                          '39244','68420','98649','67040','87480',
                          '52780','71944','50687','45924','39061',
                          '15303','22096','10929','81072','79547',
                          '21898','97914','47674','50896','52162',
                          '75827','40910','98443','73610','40805',
                          '86706','42811','61630','98819','84479',
                          '43017','83730','99094','71186','30460',
                          '12030','94635','13836','26876','15284',
                          '32274','58339','45741','99326','33241',
                          '77208','94927','78691','45350','43336',
                          '43921','28972','86262','65972','70019',
                          '41573','37527','21426','35940','10905',
                          '15965','36104','19539','54227','43323',
                          '73909','42880','55272','11136','87311',
                          '14856','81293','26325','42863','13924',
                          '87988','61664','59274','13734','31965',
                          '61583','71885','82433','66438','93746',
                          '83459','74616','11709','25614','94937',
                          '28448','73905','91570','16440','70723',
                          '72795','63050','19673','64900','45660',
                          '49495','78089','53069','89631','72388',
                          '29797','56282','24188','89818','78948',
                          '51656','49802','65944','47817','24168',
                          '55405','17488','90964','58504','43773',
                          '57264','61513','78234','83759','69186',
                          '63558','67351','23200','28646','29678',
                          '57740','41544','43758','53499','51721',
                          '89072','71631','63003','28139','32190',
                          '73294','36398','81396','10979','10555',
                          '53759','55510','54743','41487','51996',
                          '20805','29223','25815','75527','96067',
                          '91129','75552','92501','54688','69357',
                          '94957','80868','54207','95338','52657',
                          '16512','42299','34612','67731','33125',
                          '30407','39743','16381','79154','76013',
                          '41018','44435','35462','84897','41985',
                          '62343','73531','24394','98092','56406',
                          '19495','94438','59347','49218','38693',
                          '26433','18284','94887','55044','77419',
                          '59948','47880','24937','61736','15724',
                          '64043','75155','29814','36065','29667',
                          '78914','82288','86551','17686','41650',
                          '83200','71915','89790','29988','30275',
                          '68676','56492','28554','18609','62115',
                          '40849','95799','56774','26113','48712',
                          '26662','16452','56610','67135','93931',
                          '15198','43553','14870','72049','48655',
                          '21694','59089','71515','11586','33989',
                          '49033','10768','48002','37154','61707',
                          '23964','86325','21275','22578','99675',
                          '97600','29389','11532','62983','12005',
                          '77028','50893','39246','71175','50324',
                          '75233','41751','16526','23286','46459',
                          '40227','32041','16693','36367','42124',
                          '29670','78716','88446','63790','89160',
                          '75235','33180','63010','77151','58690',
                          '39088','58358','96498','31089','39144',
                          '12608','92966','66986','31386')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1999
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '76721','51325','59947','53704','27151','58526',
                          '74415','35049','10419','35893','35889',
                          '80170','40835','28375','79710','82130',
                          '85075','15969','84734','69930','61466',
                          '24264','68693','77529','19146','46034',
                          '44407','65951','96727','94084','31990',
                          '66769','61077','24523','36173','67180',
                          '77817','94823','40920','44168','89944',
                          '15272','99557','52776','43108','37498',
                          '53051','94095','19756','46503','67556',
                          '88130','50006','28657','20766','41752',
                          '26008','38421','15951','21022','50747',
                          '50388','24251','98811','40386','26624',
                          '15285','65245','99882','56460','13986',
                          '79244','34369','15357','71241','68990',
                          '54945','53166','10450','99785','75731',
                          '79384','12718','35041','52320','77481',
                          '76114','68109','65629','57901','64516',
                          '20515','60654','90928','70329','76720',
                          '11769','44324','54557','49633','87369',
                          '69137','93477','38934','39703','56261',
                          '83905','11046','19113','26430','46616',
                          '42311','46294','27765','56207','98163',
                          '64331','52845','56900','21158','90440',
                          '54433','45973','44861','40387','42614',
                          '70726','94224','43687','90400','31518',
                          '50610','37917','14966','19496','49590',
                          '53517','18690','93634','60839','68048',
                          '32192','83677','99086','26814','69666',
                          '88207','99311','64251','26136','25644',
                          '47188','14582','94527','69932','39187',
                          '89916','36261','34720','10496','52929',
                          '55813','35710','79725','94062','54734',
                          '27326','67425','41715','36867','61914',
                          '48683','90961','12874','10541','44637',
                          '63705','92029','78804','55470','71769',
                          '30892','13808','59733','99229','37577',
                          '47242','14431','38144','74818','43127',
                          '34764','22892','96292','23873','52502',
                          '90764','91579','67166','43041','64234',
                          '90854','22840','14331','46570','27873',
                          '20978','80082','34540','70230','86947',
                          '67554','89351','84407','64092','50500',
                          '71356','62670','18223','20082','66484',
                          '46308','44994','64595','11528','40943',
                          '22293','94378','89279','94532','35883',
                          '21514','63042','87658','57749','85024',
                          '29192','38407','19540','84380','23307',
                          '65210','41834','15845','12033','68400',
                          '74639','23978','50435','33690','63994',
                          '33747','53208','31454','80797','20807',
                          '76548','96918','36258','90592','40342',
                          '29750','97668','64686','68378','34392',
                          '38268','55445','23193','73124','10166',
                          '37349','29238','29557','14116','39280',
                          '81982','76266','30250','56981','57527',
                          '78778','64285','60019','83674','60802',
                          '34621','34345','74219','55732','96337',
                          '65507','85200','12873','54662','93712',
                          '65858','47253','64305','92083','95734',
                          '46015','49594','88916','31411','49469',
                          '60950','69255','12237','30469','42002',
                          '23143','38036','27673','85496','19369',
                          '93667','76170','94178','89533','52156',
                          '35555','43604','37717','71735','50404',
                          '56854','82595','41534','47086','40695',
                          '83712','33930','49626','51303','65878',
                          '13391','58113','25102','92473','77014',
                          '30264','68609','27954','66776','91231',
                          '38508','48258','92208','67002','26781',
                          '71599','77107','29656','67064','24433',
                          '41339','66030','79780','97880','62604',
                          '61107','40366','21226','57619','99431',
                          '63251','58756','73823','46260','72566',
                          '32092','60976','96992','52767','46078',
                          '13919','68976','45235','84301','68411',
                          '58169','94509','74891','32046','90686',
                          '11103','74110','92926','51415','70324',
                          '49644','81542','39832','41688','14367',
                          '36763','31244','65849','97060')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '94279','79892','42987','56401','93695','33029',
                          '85390','81461','86659','53407','67868',
                          '11568','92028','59286','74886','64298',
                          '13618','23955','20722','80846','62793',
                          '90608','15908','94433','63428','32447',
                          '49762','36904','84278','25893','62655',
                          '75605','27733','95877','46092','99553',
                          '87013','13017','70993','62936','36500',
                          '95761','22282','46867','32398','58534',
                          '58286','89340','22208','56595','13809',
                          '98203','45069','63453','37036','92561',
                          '63926','63655','51918','53763','51307',
                          '93460','81348','62516','77443','27692',
                          '16411','89157','56512','32457','81118',
                          '79182','75690','43081','74239','83015',
                          '33513','69900','59817','43637','24629',
                          '28066','28147','44158','31263','14081',
                          '76075','84470','12279','24378','76963',
                          '52177','29338','76413','88350','88071',
                          '62779','43163','15348','76022','73293',
                          '36585','48806','89460','17009','46194',
                          '54023','99076','52198','18313','32257',
                          '78802','23125','70893','45909','17362',
                          '89896','99068','54472','21757','76385',
                          '37349','29304','20391','32538','29443',
                          '51694','22985','73864','20466','43654',
                          '83825','51824','75645','47912','48628',
                          '96297','73194','94580','66450','13703',
                          '11931','71077','91298','19510','78428',
                          '17212','61059','89555','17302','81803',
                          '85533','79615','62473','48162','75849',
                          '95217','91931','85681','86861','31432',
                          '25961','84977','79834','55944','23231',
                          '37471','42018','29011','93677','55530',
                          '22955','22734','61909','35281','88042',
                          '46264','85727','18396','69180','88111',
                          '21729','78477','25060','22554','95244',
                          '55511','37856','22758','27951','78314',
                          '10083','29342','36931','14741','64798',
                          '68068','40245','44033','98829','75622',
                          '46573','57046','29243','57808','54085',
                          '29325','77206','56080','51483','59845',
                          '19115','15941','21813','68234','21274',
                          '40785','40592','27068','69463','65749',
                          '88522','32328','40060','26673','59393',
                          '13726','84272','67370','82723','11286',
                          '55706','39627','71824','82810','97748',
                          '25937','60715','61121','30053','97923',
                          '43428','55435','15259','45372','49559',
                          '46260','66374','58027','69971','80700',
                          '19933','21920','13929','34254','21073',
                          '25014','76505','26263','39313','56203',
                          '88297','49686','18586','70253','16011',
                          '25101','19062','50725','25502','77419',
                          '16643','33864','85086','34328','74775',
                          '17826','88892','77661','65650','89483',
                          '15273','61819','22064','81667','52594',
                          '22762','53079','94322','89446','78450',
                          '28309','10308','59348','38650','37540',
                          '88050','87143','84676','41841','95881',
                          '64634','76380','67703','64399','62743',
                          '39090','91297','83743','16439','53748',
                          '41040','33371','76326','65426','39820',
                          '49703','64523','25246','87565','45808',
                          '51292','32762','86862','60127','19493',
                          '84338','31994','50394','35738','11303',
                          '30492','65567','86269','38997','53392',
                          '50767','25880','29309','60885','70254',
                          '65322','78935','71019','82889','14102',
                          '39795','33375','92413','37814','31738',
                          '44323','45359','38935','58552','86196',
                          '28530','67487','34242','13466','94051',
                          '59940','70110','68781','56291','79314',
                          '20330','99890','28084','25866','83440',
                          '65475','90275','75005','18218','18564',
                          '55288','95239','46262','17290','40906',
                          '92085','38064','47803','66515','28820',
                          '11128','39531','42031','33676','74525',
                          '87139','64421','84132','53401','59905',
                          '99441','98783','84544','51772')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '99022','39069','23524','10621','68047','11184',
                          '97398','24699','65308','83071','71135',
                          '46518','62452','66801','74520','70103',
                          '57812','43145','86505','88351','87550',
                          '66328','42075','87387','94577','43816',
                          '94867','15709','85433','42760','73324',
                          '29059','18463','13746','65334','11576',
                          '12905','14365','90702','16819','56955',
                          '11751','70664','27371','31804','69719',
                          '66959','19783','83861','95448','62156',
                          '38012','58442','25426','48923','38599',
                          '27960','30646','82766','24121','37811',
                          '40741','85489','81041','68208','71855',
                          '74377','71330','87982','45821','68391',
                          '81907','24633','31940','22202','88080',
                          '58227','85540','37207','43333','42661',
                          '50962','35258','89218','40387','89061',
                          '90945','69199','81180','87419','82561',
                          '71335','99791','56278','77870','54213',
                          '53724','63218','58194','36022','81683',
                          '98774','43306','48789','75413','36413',
                          '11542','52811','99518','17216','14586',
                          '68401','14685','84845','90865','71321',
                          '77644','66255','68187','97871','44315',
                          '73722','20095','83605','71538','43462',
                          '38985','61316','20346','56718','37431',
                          '33462','84107','98238','11714','84394',
                          '74042','35473','72990','72221','95829',
                          '31083','27884','54327','28649','18860',
                          '41752','79623','73761','76734','18378',
                          '17368','44146','16831','70836','82091',
                          '61304','14988','19293','34122','32718',
                          '22734','15416','79243','92655','21202',
                          '26066','41397','29623','23863','17876',
                          '79601','36334','60887','79622','19790',
                          '48554','53615','77941','56961','88932',
                          '82314','82608','82698','90227','61447',
                          '57700','16302','31499','77907','36712',
                          '34368','85261','81264','15269','90791',
                          '85971','95208','42382','64418','19403',
                          '92493','54992','32733','44596','98679',
                          '16301','63887','13979','69134','60156',
                          '26188','45021','88555','42326','81296',
                          '37712','19164','53135','95439','91573',
                          '38614','12748','96495','33673','59090',
                          '21501','81409','21710','16236','73843',
                          '96188','84177','48128','69130','71463',
                          '70340','11780','11659','79769','71255',
                          '20072','88758','71965','17315','27891',
                          '81937','67884','36644','75005','52436',
                          '66942','12193','78140','91804','11756',
                          '25767','98780','49091','78532','51206',
                          '66422','97020','71937','68540','69525',
                          '51811','70021','75418','75434','25053',
                          '29375','62828','28814','43405','14291',
                          '81891','18998','13994','66389','38335',
                          '47541','44562','75091','39832','37938',
                          '18481','17406','28410','73554','84669',
                          '16766','68219','53840','36527','70100',
                          '58400','29786','16697','56346','92810',
                          '54296','13166','96939','35305','81400',
                          '79116','30171','56991','28768','90785',
                          '94174','73307','28518','32567','26609',
                          '70532','61826','16675','54781','31862',
                          '98258','21425','84494','98029','81835',
                          '50189','69592','19269','76729','34200',
                          '89875','33369','86660','13205','92463',
                          '83709','82549','96542','90270','23618',
                          '18440','15814','44714','72346','29942',
                          '78288','90138','63476','73005','14413',
                          '97592','75394','79830','74840','91724',
                          '68977','30964','48919','28262','91121',
                          '72308','27109','53474','73919','58808',
                          '27808','15470','59988','81294','11640',
                          '76210','15195','89623','48830','83236',
                          '37280','45719','90536','62359','43287',
                          '84676','42920','17994','71087','78243',
                          '89939','55749','65279','73518','34608',
                          '34580','94143','63167','33769','34474',
                          '86290','22648','89471','27220')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '18294','59537','41764','38311','44973','43494',
                          '45239','78078','98074','47144','91628',
                          '25074','50258','11576','75297','55024',
                          '63823','58749','67838','95672','83454',
                          '65274','35147','54867','98945','76707',
                          '37220','99753','56237','60678','85454',
                          '57663','88470','98028','63603','41751',
                          '13547','21330','13444','63514','46216',
                          '36819','71646','77153','63702','74635',
                          '74355','85163','41163','20228','72707',
                          '74495','36868','28536','61344','49793',
                          '49885','93132','32331','24971','75474',
                          '43055','10829','43087','34692','49770',
                          '90291','84718','24128','71425','31538',
                          '70793','65352','81401','44614','27914',
                          '14944','43224','93377','62483','95851',
                          '91330','92206','35551','47013','86848',
                          '19985','42233','80548','73752','71423',
                          '42318','55524','56363','35573','37945',
                          '83989','90877','70627','89845','44798',
                          '97030','53687','49972','33310','49765',
                          '19574','90897','76994','40438','86018',
                          '23088','43082','99227','82939','32271',
                          '11637','44667','63476','94349','14287',
                          '17280','28746','73177','81585','46151',
                          '53180','40532','26107','87112','16688',
                          '91395','89951','70367','40108','42477',
                          '95474','88289','78725','60892','14648',
                          '72228','11587','90236','67803','27829',
                          '59395','11984','90419','38929','19452',
                          '46111','14982','78122','43955','12320',
                          '96535','39721','72625','72365','49263',
                          '68353','85529','74072','13392','75833',
                          '51957','76761','12507','46497','92246',
                          '24499','43661','44220','58433','67230',
                          '13956','72598','28540','70386','81013',
                          '12845','16513','54098','28669','79618',
                          '71235','13596','41096','25740','69152',
                          '76596','10215','86137','21472','70430',
                          '74491','73490','29912','69544','37938',
                          '64170','27958','57686','89876','68398',
                          '81561','27635','30819','26381','52122',
                          '18462','16623','61855','57874','84467',
                          '62807','98714','49968','87233','21298',
                          '13453','73505','25903','66160','75204',
                          '73614','60626','61878','50962','82031',
                          '95881','84319','74484','50924','10287',
                          '80303','57732','60387','13709','14709',
                          '99687','12179','32243','97307','62110',
                          '84895','75581','11767','54941','78494',
                          '31131','47790','23304','52748','95957',
                          '35512','87730','17495','70075','79637',
                          '13780','64100','18901','65116','10675',
                          '91998','42181','70564','33842','98952',
                          '42154','83563','59977','24903','94710',
                          '13240','77583','16286','17121','39610',
                          '61066','49430','30382','44942','23118',
                          '54883','70610','27196','66887','82348',
                          '71850','56751','31487','48918','32728',
                          '15786','58941','53907','69732','76277',
                          '49675','62796','66089','87306','55710',
                          '42649','27510','19354','21568','98220',
                          '80359','97665','48650','76667','41940',
                          '17844','60290','60020','49177','81779',
                          '12660','64789','32624','64216','89274',
                          '55733','90156','69001','22499','18761',
                          '74991','40992','34401','93645','66183',
                          '29772','15670','47382','97701','98638',
                          '71017','64150','61379','82460','23942',
                          '45983','11497','32897','11194','40466',
                          '68058','99668','94341','27006','40048',
                          '85773','15926','30898','61517','24274',
                          '93542','73346','40732','88335','91820',
                          '16554','67541','83323','75358','83457',
                          '26612','21811','26784','71366','25184',
                          '84130','82385','93088','88640','90272',
                          '36296','16531','33292','94425','52426',
                          '91206','73261','56470','47636','35822',
                          '60375','65391','28186','91230','41598',
                          '16936','62848','60445','71196')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '78441','72382','18105','50682','97147','78994',
                          '31782','13006','10123','50295','21322',
                          '15083','20682','63961','97313','94049',
                          '37667','24141','76254','95004','42577',
                          '40587','50134','31057','89831','41359',
                          '89504','69163','49358','66572','45414',
                          '30280','51112','82407','35591','76164',
                          '43503','10796','29040','35485','26376',
                          '82902','50233','10483','52132','59409',
                          '37442','97261','10312','43918','60155',
                          '52827','93749','81437','47138','28389',
                          '86617','98892','16297','77337','35177',
                          '34678','85682','32694','68535','75593',
                          '95872','68583','74372','29894','44325',
                          '63428','88159','17101','48877','84145',
                          '21894','95639','64952','86814','38151',
                          '32831','22007','20483','61930','30073',
                          '34424','66307','88626','69883','83776',
                          '35989','60018','97328','17514','90096',
                          '99857','14767','72161','96549','56794',
                          '99561','82863','11017','25706','95421',
                          '85037','32173','36737','70054','78628',
                          '85034','24556','73051','72716','95619',
                          '72356','14870','30780','93637','48898',
                          '18191','91797','95671','57426','97776',
                          '29759','99260','63523','46211','10019',
                          '34080','53240','18354','57288','93246',
                          '23733','10772','33786','31742','61169',
                          '76159','31179','80334','18666','52218',
                          '15761','29687','23883','66243','15052',
                          '40153','28629','53317','74122','90668',
                          '30659','92625','31833','64338','12210',
                          '55964','36332','62827','77980','10698',
                          '78661','59057','44526','44520','27553',
                          '92589','67896','69544','13914','53345',
                          '77265','12834','21687','84805','60999',
                          '95600','84352','79482','53378','83204',
                          '75023','84929','97309','41264','21378',
                          '86859','65625','35028','44729','21848',
                          '22247','26236','23695','54360','10628',
                          '41959','35497','25867','20418','26251',
                          '73613','72515','22709','95431','82129',
                          '88534','71256','68638','89281','20808',
                          '75712','92292','80910','24144','90554',
                          '73141','25863','84322','71844','23485',
                          '30113','16374','82403','83819','10696',
                          '71196','45228','52317','17875','64325',
                          '11203','73747','88388','84940','82459',
                          '24509','59219','51733','35153','63883',
                          '36176','59768','39477','17184','56407',
                          '84734','81438','25216','89382','11252',
                          '46898','56156','28074','44478','32942',
                          '36541','51169','49263','72209','84568',
                          '57888','39139','50994','58635','14533',
                          '88049','81226','53416','41349','99825',
                          '57318','54907','68324','32747','51094',
                          '78624','13294','90634','59960','79578',
                          '17737','34507','99447','19035','87912',
                          '97484','81477','45055','28046','10852',
                          '38420','22673','92555','37703','88331',
                          '10087','93581','66890','89034','10706',
                          '35144','97857','32045','82544','82969',
                          '22647','33414','72164','38462','36202',
                          '65609','79799','56363','29020','96826',
                          '24006','50099','49726','58911','82531',
                          '27159','65892','13038','44884','84387',
                          '11043','65130','33950','51106','21736',
                          '76986','66218','73683','36437','34739',
                          '83020','74431','32154','77347','41237',
                          '47605','19298','69787','98181','26119',
                          '30682','70022','85377','80824','28663',
                          '43318','53118','23591','83906','40971',
                          '50761','30641','77153','16133','83816',
                          '84582','81977','57651','19635','26364',
                          '69322','81390','85606','40122','25855',
                          '84469','52056','71292','36923','88038',
                          '12728','58799','37032','62399','28245',
                          '28442','25472','86931','58750','98180',
                          '55811','90674','27798','12031','26764',
                          '61056','22268','14114','72386')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '13826','70644','71172','87968','20218','23808',
                          '88409','96179','13005','95734','86742',
                          '85792','62770','42024','45545','45078',
                          '10260','79642','85869','46245','98284',
                          '17453','16887','33245','20298','18310',
                          '16095','20796','47527','95868','75821',
                          '10551','62040','52701','45738','52073',
                          '26518','66462','10679','44028','21966',
                          '84014','31372','42839','19638','92012',
                          '80125','35700','69321','74654','13904',
                          '42404','18592','10018','83601','69322',
                          '76297','88270','80808','30853','27079',
                          '73212','83985','88009','92668','23950',
                          '37921','17731','61685','40517','42492',
                          '38503','97147','93911','69696','38768',
                          '71216','30275','61564','70336','70303',
                          '87643','20561','44544','68447','92905',
                          '15640','86968','34889','11017','39592',
                          '81771','52863','48172','51032','75483',
                          '82488','83768','37469','10614','99242',
                          '75965','81242','95493','57324','99529',
                          '87180','70519','73316','34288','11929',
                          '48140','97577','69874','71525','97923',
                          '89353','91960','56403','65205','48621',
                          '23252','91842','33635','50498','98158',
                          '13684','75622','39373','73488','78342',
                          '92832','88132','40919','52150','13776',
                          '18752','61408','87360','60970','99208',
                          '93121','83831','88022','93088','30390',
                          '51908','21654','69057','84901','87850',
                          '79163','68815','66457','64115','53485',
                          '98691','94538','24259','58422','49261',
                          '25890','33522','69266','64783','65168',
                          '62303','67203','78433','16750','61801',
                          '49092','64338','84792','29675','22930',
                          '47231','58184','26408','71268','47929',
                          '21253','43867','33262','43595','73505',
                          '21722','71765','58522','47601','14836',
                          '75540','58372','27028','14981','95357',
                          '91158','78292','46867','10677','22194',
                          '87782','16734','88608','62222','71227',
                          '90870','26929','45284','95777','52943',
                          '39090','86702','86825','73940','90894',
                          '71288','88450','38176','16763','62917',
                          '73248','66380','35023','47843','15480',
                          '79820','74927','41760','32366','36446',
                          '19157','19538','25744','44502','70736',
                          '78047','80575','27789','80514','60758',
                          '50347','85021','14068','17773','56580',
                          '16070','12865','36054','89274','34933',
                          '15684','79408','29735','15272','24368',
                          '11234','22050','52444','79319','68421',
                          '33639','33677','30108','89984','73025',
                          '24895','82509','52032','77455','43431',
                          '47136','88102','56751','30240','17690',
                          '88638','43032','29522','80280','35097',
                          '86369','56925','56517','50700','63795',
                          '36179','54921','50755','80882','58513',
                          '99431','97549','84834','98743','86715',
                          '27675','20768','22280','77085','14496',
                          '76090','45228','34657','84773','54201',
                          '25273','41727','93276','77219','61024',
                          '84735','74879','35208','38672','37854',
                          '23046','33829','60941','29467','19042',
                          '17264','19176','40831','51176','87412',
                          '36540','88392','75287','78471','96080',
                          '57336','35215','91254','82154','75372',
                          '72448','31449','42239','48009','70905',
                          '93207','82314','53432','18366','30279',
                          '89169','74271','52407','78787','71667',
                          '45529','38601','32982','97046','74368',
                          '38568','76194','43249','82583','98444',
                          '58359','52128','97844','16833','86168',
                          '79790','54440','55925','72608','35663',
                          '71738','24707','94167','78798','52181',
                          '12521','47647','34110','69378','86703',
                          '16790','93268','66360','15946','20473',
                          '56741','55301','80070','75491','77797',
                          '47842','30950','68404','92675','52454',
                          '69612','57201','36777','93235')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1999
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '54399','88766','28568','24637','80671','73700',
                          '89314','36404','57641','88445','85159',
                          '44646','68762','15988','59199','34030',
                          '14341','36953','60771','49974','95458',
                          '72819','59216','55340','83069','24318',
                          '76360','16069','84570','33335','38232',
                          '40990','19238','63692','29601','27339',
                          '55944','28509','56199','30895','98075',
                          '65240','72011','65607','10023','93067',
                          '55863','20454','92572','77294','10659',
                          '62752','45847','95948','98844','18190',
                          '12420','53820','58054','71322','63439',
                          '68743','78274','28571','13943','39453',
                          '76931','25161','51700','16509','82233',
                          '33147','33838','89864','23732','24202',
                          '17057','65478','99552','13180','18896',
                          '49774','91997','83119','97997','57636',
                          '24419','96220','45159','40794','47162',
                          '32745','11853','72295','95874','74624',
                          '85535','10487','49325','82519','96511',
                          '64752','55980','90977','66899','31474',
                          '92227','75294','93129','77932','90658',
                          '25792','74609','82595','56654','97334',
                          '24729','50749','51235','65707','85057',
                          '45722','26282','27494','62081','72949',
                          '53651','43412','74232','88860','27963',
                          '71173','73573','28166','99428','35201',
                          '41160','16540','24640','77319','26732',
                          '32575','17900','31716','85968','71015',
                          '97920','10325','45615','28921','56447',
                          '86604','37578','82793','94975','32144',
                          '76732','70034','31727','25355','82072',
                          '59792','87871','86690','25852','97154',
                          '77992','58019','66501','78539','56758',
                          '60186','98878','30228','93884','83650',
                          '26685','59781','19844','92974','65686',
                          '24943','93461','62943','78297','33755',
                          '31316','50245','28544','59983','59641',
                          '66780','46502','47535','17726','50232',
                          '87117','70467','90355','90082','91793',
                          '76415','23633','71513','74994','22214',
                          '50336','30836','13351','13221','62919',
                          '59245','51735','43911','61395','46134',
                          '72238','13181','67113','48432','66408',
                          '39550','32508','74066','80015','20510',
                          '30485','64352','92836','25110','79805',
                          '83466','16259','86522','46299','73989',
                          '70313','79084','13009','63831','71425',
                          '63289','38618','68860','25975','14958',
                          '73133','48660','97559','16785','23974',
                          '39553','82107','60617','63926','33667',
                          '85234','45801','17510','98917','93503',
                          '15958','11852','65130','55929','38135',
                          '25395','22769','93688','26618','85434',
                          '92773','17753','88725','50320','30503',
                          '28826','63033','70469','76169','17134',
                          '15652','41028','51440','25263','31456',
                          '73630','74363','51914','42215','84863',
                          '33742','17403','79335','27939','16021',
                          '56537','65168','10963','60498','64252',
                          '77223','69220','37422','91223','13229',
                          '83239','99344','99639','92146','76843',
                          '52533','29310','81258','49551','93074',
                          '85383','46182','19329','74408','95001',
                          '67564','10917','61975','74437','71343',
                          '83191','36948','14376','77632','30789',
                          '61889','75141','57277','19251','32101',
                          '52563','92868','80749','57683','68767',
                          '10271','41751','78976','47121','22989',
                          '81474','60557','48443','92648','52303',
                          '86245','35496','71681','80808','22510',
                          '21897','29975','92667','13026','13820',
                          '52712','49840','54968','68582','28007',
                          '96172','43783','71290','77914','55180',
                          '79085','42017','98510','31804','11623',
                          '56523','78008','56906','34812','91831',
                          '32038','52472','28253','91898','30148',
                          '88028','20790','12293','51635','93879',
                          '80779','28489','20099','35694','94998',
                          '73302','30126','16767','45510')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1999
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '41856','94632','90705','33364','26572','20896',
                          '48258','36796','10308','35463','60919',
                          '99446','16572','39762','46893','20088',
                          '87223','73765','37611','95482','18214',
                          '21325','49563','39318','80728','57381',
                          '97816','51607','53138','75300','60052',
                          '51975','76688','95097','29256','15724',
                          '30303','22405','20998','24639','64510',
                          '59672','50048','74136','62115','23347',
                          '16133','46586','90865','30463','85781',
                          '20209','26028','60858','64369','82476',
                          '41954','27717','52718','84488','84461',
                          '21756','60053','71438','30587','63656',
                          '17143','73195','68660','98752','20144',
                          '10867','17350','72440','42129','60612',
                          '14608','63468','13795','57658','95516',
                          '46741','76160','16482','80936','79868',
                          '98239','36598','35912','24002','33590',
                          '40866','56786','17074','89747','20218',
                          '53107','17488','35677','92330','80431',
                          '59118','95037','13282','29017','62288',
                          '30834','40304','46499','36186','13005',
                          '41673','71434','72339','33032','24980',
                          '45030','36183','68228','43990','50870',
                          '37449','25110','45965','48349','75411',
                          '97638','40438','30389','59209','59791',
                          '34444','57845','87242','29176','10400',
                          '28357','86163','21439','40669','91184',
                          '64070','62940','62775','42291','47282',
                          '52001','23955','51543','55896','28719',
                          '47150','44810','11731','16977','35984',
                          '22992','99797','84475','49059','41947',
                          '54654','47234','33175','73770','40228',
                          '68405','96902','78727','49733','11288',
                          '75820','69033','12426','15090','88846',
                          '72401','12227','54301','70630','10487',
                          '84049','11370','13653','57189','95179',
                          '83738','40654','16228','53954','80965',
                          '14933','93402','45234','43559','92010',
                          '22327','78394','86240','47582','21416',
                          '52812','23301','65091','99940','40805',
                          '75205','60072','95896','95600','44078',
                          '64851','63131','29552','22246','48348',
                          '50052','86326','17304','30049','92492',
                          '14599','27346','98264','71781','55076',
                          '88022','91551','16671','51514','15584',
                          '70172','28896','43982','84681','78586',
                          '23278','12620','69220','54822','88712',
                          '24308','41678','10554','53536','31399',
                          '57783','79392','39390','87882','38860',
                          '19027','79448','77113','79954','49355',
                          '51179','18246','91954','55574','64827',
                          '76474','84398','17805','13771','99009',
                          '86360','44662','65888','60041','54584',
                          '68796','59614','19893','62047','84097',
                          '23192','85436','50822','63532','35294',
                          '40725','10039','13427','14669','99305',
                          '73834','46425','60596','50751','87936',
                          '33124','30015','65877','73816','82145',
                          '39352','90441','16814','81251','37923',
                          '14461','56844','71699','95528','18837',
                          '76570','67906','27061','87618','65856',
                          '21107','68155','93265','28696','21010',
                          '31018','74045','50059','21301','96915',
                          '97199','34832','12297','56614','30975',
                          '90241','13512','41445','27490','26574',
                          '32171','86771','84019','33996','39183',
                          '98385','13710','54877','94317','80603',
                          '40867','11502','42482','30042','40801',
                          '17786','16819','79565','73783','80807',
                          '27040','65289','28563','38401','38179',
                          '46859','77926','55871','68178','18773',
                          '29181','39306','16773','78534','79696',
                          '87378','27323','52217','29600','59832',
                          '37809','36461','47481','70870','38571',
                          '55307','34157','85768','13629','95777',
                          '40378','84650','47251','42006','47853',
                          '64717','32589','32999','65883','92941',
                          '69265','54931','11295','12769','32077',
                          '75042','45683','96095','35355')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '45657','51615','27014','67551','41401','45000',
                          '16495','18385','36586','24351','31135',
                          '45050','85888','85628','27528','55002',
                          '86191','62094','75043','64886','46503',
                          '11156','25891','91228','41094','74145',
                          '12608','11867','85266','57828','95368',
                          '41906','15823','51666','41908','13439',
                          '81589','40322','60758','74483','29748',
                          '61452','89902','60546','57170','88223',
                          '50969','88370','93184','48321','58725',
                          '56404','17541','94088','19375','50052',
                          '76961','76339','96221','20410','20793',
                          '20586','88648','70372','12480','45644',
                          '52910','60956','23543','69191','55397',
                          '80952','40434','52286','43864','76714',
                          '62415','16177','14469','17565','70749',
                          '27317','41383','20325','37642','42969',
                          '21197','18181','15514','45534','75335',
                          '64441','31014','77874','96264','23285',
                          '71019','35859','23759','67713','17127',
                          '47549','23755','31577','17161','69969',
                          '31375','13875','30869','34160','90295',
                          '52051','31446','23555','12621','79823',
                          '72673','48671','81528','60746','38106',
                          '95837','40790','39821','52478','48879',
                          '44436','24268','65757','69510','16134',
                          '32636','97497','95555','77025','18994',
                          '29112','79552','54210','68109','94880',
                          '50911','58760','48654','97712','62805',
                          '73076','85147','21631','38033','25849',
                          '25020','93865','27333','15829','92303',
                          '86622','68919','32008','65161','14184',
                          '46642','54598','45545','73363','88988',
                          '33775','74810','87174','71259','65377',
                          '83496','72456','66667','79176','72124',
                          '26821','56568','46884','71665','99204',
                          '30029','68769','47385','85043','22607',
                          '95043','30229','50467','83447','54805',
                          '69459','92575','51432','75646','34958',
                          '78351','16719','43701','54437','76154',
                          '72560','24120','38557','55424','98896',
                          '89287','59762','93172','63539','67318',
                          '39779','90530','67635','75683','34779',
                          '29120','26917','28772','13707','29140',
                          '23001','34938','50312','35834','23008',
                          '22438','91797','32047','80881','34183',
                          '54054','83829','63883','17939','62398',
                          '38674','96253','21080','35790','74994',
                          '64228','10735','63891','76983','90260',
                          '76537','43696','75792','53935','43986',
                          '32544','78060','36907','18806','22889',
                          '34579','40501','53258','75019','19119',
                          '21243','14620','22349','22207','65733',
                          '83788','11632','41585','87455','78651',
                          '61305','31850','23176','94079','74726',
                          '54997','82023','15028','15652','54321',
                          '26679','61286','30696','73531','33989',
                          '85373','40624','45439','90479','47161',
                          '47353','91126','66808','21270','57284',
                          '80094','19864','56480','75347','85848',
                          '33930','18400','33763','53105','53817',
                          '66620','68975','91962','20620','44946',
                          '67789','18073','17304','10199','31689',
                          '21708','87835','94254','66087','29397',
                          '84057','36978','43524','61941','16899',
                          '89513','88243','19827','31619','82755',
                          '66404','43853','55428','23424','52003',
                          '75918','76297','97126','48497','16315',
                          '31706','65446','31808','79677','12682',
                          '22289','47093','38490','37224','62476',
                          '63881','35826','52825','43361','27314',
                          '15863','22304','25669','89083','82955',
                          '90167','99188','44964','65052','76693',
                          '69119','86766','52332','60478','29307',
                          '29885','65997','95170','55672','73579',
                          '64830','61657','42421','36552','46448',
                          '74697','87987','40327','43652','90452',
                          '48903','71807','25727','91059','77958',
                          '61061','92838','44415','94004','95654',
                          '61548','61521','19485','53182')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '46183','84911','24782','37076','31819','57084',
                          '27748','86933','51724','85692','59065',
                          '17038','54853','59370','54493','91151',
                          '64807','17051','59627','22047','99545',
                          '33745','15178','77581','12693','65323',
                          '77137','33810','18024','31255','86484',
                          '72457','64761','98288','88896','14101',
                          '93471','80668','99322','10827','57028',
                          '82001','32571','69633','33822','94132',
                          '64852','38322','99144','74674','49648',
                          '37371','24257','44826','38246','37137',
                          '81428','90245','52003','79886','45340',
                          '87949','37902','93452','24856','37593',
                          '22738','21961','75610','63754','37705',
                          '94338','65714','61536','14058','59306',
                          '30121','18253','62250','66552','49532',
                          '55931','36635','56622','97797','82416',
                          '47625','71989','29426','48229','37141',
                          '30209','91127','10220','58974','63111',
                          '46761','71930','65686','46803','31983',
                          '84195','60839','30964','48715','70820',
                          '61683','11343','13613','37081','46051',
                          '49023','31177','73425','56471','90276',
                          '51212','13851','24724','14726','49281',
                          '77496','19334','88768','86710','19232',
                          '14323','43060','98195','97883','79525',
                          '56254','48855','65515','60983','99149',
                          '26147','55362','14093','55674','57314',
                          '71913','46396','56920','48014','15023',
                          '23655','57987','79557','60931','32746',
                          '62007','12468','76323','31544','34981',
                          '36823','61477','29916','37472','11507',
                          '79048','34005','41055','46152','73115',
                          '40682','20158','28686','10183','72641',
                          '98843','62880','28803','74193','87508',
                          '32258','41276','50808','61740','16646',
                          '76715','41085','66572','12032','11911',
                          '10761','30769','50320','51150','40008',
                          '29853','84188','36223','66657','48727',
                          '10032','68536','59659','31795','51056',
                          '67420','32269','73846','58514','88859',
                          '77870','41313','91567','98099','74109',
                          '64412','92478','85486','38936','51379',
                          '45249','17229','57699','72639','44708',
                          '81543','76363','32245','11039','11293',
                          '98572','85095','87339','65769','49640',
                          '94403','56418','12398','56960','79633',
                          '16705','67990','34746','52137','90594',
                          '66461','27230','14649','35762','16471',
                          '90211','37359','92555','80040','66979',
                          '43918','65861','86797','96418','69948',
                          '45897','26378','80039','50001','23340',
                          '16086','31491','48437','95807','15854',
                          '36513','40790','64042','15306','59704',
                          '59725','22893','12530','42695','71373',
                          '49090','74694','27382','48033','34465',
                          '62303','96608','71230','22549','34587',
                          '68612','49475','21890','39645','55198',
                          '81779','78332','94845','82139','93719',
                          '55586','74961','93623','45792','55377',
                          '45574','78814','78435','36047','98124',
                          '57870','54344','68627','29056','15418',
                          '11295','15919','42648','19715','85351',
                          '48758','64638','24389','78291','20205',
                          '99350','58787','93686','27381','81342',
                          '22200','24078','49736','72224','82053',
                          '98272','77355','11046','53348','91271',
                          '43769','35609','64525','40033','96577',
                          '83558','79412','84518','24129','59866',
                          '61388','12058','59015','64673','54428',
                          '14028','33422','32748','19149','94528',
                          '25532','73908','51642','60155','35686',
                          '15874','36412','94700','67695','55430',
                          '56001','61998','73732','12340','60472',
                          '69132','70694','10735','48812','28857',
                          '55783','28626','14330','87384','28925',
                          '64441','77970','91771','54884','42284',
                          '51746','60685','43821','67831','25359',
                          '16359','44380','23476','10040','18406',
                          '37503','16603','70690','75843')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2002
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '99113','74250','49426','85591','86318','14443',
                          '86299','25992','25928','80393','45134',
                          '18856','31367','54580','70260','78309',
                          '44886','96899','61581','59303','12317',
                          '49705','46948','73317','92967','53202',
                          '88171','35503','32789','97116','42369',
                          '31004','23747','82124','49533','31077',
                          '18021','68756','61054','71016','64756',
                          '96562','52763','92076','25278','87897',
                          '57085','87966','78409','77821','92990',
                          '37898','86507','25583','29818','25406',
                          '66456','29095','76867','50147','18032',
                          '16088','13556','19783','31976','40625',
                          '41713','79908','97067','28417','12516',
                          '27737','43010','49139','66846','45808',
                          '89796','16184','83467','63387','83322',
                          '53173','99778','70426','76890','16259',
                          '44716','88157','47054','46423','47517',
                          '49997','29304','62126','48856','29349',
                          '69547','31129','58504','97072','71304',
                          '85715','46023','72547','99998','12707',
                          '84271','30659','87990','46755','73832',
                          '22754','26545','63132','37949','49853',
                          '97360','95815','94005','59513','84503',
                          '23651','30645','14100','41598','47822',
                          '17519','46665','59962','56583','33028',
                          '39425','99626','14610','60654','71538',
                          '24828','94830','45979','67770','12822',
                          '74011','80736','51312','28947','97348',
                          '50124','66828','26079','47033','44775',
                          '74200','53916','46621','95826','51020',
                          '50321','65834','68395','39784','26075',
                          '13676','84980','33864','51136','30544',
                          '81983','20450','31849','47602','12675',
                          '28419','77626','14666','75350','58522',
                          '32675','25370','87996','79390','61320',
                          '86371','42128','76779','12261','15538',
                          '34308','27562','76411','41872','81074',
                          '12561','49279','48416','97253','17113',
                          '12909','20457','50632','58184','99398',
                          '52679','28230','95312','15541','48184',
                          '63671','97706','88471','91122','74275',
                          '10672','78599','56223','13226','37561',
                          '64446','79216','67518','70296','90763',
                          '37921','35089','78585','97870','22760',
                          '82025','27508','79551','57406','47450',
                          '50760','39031','90659','25808','36927',
                          '10163','20783','19674','98410','66001',
                          '59652','77560','87595','31639','87686',
                          '90918','27943','25096','94560','41135',
                          '80208','85941','18496','42278','10526',
                          '39003','85770','42789','54968','45361',
                          '39110','40985','25014','42277','40659',
                          '65839','64658','10883','24683','43931',
                          '93087','14930','82177','86340','49718',
                          '86798','17280','73352','73629','30951',
                          '11477','36326','35572','96405','87216',
                          '56390','90324','70097','46354','51566',
                          '62296','77886','41991','28604','69908',
                          '27242','82632','77538','86946','39251',
                          '66754','49496','53825','83703','57408',
                          '69621','10886','96039','75046','92226',
                          '66802','75547','35039','69691','90136',
                          '74101','78607','73621','15266','52501',
                          '23607','24925','31973','84675','41093',
                          '42757','80517','68555','48131','74785',
                          '43617','65357','29620','68820','66652',
                          '92128','97651','26095','80228','91358',
                          '16880','87423','68379','55253','97730',
                          '60532','84900','56822','51254','31642',
                          '34965','88422','37174','80443','26370',
                          '95606','11568','27597','85220','20103',
                          '91366','91556','12744','56811','83338',
                          '23339','68725','29209','28653','27368',
                          '94040','43928','83119','18851','89407',
                          '36985','20859','96212','46812','44236',
                          '98720','11693','13181','83330','77351',
                          '13629','64939','27397','71426','84209',
                          '28478','15268','93845','15284','64819',
                          '80268','24508','44903','83976')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '70063','98248','24500','18684','81396','45239',
                          '93685','76869','70110','72744','60806',
                          '97567','17313','11855','24010','19432',
                          '72533','33268','64340','97294','62824',
                          '41939','41607','62076','38159','52678',
                          '21406','20186','65444','86550','52893',
                          '97856','27060','45406','48901','89338',
                          '39291','75587','54679','44715','22910',
                          '20954','15640','83600','43467','48206',
                          '52208','30737','14015','13828','88041',
                          '89042','80016','80862','89000','41960',
                          '93967','80061','38975','30618','71389',
                          '77615','91300','78966','83345','70358',
                          '18200','47591','63739','33203','89289',
                          '10169','64164','51396','72931','55833',
                          '58259','91627','19778','59831','63523',
                          '38299','52260','95220','25931','36264',
                          '59946','72115','19610','34998','87977',
                          '18765','71687','31051','77151','12700',
                          '44598','54893','29084','80859','12353',
                          '82373','71528','86521','53140','54038',
                          '24069','83815','57964','78022','79406',
                          '50728','54092','30587','93056','55009',
                          '38749','31651','73335','77488','82912',
                          '34942','45304','36951','97982','76570',
                          '82965','51408','86132','93051','71789',
                          '87771','87235','88287','71745','79597',
                          '98514','39745','66234','64893','62566',
                          '83787','50043','78884','31721','20255',
                          '18696','90360','22623','56583','63840',
                          '75239','61382','58173','25659','83187',
                          '61585','66608','11610','97709','10796',
                          '51662','10452','24958','48286','70582',
                          '55268','67174','17864','97302','69502',
                          '10661','78314','44667','65769','97917',
                          '51037','76864','96063','72011','50513',
                          '66249','71091','81216','70507','19554',
                          '44569','43666','30342','68928','10107',
                          '63667','52436','75233','65146','84164',
                          '42172','70288','37667','40474','64035',
                          '80970','16636','39184','77441','81923',
                          '69566','24094','89927','99195','46718',
                          '18514','48846','77113','15626','88577',
                          '82163','54824','34129','34148','17241',
                          '98302','45697','47341','53697','56158',
                          '29022','22693','39338','81560','71764',
                          '40788','69114','99336','72809','91047',
                          '86694','23809','34277','55389','21848',
                          '25722','37586','39507','23446','83501',
                          '83643','32412','95707','48470','47497',
                          '86337','63446','47351','30169','61483',
                          '62158','48148','41622','83416','17078',
                          '43576','35701','54062','19131','52365',
                          '54031','82214','22951','65561','33721',
                          '38389','87907','66361','99019','70935',
                          '37478','30477','29468','80503','27018',
                          '43578','98541','53976','90869','85713',
                          '77847','40751','44728','13502','41562',
                          '17057','81932','85603','33618','68985',
                          '59316','97919','87210','89519','78781',
                          '56508','89322','69251','73825','34121',
                          '24033','53837','19571','91253','51624',
                          '63509','37387','43812','43927','90218',
                          '26606','10233','29492','41854','51761',
                          '83334','32110','12589','72607','88283',
                          '13248','15735','84519','56772','71759',
                          '24590','81328','94200','34069','54298',
                          '22113','92019','63720','37602','57630',
                          '11814','98477','61560','57758','68912',
                          '50854','97674','31512','26766','72312',
                          '91132','97705','69164','24823','76348',
                          '81939','86327','69998','60044','49941',
                          '31442','84474','61065','67472','18596',
                          '24778','96774','83816','31142','48152',
                          '49201','23373','56531','88009','43694',
                          '80615','50009','92898','52284','38812',
                          '79740','84584','14213','26825','16548',
                          '22928','97582','59955','28463','68172',
                          '24384','40970','57093','58567','98952',
                          '40410','94942','87258','56929')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '42556','84268','96310','63763','37727','12253',
                          '39312','83587','32521','46840','74376',
                          '15299','27835','32242','24037','77228',
                          '86035','99003','48503','84232','35648',
                          '40766','52121','13263','83266','81807',
                          '90439','94490','92347','54194','78890',
                          '36115','13474','44928','62109','17683',
                          '87092','38604','34921','17686','39248',
                          '41131','45294','65778','67967','32284',
                          '27289','70486','93831','27336','69637',
                          '11721','44142','34796','89482','60915',
                          '24698','43293','15778','74243','26442',
                          '72030','75408','23024','36761','49931',
                          '83896','19506','29046','55371','17757',
                          '77007','23879','59942','12260','29295',
                          '67527','13181','15537','94790','47842',
                          '11767','55163','88086','48311','22706',
                          '13636','33322','63596','10633','26155',
                          '93811','34557','69141','10598','72614',
                          '62900','61196','29933','62013','18693',
                          '76345','65015','68349','18303','57204',
                          '62339','82357','49411','59503','65486',
                          '96538','85020','29151','46326','12040',
                          '14386','41177','86452','19349','23334',
                          '75691','51152','40198','77679','39918',
                          '45888','73149','91634','60750','70379',
                          '84636','19710','69612','16955','15783',
                          '11668','91074','68017','47730','98956',
                          '57166','24265','40130','46715','56602',
                          '83624','65714','48446','99628','56678',
                          '34575','68914','64664','76507','63807',
                          '11120','97351','11385','54614','54813',
                          '76928','85326','46087','88255','52933',
                          '54389','85473','96883','76100','55126',
                          '22690','39933','78173','81742','72635',
                          '56586','16038','10281','46369','23535',
                          '49762','63978','25363','98212','15054',
                          '71632','28770','78832','48421','13403',
                          '18268','22666','40503','23520','72108',
                          '84535','70804','54879','63239','58658',
                          '14835','29912','43328','41077','98881',
                          '10468','99608','76560','26160','78259',
                          '34262','36937','71265','74450','97797',
                          '37049','93639','35974','84066','60101',
                          '53228','95461','93621','14142','34983',
                          '52081','73180','75556','15230','42764',
                          '25951','21110','48993','32817','72183',
                          '50695','75343','64707','47432','13051',
                          '24803','31239','40744','11950','57297',
                          '47713','50189','19282','96592','51978',
                          '17489','90795','45649','52090','99896',
                          '54819','22652','25591','98739','90334',
                          '46268','95220','50567','57873','15393',
                          '32433','35066','65295','98392','91093',
                          '92124','65422','91104','53403','72742',
                          '11948','49370','81836','27997','38301',
                          '96932','54675','38356','61119','53417',
                          '97796','97907','94245','37019','37182',
                          '98155','57528','75260','23501','97181',
                          '12109','92670','25523','83411','78965',
                          '19035','61204','77950','49587','73730',
                          '99356','81525','79162','98449','49653',
                          '21022','12057','42342','65727','34979',
                          '19773','19161','58583','43080','22681',
                          '95608','61383','76140','85497','66405',
                          '55239','28099','99454','49693','74495',
                          '72743','60430','28506','27216','34712',
                          '96785','19643','34905','91271','10243',
                          '78276','44132','46446','23238','38737',
                          '82807','96237','17597','86882','41724',
                          '24460','26221','67093','33281','27794',
                          '64590','71751','49851','15457','60761',
                          '47269','68371','30301','95110','13443',
                          '42223','83734','73706','58698','54148',
                          '94196','75987','66671','90756','79464',
                          '66570','62969','68341','50962','43756',
                          '80881','59032','87508','49351','41700',
                          '61671','85391','89840','36978','80101',
                          '47667','84635','41969','92405','98581',
                          '29143','51342','73026','17214')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '53728','20100','90645','71908','87725','65257',
                          '38521','68258','55002','67474','49241',
                          '64401','28109','10178','13333','35203',
                          '23255','16740','45120','26403','72932',
                          '15092','64972','50383','24752','44284',
                          '36473','16069','62991','13379','63434',
                          '83862','13267','86209','88398','10484',
                          '14459','16264','50207','23176','36261',
                          '58080','78282','23373','41880','46594',
                          '94366','18374','61426','12901','20618',
                          '39886','12188','46585','81304','67357',
                          '67431','96627','56595','49609','83332',
                          '57166','53619','99887','92272','68773',
                          '89668','88556','13279','29916','37603',
                          '84524','34198','45476','84720','92104',
                          '65691','86833','69375','81725','34569',
                          '44336','57232','89275','32338','55063',
                          '74809','40584','76785','41409','72053',
                          '76724','27725','10522','88670','68014',
                          '72639','21829','70206','78753','71630',
                          '20371','41835','38599','27316','56300',
                          '27890','19228','43740','60629','35444',
                          '82249','37591','35948','57350','98949',
                          '90447','44170','82371','44237','90277',
                          '58048','77112','60099','77302','63988',
                          '77159','39985','36884','45692','69528',
                          '95032','19411','47314','66344','62905',
                          '89911','15777','24444','35311','82120',
                          '19136','84931','32913','21015','94515',
                          '32037','72090','68633','65971','96977',
                          '42052','47826','58127','88531','16975',
                          '13423','93145','54309','69514','75791',
                          '72083','37409','49363','97715','69012',
                          '50802','66061','60278','50680','44769',
                          '89402','18789','28452','46195','88291',
                          '64970','95701','90568','90468','38498',
                          '93933','45150','79710','28003','40740',
                          '67192','33675','99667','53652','37036',
                          '72754','23205','35120','66683','76059',
                          '42476','92242','26159','27885','37142',
                          '94624','58602','14636','17930','66758',
                          '89239','28886','67914','78731','32469',
                          '23589','82557','85889','70908','77279',
                          '32769','79315','98035','91439','51655',
                          '82149','96603','97585','61900','49387',
                          '58940','21182','19339','65612','20735',
                          '15550','50890','42038','63987','87484',
                          '49010','98191','36178','20517','99726',
                          '75378','11401','36041','83020','30007',
                          '49880','79303','46537','35335','15809',
                          '20257','30493','61150','50942','10855',
                          '67719','45236','55604','27030','34908',
                          '54474','69436','61663','74056','50326',
                          '98575','12085','96595','71724','76546',
                          '88032','46207','63462','45438','30552',
                          '41550','84932','72444','54279','30264',
                          '47966','56874','26667','44156','99893',
                          '45478','77205','42381','23281','52562',
                          '26894','52070','18421','48465','39486',
                          '41213','84102','51494','98327','63982',
                          '52215','74260','15901','77081','25751',
                          '18107','51217','73101','97363','40311',
                          '48138','40941','81787','11065','99577',
                          '41080','40445','87380','99768','16051',
                          '97425','29828','12631','19184','20355',
                          '67095','31762','61599','31426','73132',
                          '72329','10708','67970','56499','38977',
                          '38815','36431','57678','21019','80267',
                          '19294','44227','39144','76469','96985',
                          '18909','12225','40092','81993','54024',
                          '57540','53253','38738','36335','73526',
                          '58998','62484','82787','33294','24867',
                          '80838','16308','10494','12635','27925',
                          '58102','47772','58955','42182','64938',
                          '16488','90372','45135','26834','44352',
                          '11608','72530','79442','12688','18617',
                          '65886','56075','62530','49186','83995',
                          '77324','12260','83487','77859','35041',
                          '34026','72832','51514','52628','77651',
                          '62282','12508','54991','79218')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 1999
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '25988','63668','81265','54008','44759','85677',
                          '45078','29603','50500','96306','68944',
                          '35878','44019','11430','83910','70605',
                          '18333','35900','37918','10504','26972',
                          '68264','28065','41963','66602','53085',
                          '35236','49246','66200','82201','72386',
                          '98801','36489','33346','70695','95266',
                          '69218','75444','94414','90294','84380',
                          '33189','46430','94067','89009','34363',
                          '90298','48653','76294','40284','94691',
                          '98850','70594','10999','91183','21368',
                          '28034','64956','64074','15089','80945',
                          '18437','64016','88706','89773','52284',
                          '79905','59456','48386','66180','74233',
                          '69062','42183','23608','58292','84193',
                          '95856','91915','67349','13821','89844',
                          '74738','27670','19829','73939','57546',
                          '70269','63893','26984','17377','94706',
                          '65535','53839','83978','69471','86045',
                          '79003','37093','73524','16197','73897',
                          '98045','18611','37638','56470','20371',
                          '61474','36423','12959','23286','28760',
                          '22784','85563','58983','70838','54510',
                          '76776','48587','20985','84168','20939',
                          '51768','43503','40926','60387','83317',
                          '11469','87037','82473','86911','94241',
                          '50114','93184','36768','23629','64343',
                          '62649','33862','59727','78089','47317',
                          '85860','35364','23225','57874','50667',
                          '50617','65105','71597','96712','48293',
                          '80662','55263','66946','33447','79223',
                          '15834','41507','88319','56878','18857',
                          '35570','99634','87054','37596','23037',
                          '85090','42719','85200','23691','47981',
                          '45708','34955','24468','73961','69649',
                          '50986','39068','41734','57512','98495',
                          '91487','54969','17515','44485','29165',
                          '12479','11222','66804','77189','50293',
                          '81175','47187','14369','78345','35727',
                          '22089','64422','24054','81637','58730',
                          '38225','77771','10037','47190','47592',
                          '56110','37827','50792','72589','33993',
                          '44109','24930','80747','15219','31557',
                          '37480','49224','97308','39653','11969',
                          '84724','95171','33437','37255','92782',
                          '23944','71377','63989','49135','63852',
                          '53360','61733','95543','73539','32512',
                          '67780','93436','28829','69396','22964',
                          '50183','19106','36232','23135','76612',
                          '43034','40025','82360','78265','30178',
                          '79789','78946','97880','43852','58062',
                          '95717','56501','93902','35756','35921',
                          '77994','15533','73260','24510','46172',
                          '60070','85995','74190','92397','20607',
                          '66768','26455','21148','39857','54053',
                          '61212','11575','29383','58174','95464',
                          '92674','64953','74723','29283','38841',
                          '18987','47024','12152','89795','76246',
                          '27507','69871','37171','51416','69689',
                          '37672','80529','40228','21591','75621',
                          '41614','73252','40599','19773','26744',
                          '47262','70971','83254','27430','29269',
                          '28334','64884','24724','29592','97076',
                          '66355','54681','76975','50554','16345',
                          '54416','50067','41598','82514','21706',
                          '47922','50946','53603','16048','35327',
                          '82936','25368','62588','65053','55891',
                          '18625','34437','24345','56560','28171',
                          '40136','34382','90096','70117','86429',
                          '24204','58998','45731','51109','41913',
                          '44782','87065','78381','65598','90576',
                          '89212','83399','30248','91660','54017',
                          '44042','68702','71367','66257','93350',
                          '18982','79089','54331','18617','63247',
                          '40287','23248','60290','57399','48538',
                          '17787','99445','98968','30628','27882',
                          '40481','54439','80752','81854','96812',
                          '51404','57385','71246','48131','77970',
                          '17124','17813','86398','81277','44290',
                          '36731','84365','87299','82279')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2002
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '82512','73796','33462','84082','66875','26974',
                          '43788','95018','59132','20598','99365',
                          '28812','29898','99619','25475','40476',
                          '17655','23030','35551','55309','88901',
                          '53751','75510','37865','36972','92806',
                          '13995','99117','50607','45813','90992',
                          '55383','89196','57751','58802','46386',
                          '66468','45347','90661','46282','56531',
                          '68768','61531','57887','19595','46279',
                          '15648','31380','55891','54754','73270',
                          '62537','68912','10375','70988','61328',
                          '33008','27524','91984','60916','60486',
                          '52978','15319','77193','61489','41366',
                          '45955','88295','36789','24738','12181',
                          '74193','67613','93242','33293','42310',
                          '79527','32759','17836','34888','15845',
                          '24962','26629','97373','21996','77608',
                          '79847','67526','79406','93976','45460',
                          '78778','95682','73105','10330','38711',
                          '20053','77842','92818','60538','48365',
                          '88057','95123','69932','83039','63698',
                          '83275','31971','30457','56127','75218',
                          '52857','15091','29073','23486','24120',
                          '14580','98393','54320','64330','43692',
                          '48538','61499','59022','94975','38897',
                          '36695','71933','91708','40849','82849',
                          '51008','86829','28443','57792','56529',
                          '15900','73406','27933','10719','14961',
                          '69178','54379','14342','88847','38167',
                          '55021','78996','34452','18760','56635',
                          '38608','20590','41773','80718','53357',
                          '88157','60360','20159','86715','90097',
                          '48979','16607','94427','98272','14028',
                          '65196','55320','45146','54788','32086',
                          '53970','91936','67877','71555','74031',
                          '60208','13490','71279','29831','12059',
                          '70528','14751','59871','73705','23872',
                          '30129','22555','79793','30444','88489',
                          '49703','17730','67619','25168','42471',
                          '63643','82787','26444','39385','36039',
                          '41085','88175','52975','32135','13637',
                          '90689','77112','34662','29455','78284',
                          '67729','33260','48630','98186','71701',
                          '25571','60211','14356','30214','11361',
                          '24574','42426','10687','34414','45641',
                          '39655','81272','49440','27649','42479',
                          '83318','94415','36383','69247','92216',
                          '61030','51229','80659','52955','80104',
                          '28364','96900','44610','89294','12644',
                          '57650','57835','22645','71782','87516',
                          '41281','98743','88117','42448','94528',
                          '75136','44438','33189','42818','28447',
                          '61097','42060','86453','86357','13267',
                          '81631','95382','73422','18579','94767',
                          '77286','84385','22714','49292','91789',
                          '65088','49538','75421','55363','43166',
                          '12321','42087','39220','30328','75682',
                          '69282','18753','62502','72979','81313',
                          '22510','99551','65834','97414','85106',
                          '99744','68410','63090','49168','88905',
                          '23744','65724','31695','72473','31290',
                          '45531','28541','90068','33204','29653',
                          '33170','33007','54176','91239','21115',
                          '17057','78376','40327','14881','62330',
                          '74733','23737','92895','74201','79294',
                          '10498','23843','15360','29074','70051',
                          '55730','79941','61358','25021','93084',
                          '79044','52903','24902','51428','40974',
                          '47557','80354','14027','97819','90277',
                          '69953','81476','83879','72379','21637',
                          '54070','29832','46651','73929','56385',
                          '96017','46047','54544','38022','70911',
                          '39216','47523','53076','53571','60290',
                          '43065','72051','44416','82254','63841',
                          '21401','17118','25064','53525','55168',
                          '55470','56409','65859','67141','77861',
                          '36604','21045','32420','48328','60298',
                          '66296','64244','44645','75373','38396',
                          '87169','38085','42414','47875','60099',
                          '45865','42093','10160','42508')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '16156','47498','19972','92123','49589','71266',
                          '48510','30782','84871','62580','74349',
                          '99293','18518','51399','46062','24688',
                          '86508','53928','56786','52593','41449',
                          '84671','60320','63452','70976','86853',
                          '93433','60947','19218','19597','68162',
                          '74444','36518','39969','16315','37938',
                          '32888','66610','69568','15363','42795',
                          '69366','19383','94665','78620','68587',
                          '46113','23070','39883','89015','65509',
                          '29655','81234','25913','72449','81544',
                          '23377','62039','77209','19675','75836',
                          '40297','97786','66237','69549','74195',
                          '70298','54105','20991','97839','18130',
                          '34520','40201','15668','19191','80871',
                          '86003','71437','91020','14941','28436',
                          '36572','58625','82755','23105','22767',
                          '83123','29674','92200','28905','10341',
                          '38219','24317','27705','78402','14841',
                          '48446','18334','52467','37775','20514',
                          '41664','50796','30022','29724','84728',
                          '82203','12736','34470','88767','92301',
                          '82771','71291','84300','82251','37291',
                          '72017','75769','61435','15833','66665',
                          '39059','39473','71912','68318','10799',
                          '65947','63409','13578','42177','13779',
                          '90549','78720','15238','90689','18652',
                          '55179','83611','32936','21333','90623',
                          '13208','29308','79461','48204','81407',
                          '55001','82442','72233','35120','81597',
                          '98086','12168','26785','76555','78172',
                          '46697','29322','39383','67141','19546',
                          '24690','30539','40204','50348','94422',
                          '40445','79442','67404','49981','99464',
                          '31272','75061','88755','96750','96950',
                          '21964','39468','20683','99971','89067',
                          '80473','46114','57319','61000','65514',
                          '17219','46633','21298','76196','89794',
                          '53744','51944','13196','63891','31028',
                          '36733','55969','10863','49900','80907',
                          '50270','48092','72200','36257','95865',
                          '68303','11449','13521','56160','56458',
                          '69855','47516','53752','46072','19325',
                          '17264','94061','62390','67167','33894',
                          '80549','43176','87509','60534','92872',
                          '74099','16165','63181','34033','29461',
                          '16506','30052','93766','48689','45424',
                          '40429','65390','21220','59745','73766',
                          '46213','40434','47489','39525','82860',
                          '88225','94570','40907','90444','48088',
                          '98435','38539','43865','58803','97452',
                          '13776','21715','64960','22381','66727',
                          '29542','60862','42141','94661','23542',
                          '34220','79259','52390','51834','38363',
                          '35499','89238','61156','27287','28486',
                          '21178','42695','91413','16489','88411',
                          '63267','15960','62038','29721','92649',
                          '87685','44575','33298','81196','90491',
                          '74301','97698','13654','14164','57147',
                          '96528','53818','36606','88282','65323',
                          '81049','84271','61227','26822','64275',
                          '76930','56119','18174','24269','63941',
                          '61272','47899','47697','54301','64109',
                          '58569','32374','68569','61658','16602',
                          '47855','56415','17460','85242','51464',
                          '62376','13927','51048','75845','16812',
                          '44696','36180','53223','88247','78642',
                          '20378','65127','78255','80071','68902',
                          '25486','80431','30790','14698','23993',
                          '82816','37977','58513','17562','52503',
                          '92947','61303','65450','64029','75933',
                          '71766','79913','81155','96372','77543',
                          '16407','36981','67185','54995','73229',
                          '96925','72090','59735','20897','81286',
                          '75695','37371','58151','58594','11088',
                          '84709','40356','29534','26452','41007',
                          '57022','54434','48393','17599','33438',
                          '39100','72443','51348','80210','50846',
                          '32800','99998','49864','91904','96884',
                          '66455','44535','44013','19110')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2002
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '64907','39091','38480','81237','89019','68065',
                          '13396','27849','14521','76221','39469',
                          '61186','82509','45564','11571','80571',
                          '43243','69225','62187','91084','65003',
                          '75691','49866','66018','25493','32573',
                          '65074','18011','64174','20390','20721',
                          '64596','54593','84060','61895','91617',
                          '42759','75172','35536','35506','43580',
                          '59870','72182','81034','89260','69246',
                          '46691','26067','86250','95566','54499',
                          '71086','95850','53002','51594','36392',
                          '22971','13419','86407','79946','18586',
                          '18072','14680','91321','37442','65127',
                          '26818','76398','70683','61939','76700',
                          '59246','67717','89892','24295','64433',
                          '74679','83777','20484','49763','40146',
                          '70248','28619','30100','40758','47977',
                          '74909','95199','27992','50547','64674',
                          '11578','35504','24587','87053','27971',
                          '21103','66077','94673','48266','69433',
                          '51043','31583','28433','64808','37908',
                          '72564','81550','42263','34589','90089',
                          '60577','70814','62743','70624','54721',
                          '96275','50616','79571','33866','12125',
                          '80466','24207','49053','10187','65290',
                          '70038','12679','60015','85766','64171',
                          '31373','19437','92372','69781','58751',
                          '18435','26469','54442','16009','36257',
                          '75376','81146','58710','55972','51031',
                          '13265','29940','31252','91786','40412',
                          '50092','47694','99719','20253','70618',
                          '75912','35692','53005','94593','18646',
                          '39451','91327','31690','22361','71367',
                          '56885','75005','24027','59493','11959',
                          '39684','88719','24810','90426','27822',
                          '66113','57154','21434','25424','86170',
                          '80879','74888','38679','66193','91028',
                          '82020','27371','70590','81692','47883',
                          '13584','65099','62615','38909','94506',
                          '28160','38886','69111','86659','22088',
                          '83437','54020','17406','64272','15346',
                          '78789','33810','63071','40837','69914',
                          '75096','71226','47066','26442','19966',
                          '53697','40089','19035','67326','83163',
                          '84550','24310','45873','18931','71786',
                          '35853','84905','19464','30202','60737',
                          '86956','42688','77758','30936','21300',
                          '56371','28595','44733','98174','90748',
                          '73759','52309','46565','99095','98093',
                          '29971','86989','60248','94959','53332',
                          '48906','88289','24877','63477','88263',
                          '36492','36716','55419','81069','29734',
                          '80368','35272','48282','57751','30796',
                          '48726','32862','34608','27434','17348',
                          '79383','19818','26536','38579','96453',
                          '28564','24502','72135','39072','10035',
                          '37756','74917','77772','15871','82404',
                          '43268','60743','15360','84611','68855',
                          '23450','32555','11965','39183','35495',
                          '43796','62109','82087','37188','85479',
                          '53591','18541','26565','19752','96684',
                          '14312','79387','71275','92627','36423',
                          '38898','24835','91835','59012','63579',
                          '59404','69130','99155','63700','99296',
                          '70098','14027','55537','43719','43561',
                          '42228','40182','44719','55905','33161',
                          '45754','51013','91723','35589','49786',
                          '80452','59660','44582','53936','70202',
                          '28993','39260','88441','84160','88523',
                          '16186','26529','10445','51406','88550',
                          '54867','26278','37330','76685','75965',
                          '11941','24861','85754','38608','68607',
                          '95243','40816','65885','89908','61842',
                          '63103','65243','51817','66747','82449',
                          '86404','87037','22134','18488','26948',
                          '30185','68213','16952','53730','27775',
                          '47791','44042','50997','90477','74008',
                          '22521','89904','60682','34132','91223',
                          '36145','51305','78772','98623','74138',
                          '72347','69422','18545','78701')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2002
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '54984','22856','43365','95763','89859','78125',
                          '57645','99566','78174','76374','76815',
                          '15910','75179','56982','58346','79896',
                          '67583','46101','75374','28508','97036',
                          '42948','70740','31727','68706','19140',
                          '35395','21449','41941','98429','28490',
                          '61923','92113','77293','74737','15160',
                          '92314','30959','88739','87446','40991',
                          '29260','82246','10721','55678','85592',
                          '70791','43749','98520','89936','41632',
                          '58660','82947','20361','32367','92365',
                          '25229','92948','49773','47479','68640',
                          '91974','40953','54344','76255','59216',
                          '41696','65624','62104','22531','64926',
                          '56692','50119','33671','29887','31226',
                          '47545','78228','46313','15542','36800',
                          '74155','11719','49226','92007','47496',
                          '55677','26636','10005','15753','47146',
                          '56730','94958','77952','93835','31849',
                          '93259','44515','67410','94202','89718',
                          '36438','61059','21624','18741','27465',
                          '22237','21882','56819','10106','75645',
                          '80032','99938','56067','46815','65064',
                          '32507','90312','45760','94598','69371',
                          '71302','41536','18196','47748','96168',
                          '81031','74682','36462','95614','89809',
                          '96728','87716','56079','97582','38706',
                          '95581','48416','38598','47255','26842',
                          '98851','82870','14155','91009','76627',
                          '79925','56755','26310','91515','62739',
                          '79229','88564','85281','17677','38331',
                          '49771','47959','44478','35850','79487',
                          '80207','13264','80468','67069','39783',
                          '16224','63233','95213','59201','44676',
                          '66328','16086','59190','35539','74315',
                          '54636','16763','70921','29201','50974',
                          '29056','26863','76963','87062','75663',
                          '54914','21298','48085','89648','52797',
                          '42253','98455','54643','85052','16174',
                          '72066','45519','40685','25096','10033',
                          '67424','59829','51506','82910','73678',
                          '80524','47679','58149','19620','21048',
                          '15116','17700','34796','31023','73446',
                          '36601','23763','35232','17546','29440',
                          '90713','24628','54876','98392','28658',
                          '86575','38425','74183','64558','47439',
                          '32065','54511','24083','17408','70973',
                          '44387','34527','22664','85994','94924',
                          '78132','64150','71770','29752','63646',
                          '61892','54931','19914','72029','70655',
                          '98875','84801','98319','60064','63811',
                          '51301','78283','84186','52436','13587',
                          '94200','51340','48658','46336','98252',
                          '92940','17059','87976','62238','88199',
                          '49115','20148','42423','84648','33775',
                          '35990','48688','96828','32491','53559',
                          '89536','78475','60005','77646','98084',
                          '94818','65683','60194','55038','16854',
                          '96131','55865','73850','33065','16724',
                          '78739','95768','79816','78482','64281',
                          '95084','46322','58406','62305','97209',
                          '88385','80653','62910','68046','36283',
                          '40632','37074','46946','81454','33784',
                          '41385','11332','58132','86975','51043',
                          '38244','62033','53841','13450','60761',
                          '58857','10454','73975','62434','44877',
                          '47248','29000','59976','49683','86926',
                          '24664','12625','62084','38513','48787',
                          '22852','35568','96380','47565','19010',
                          '73412','12744','50139','17418','40052',
                          '28926','30269','28097','30527','92887',
                          '67700','94895','81057','57408','40820',
                          '58417','95350','19422','90938','49603',
                          '45704','44611','58518','43902','85546',
                          '55318','71395','82015','59682','80516',
                          '70138','12208','80344','91699','81804',
                          '47671','56597','21300','13063','24079',
                          '46823','60133','69146','49245','34927',
                          '89274','14528','29281','36421','97360',
                          '58912','92132','24370','50962')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '45676','52049','62522','51809','19394','35960',
                          '17104','42677','65485','70759','57827',
                          '26722','99872','72309','77071','78075',
                          '82005','47911','99546','69490','85723',
                          '41804','45883','60538','56312','42048',
                          '96378','41165','60073','92889','18528',
                          '29252','27040','34886','85131','92505',
                          '94469','44718','91492','54961','53409',
                          '38539','69818','32757','48075','67125',
                          '24425','72941','43688','39285','46951',
                          '84890','57810','14195','84507','88548',
                          '38503','95281','45135','32219','37813',
                          '69544','11360','76271','47006','17913',
                          '20643','89606','86628','20660','83731',
                          '33170','87342','45761','58309','23720',
                          '42324','97794','86819','78266','86657',
                          '77695','35044','58599','61368','62903',
                          '46074','51943','55938','28028','46237',
                          '93855','53807','48780','70247','44898',
                          '75283','15953','27168','58031','57568',
                          '34010','99576','98282','37585','31873',
                          '20299','48013','39221','51651','72353',
                          '54039','55865','80821','30308','18085',
                          '83602','19859','91239','62673','40385',
                          '37084','74541','74909','55397','80826',
                          '32978','37406','68471','93252','97083',
                          '83522','39817','14435','26433','37689',
                          '63316','50435','85466','38273','74062',
                          '26896','20864','61691','20866','66795',
                          '85946','26191','33663','66121','64781',
                          '78576','97998','51219','79779','67951',
                          '12338','66737','89121','15892','15408',
                          '41921','81225','33374','55287','98521',
                          '41700','14619','52659','71593','52915',
                          '97768','59568','39656','34696','67317',
                          '61873','97988','88293','83453','86866',
                          '19905','18417','40059','34239','22772',
                          '28495','20700','70784','41822','93160',
                          '98407','82980','64173','59249','43434',
                          '37777','39363','17689','37151','95365',
                          '30605','45748','56982','25131','42847',
                          '82660','76717','69552','75428','61376',
                          '44884','30862','31485','70310','50769',
                          '41189','80417','59875','63778','69485',
                          '22915','25416','54226','24034','89535',
                          '93935','54096','43583','72773','52918',
                          '68804','66421','34674','61387','17808',
                          '89622','21067','84748','88977','97775',
                          '93248','97167','59494','59085','84870',
                          '41088','93214','16785','50018','45119',
                          '27358','42443','14674','91969','44271',
                          '57356','86935','53348','68297','54161',
                          '56774','66326','16302','93143','46006',
                          '95739','46197','78265','98599','11573',
                          '88744','74565','67837','96204','13807',
                          '26570','59122','96275','12375','77425',
                          '84881','91796','94150','11871','73929',
                          '80090','48464','98518','45680','28188',
                          '77803','51431','66207','83828','79809',
                          '77155','75596','94471','15392','65571',
                          '21922','18198','46354','12366','44819',
                          '61392','82225','12346','17079','64812',
                          '59158','87178','71677','31407','17897',
                          '76911','60776','21439','20044','48326',
                          '90671','66015','85830','93894','21669',
                          '76210','55408','73790','35015','46223',
                          '43721','90495','76327','80700','35573',
                          '56107','24805','13433','90591','36264',
                          '93995','57500','35738','57162','69615',
                          '51173','80729','96376','52908','38691',
                          '36436','15878','50279','74018','44737',
                          '48069','38321','41364','40428','40521',
                          '10487','70533','37478','77195','93405',
                          '77724','76391','89298','23865','37303',
                          '92179','93659','10438','83537','25111',
                          '38366','41438','73907','63062','52856',
                          '16199','12914','46608','91956','39618',
                          '46760','79108','15258','70958','97046',
                          '89835','47377','80153','72607','12204',
                          '90628','88489','72531','20394')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '33606','58456','84381','21713','27568','45415',
                          '88294','55237','44840','30792','59729',
                          '85112','87534','17584','19690','77881',
                          '65728','81856','95452','45112','96579',
                          '23190','60223','99399','11813','30623',
                          '59432','43772','41639','78060','77342',
                          '41011','18284','48084','46330','57434',
                          '47660','66644','74927','41434','98298',
                          '45598','64677','53691','35038','34121',
                          '26031','10323','87786','97347','95935',
                          '62748','72743','32858','20610','20308',
                          '33532','86423','90539','88544','24810',
                          '36220','56361','61251','55035','69327',
                          '33089','76258','79167','34245','39266',
                          '93780','17146','54589','13365','63972',
                          '48456','53272','33977','21261','91864',
                          '40190','55347','48764','38423','58225',
                          '90940','63037','20452','47454','63778',
                          '82572','49242','41913','97309','48455',
                          '69306','26421','82095','57504','97026',
                          '64877','47023','76520','89841','22886',
                          '87412','28973','36324','52658','64301',
                          '27694','96306','59243','96665','35678',
                          '19841','58182','45851','98619','68939',
                          '62982','23273','13391','90702','18275',
                          '85573','84829','46483','84794','30970',
                          '61518','25710','13784','93329','93897',
                          '20361','22548','74343','69658','34915',
                          '58682','36701','67899','84067','21476',
                          '49112','37881','76143','94922','30549',
                          '93006','40620','92225','98598','83451',
                          '78626','32193','32456','30845','89555',
                          '46990','24332','82649','96778','46459',
                          '33815','84871','47340','10889','21490',
                          '28524','88258','71695','34818','70953',
                          '69259','69124','94055','10190','69735',
                          '20130','70542','39108','38820','48712',
                          '56270','67867','75332','92907','17373',
                          '76012','73674','89193','97059','78776',
                          '46935','29594','38702','48168','68856',
                          '36737','43500','97677','42629','89583',
                          '57761','27863','30655','21122','37512',
                          '29391','83164','82118','66126','92383',
                          '18389','12504','93758','87649','41666',
                          '66443','15838','62556','54666','14585',
                          '18395','22653','48745','46972','10945',
                          '60511','83120','57480','49210','90888',
                          '19743','80517','77594','19069','80483',
                          '91687','57134','88371','35805','20972',
                          '62328','76975','49989','54513','93101',
                          '28336','47258','46054','52266','34937',
                          '32475','61970','97579','98463','32595',
                          '90376','89093','28273','69796','87499',
                          '34670','69610','46619','95698','67389',
                          '48330','86702','89033','80227','82412',
                          '20937','79431','63297','90975','62640',
                          '19235','84749','46492','48562','21382',
                          '27505','68723','38168','72490','43325',
                          '34607','84171','44370','39645','38803',
                          '64771','40797','88062','72937','61139',
                          '99325','56750','44307','53499','55211',
                          '64124','25916','87003','34192','59809',
                          '77429','11124','10202','82166','48600',
                          '76367','57253','70627','42092','27175',
                          '57900','82906','39434','11474','89138',
                          '49101','64538','55073','77861','53353',
                          '58957','48334','30160','97665','93308',
                          '21934','28976','66170','94292','69977',
                          '95665','86601','85572','99674','79598',
                          '31446','60561','59497','59899','15426',
                          '19855','12281','58170','21887','60676',
                          '39633','22764','99427','44099','23703',
                          '63746','33273','49045','33922','64498',
                          '29983','29906','69849','28384','92976',
                          '58806','43000','62924','88547','63173',
                          '49448','81139','92954','80554','51762',
                          '80506','61661','51498','23954','71020',
                          '25013','55623','45445','28124','25707',
                          '79064','40835','43469','11701','84735',
                          '73560','31528','81735','99139')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '35324','96809','60095','11523','76088','60621',
                          '67354','27688','54765','25785','58417',
                          '52814','99369','75186','77939','67191',
                          '63426','23494','57362','99855','50148',
                          '84016','47613','86336','86366','14976',
                          '66027','95313','14074','68318','17495',
                          '30868','10247','75498','12360','71203',
                          '21343','81827','40886','60392','23641',
                          '34306','81913','68164','69449','57443',
                          '91994','33772','25271','18092','47658',
                          '73937','78638','19700','82510','93126',
                          '69539','10688','42539','82291','55744',
                          '29026','87995','20215','15196','30815',
                          '45865','13976','84864','64364','23181',
                          '60357','48758','54028','68478','79569',
                          '32643','12572','24983','20051','98018',
                          '86986','19007','74055','85090','70611',
                          '40919','12724','99911','61106','88975',
                          '62051','41232','21704','19127','33602',
                          '33834','37472','32097','79202','22722',
                          '16992','98861','22627','90903','27003',
                          '70289','94285','74148','76887','31672',
                          '78162','16171','87431','93648','78115',
                          '22165','88056','99278','55562','96364',
                          '92388','53342','53720','43396','77753',
                          '90034','18004','31075','69554','53150',
                          '79031','43905','34761','64164','77880',
                          '87751','28300','68743','79081','11340',
                          '72486','66411','50853','70661','71752',
                          '73908','10417','44696','61301','20168',
                          '89783','21717','25250','39120','31734',
                          '34665','94192','44912','73516','91438',
                          '42737','87011','88554','33501','57401',
                          '51864','27715','39674','37371','58208',
                          '22872','33545','42825','33837','20908',
                          '70222','35846','95721','78531','55102',
                          '53470','37755','92028','98208','69502',
                          '60507','66095','35555','39319','75048',
                          '66896','58657','88424','84025','61654',
                          '24930','96735','76114','13032','96971',
                          '85270','82829','79111','29400','72857',
                          '84107','32465','55902','62327','32584',
                          '21866','89323','58386','46301','49105',
                          '92595','77156','55568','21596','38479',
                          '74531','89380','53587','52481','94360',
                          '51598','34259','41223','54010','54722',
                          '70736','94567','32611','25912','90371',
                          '62911','80116','62571','89147','83314',
                          '88690','51811','93554','18296','52915',
                          '25670','74552','88803','85582','95390',
                          '31770','15294','24003','61892','73364',
                          '32618','65671','86277','31930','81043',
                          '39038','23319','56106','57736','50296',
                          '80692','56446','76245','16272','83649',
                          '77598','59672','30993','23903','78270',
                          '64246','15994','29130','23907','65926',
                          '42400','99694','42733','77374','53162',
                          '76484','57770','66894','48002','14108',
                          '20300','63976','75197','23264','44126',
                          '77080','18769','83814','77410','74313',
                          '34885','69260','25454','26819','42231',
                          '16669','14110','96811','27047','69999',
                          '58344','24773','43523','55741','90362',
                          '55471','49500','40259','18506','13402',
                          '65540','58362','14042','71283','40526',
                          '70640','58125','24310','92823','63487',
                          '64766','52386','43420','78756','23029',
                          '12850','11123','23353','20268','78972',
                          '19085','38749','38142','72527','79494',
                          '25875','33219','93495','28821','91218',
                          '26507','31917','41926','27593','76650',
                          '74137','62713','87477','85948','39040',
                          '67525','40750','71286','64944','72039',
                          '82106','71375','43078','34562','11478',
                          '55184','82125','56135','79134','81741',
                          '85902','25361','25282','74306','74926',
                          '72937','25162','90452','61871','53866',
                          '12825','30261','48720','64974','95890',
                          '37530','11399','52635','48979','42900',
                          '33850','96825','86573','93773')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '56833','75490','86341','68716','96869','41346',
                          '53792','65924','27182','61384','84950',
                          '32338','28351','15206','91476','90423',
                          '75667','12119','25177','10062','51076',
                          '68936','58010','57265','27205','79906',
                          '70610','43273','72733','10712','14647',
                          '55510','89530','81965','38490','71837',
                          '41148','38914','88191','93662','64944',
                          '81479','44837','14461','67471','78791',
                          '67861','62988','28327','20949','24670',
                          '75729','48756','67647','59419','26108',
                          '68439','54644','74562','72241','54176',
                          '80684','59206','50446','50514','33837',
                          '60678','92956','12236','87521','48550',
                          '23946','70630','38393','76885','63569',
                          '97978','55513','17406','19306','40069',
                          '41331','46764','91906','64972','70736',
                          '90460','18215','80776','28365','14643',
                          '62246','89080','82802','41064','25385',
                          '74882','23876','33043','12969','68224',
                          '84354','38531','62467','33609','26152',
                          '91726','54742','50513','41269','73271',
                          '44512','53483','15534','86997','40418',
                          '30617','42442','74672','35996','77554',
                          '67030','46011','64450','69902','42527',
                          '37164','47692','25438','36219','41868',
                          '61305','29525','37358','69914','76930',
                          '38445','61170','99029','21254','58269',
                          '46162','94508','30835','28761','31914',
                          '44848','53906','26561','24162','69435',
                          '93907','72080','63910','73899','92498',
                          '45455','64707','54136','22876','85834',
                          '90394','24593','99185','99999','32144',
                          '43206','31261','57255','29911','35562',
                          '49401','27620','28508','17807','98223',
                          '49594','76157','47956','64936','40738',
                          '98863','19494','27014','21394','12309',
                          '85005','81509','29066','80464','74410',
                          '17630','87727','33439','23001','42798',
                          '93816','89434','43737','27190','58323',
                          '66034','22899','79614','49527','11408',
                          '53194','81199','85606','46543','19477',
                          '43427','13293','31202','19377','61485',
                          '21873','17938','12714','19539','72865',
                          '93847','57631','64327','10641','35495',
                          '92660','28277','44236','39376','34823',
                          '71027','80830','66089','51853','58304',
                          '41599','68514','58429','83541','99651',
                          '85465','52039','76991','57292','36813',
                          '52204','25209','39203','56359','90795',
                          '51867','35574','51015','40497','71908',
                          '95013','50829','86987','13637','17730',
                          '63296','85760','57122','53134','23995',
                          '98794','88631','64319','96246','92324',
                          '97037','13537','74123','70800','42787',
                          '10991','56115','85072','15314','13563',
                          '83611','44549','67364','32553','54876',
                          '56607','12662','38219','32906','21721',
                          '57033','62274','48341','23863','12247',
                          '87992','28466','37184','45308','46548',
                          '13837','14321','26661','47217','26275',
                          '31737','43390','21132','58217','25275',
                          '31467','82891','95959','30406','59019',
                          '54615','67047','81956','76887','47794',
                          '42033','18533','39308','69707','60715',
                          '91690','74643','98701','79887','61610',
                          '66722','86471','64381','51591','65918',
                          '69444','67965','58629','95661','29100',
                          '78948','20134','71615','69038','18230',
                          '23410','75286','50641','50347','68061',
                          '44678','68330','10429','21909','82377',
                          '23544','38910','89709','33779','79078',
                          '83372','77477','81997','20268','98163',
                          '97395','95628','36047','20791','96509',
                          '26968','37217','55278','78695','88108',
                          '68444','91849','11417','63737','89444',
                          '26483','41704','98913','59061','64245',
                          '14117','96036','13009','54827','57601',
                          '91277','22702','72637','71738','41574',
                          '43009','85930','76878','34507')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2002
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '19383','39158','46060','40191','84741','22938',
                          '62134','56062','99078','40544','42741',
                          '43827','19095','95421','14023','95474',
                          '17563','79833','64073','85779','95075',
                          '44720','92664','93517','62653','15376',
                          '95868','76448','43656','38116','98480',
                          '70935','81977','18325','59899','98469',
                          '73455','69943','85061','95803','32865',
                          '27644','63802','85178','96135','61769',
                          '13486','63335','43905','26044','97184',
                          '49581','77342','93650','13449','37105',
                          '40553','20851','14087','14162','36612',
                          '28520','99056','13256','76507','76548',
                          '25970','66182','84001','73202','15331',
                          '28726','54459','56352','16971','70471',
                          '75008','23417','38675','76061','95655',
                          '72981','47352','80191','45707','86142',
                          '47482','15736','86380','39023','70349',
                          '51695','86758','66497','59402','36645',
                          '54980','45636','40121','50610','75076',
                          '35098','98613','61686','49279','56481',
                          '98821','19057','99661','68367','30824',
                          '37492','93598','22130','24808','75352',
                          '28364','49965','78630','32407','97934',
                          '88492','28750','57507','72080','81077',
                          '96572','27866','69144','31863','32942',
                          '74966','29794','55725','35228','98068',
                          '75212','63236','13913','60437','93509',
                          '89817','98592','25156','74753','36630',
                          '96751','89288','13380','31304','68405',
                          '23720','63326','36611','93719','61630',
                          '66371','41303','15994','40968','53949',
                          '73900','81428','11316','19835','38934',
                          '76559','25775','66340','98333','77183',
                          '73830','54979','80911','61271','71403',
                          '68319','42603','82866','57888','35779',
                          '77304','31541','89868','76211','38716',
                          '87613','64470','92744','59794','47479',
                          '60195','49351','48623','21112','21337',
                          '10401','89268','96288','16303','70917',
                          '62053','97921','75213','34759','54089',
                          '88771','36094','36118','93849','10944',
                          '89102','66813','28443','75656','62139',
                          '85327','96717','57102','59156','97949',
                          '29664','42372','62951','33266','55974',
                          '82186','60117','38034','84914','94371',
                          '45473','96243','20059','66493','15328',
                          '24018','45629','87995','93209','56882',
                          '49723','18725','16660','46193','30111',
                          '11814','98335','97655','57457','20412',
                          '20706','10247','45783','73277','61746',
                          '39641','16573','81293','17900','27212',
                          '76706','57243','81493','62896','26385',
                          '47943','82895','93331','37401','66524',
                          '35282','77193','18670','50083','23221',
                          '61513','20464','55634','57793','87974',
                          '78636','34803','32783','25148','35903',
                          '60182','48715','17562','23237','71179',
                          '55753','70866','78936','20297','21667',
                          '41808','68931','80370','54441','85545',
                          '94343','92116','87328','60205','88553',
                          '19916','64230','79916','45954','40900',
                          '76435','30307','99453','83515','56242',
                          '39751','92456','41847','56431','82297',
                          '57248','19239','46612','96931','47486',
                          '42897','32825','25091','79201','87601',
                          '18296','17075','81481','91174','35657',
                          '42207','75667','48432','12476','15805',
                          '84026','12955','46195','33463','33482',
                          '23293','21547','42590','37810','48111',
                          '36113','87970','25561','97036','40998',
                          '77945','49343','31008','82913','11328',
                          '11096','31110','50311','60925','36037',
                          '37221','25011','18050','53403','59029',
                          '17555','20835','41434','49384','44399',
                          '46639','27265','29034','99931','91799',
                          '12528','89221','90861','66669','80777',
                          '69692','35326','20512','41911','63589',
                          '65245','45163','85264','90411','89373',
                          '71210','18658','83743','10538')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '48950','31600','68819','73764','59985','72936',
                          '51991','77472','92260','21181','81647',
                          '93995','71283','71889','80430','17778',
                          '44551','59947','71138','30979','22942',
                          '81400','26089','74690','79248','99521',
                          '75131','16074','45373','65872','18680',
                          '78738','19633','13672','69524','53161',
                          '75731','40963','63921','33304','30186',
                          '32794','67848','29854','34200','70693',
                          '74257','45057','98910','74471','60951',
                          '94280','86825','87314','16482','72994',
                          '81685','41068','55909','79162','60352',
                          '89608','52499','98507','35605','50129',
                          '23066','26076','86542','20227','26112',
                          '91327','29135','70324','69934','88150',
                          '94279','33003','89098','91180','76748',
                          '87199','93457','32845','20791','93546',
                          '32017','74074','43014','80292','81329',
                          '70448','87321','90763','74567','49948',
                          '16974','44217','86675','87754','90919',
                          '28760','97681','87114','10459','78833',
                          '84359','23909','91787','84740','78665',
                          '84200','19533','45265','89490','92512',
                          '17086','13055','95920','51737','43475',
                          '73959','62033','93835','63777','86848',
                          '93586','17231','98963','52873','52471',
                          '98215','96025','56992','92827','29053',
                          '44431','72867','10496','63700','67429',
                          '47533','49254','15893','74462','73713',
                          '76312','25488','16599','51932','22776',
                          '71519','68512','34398','61703','56697',
                          '22459','19632','68153','19031','56218',
                          '77885','84110','96472','55349','39960',
                          '72004','63394','67182','58398','54386',
                          '28195','87370','10029','24166','41399',
                          '76650','11873','95808','21105','46406',
                          '11740','42705','51333','73266','65714',
                          '77259','84663','19555','59642','15112',
                          '38556','33393','63164','43383','89342',
                          '74794','39798','20831','51890','60135',
                          '14645','84476','36971','56420','39519',
                          '96626','35062','94125','83625','94795',
                          '84791','44575','57863','12227','42470',
                          '48897','40821','72420','96382','49410',
                          '88546','22450','95782','54291','29379',
                          '46739','82996','89714','21777','29105',
                          '57860','32888','70342','51324','49192',
                          '56179','85062','94208','67004','77553',
                          '95215','16137','21771','81206','36817',
                          '93327','15902','67550','93997','11539',
                          '76538','67719','99485','76927','53652',
                          '96152','41748','91476','45930','13810',
                          '41115','48848','11160','33302','26204',
                          '77938','78594','16337','70779','39651',
                          '68767','96047','39958','53320','50359',
                          '25131','29981','87878','97450','84616',
                          '61076','22421','91750','56399','62720',
                          '63436','13552','86798','24177','92900',
                          '60297','86237','41252','34323','34455',
                          '64058','17042','25690','92398','85625',
                          '16047','56735','91087','46517','66240',
                          '38651','10038','30714','45672','13601',
                          '23683','77200','87860','95151','36348',
                          '43219','29558','40030','68236','59766',
                          '75130','18043','69571','40794','89648',
                          '46427','44771','85987','37272','29168',
                          '59540','78625','37463','60553','12598',
                          '97543','47652','32500','13338','30506',
                          '36706','81708','41836','24897','55338',
                          '78563','36305','80012','55428','33695',
                          '18356','54095','64366','72443','64657',
                          '62078','27138','58023','16890','18595',
                          '99506','43566','51406','87965','42965',
                          '99446','72799','66499','29285','36716',
                          '48272','74650','23270','38983','13649',
                          '77883','19934','29836','79140','13946',
                          '29162','89530','30358','83169','67161',
                          '14143','27206','66578','34043','56264',
                          '12936','93985','95568','44637','37817',
                          '50348','87605','43773','44097')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '53004','69635','38699','24494','16270','39381',
                          '78480','20182','13980','67862','24782',
                          '42614','88868','32984','72189','96785',
                          '82078','52940','30274','90581','90892',
                          '15582','90896','77041','87411','43842',
                          '43826','15222','70314','67823','69220',
                          '59992','56006','29260','11105','81279',
                          '30714','83549','38768','92460','44894',
                          '18214','76553','94138','94027','51123',
                          '25129','37697','95741','42233','26926',
                          '14397','27923','46428','84370','89006',
                          '54139','89062','51522','71511','26708',
                          '32254','53637','40983','14212','35404',
                          '45458','70065','55471','55863','94848',
                          '90413','87573','38781','51037','66542',
                          '94690','33779','85260','20300','54965',
                          '90058','21344','55930','30691','48546',
                          '64397','17089','51268','33130','80824',
                          '48490','92347','13990','10497','53544',
                          '63374','66255','29804','87526','75211',
                          '67994','14167','82591','39680','38243',
                          '13956','24875','91187','43126','66873',
                          '80593','76760','98915','16346','45393',
                          '60178','84838','97674','79771','87011',
                          '29240','28188','48629','96244','82332',
                          '40735','25293','35904','75442','16760',
                          '27405','68759','21156','68656','36260',
                          '28304','36283','20522','87349','58868',
                          '30088','96988','22723','12126','15374',
                          '98620','59041','11606','91733','62836',
                          '22490','80083','64168','84881','75069',
                          '15855','95300','54802','16020','44580',
                          '50383','87679','32696','20371','33489',
                          '88605','71438','65121','58100','66095',
                          '99802','22883','60389','76329','61183',
                          '14322','78898','88146','85579','96623',
                          '69973','78046','33967','45433','72095',
                          '81063','92137','63102','72683','94938',
                          '81084','80705','49323','60892','57748',
                          '47020','33511','64141','63379','53874',
                          '21413','37840','67883','85738','46359',
                          '26459','86524','28727','90479','84520',
                          '34472','39213','12796','80314','70719',
                          '19694','74544','77385','38744','39036',
                          '27209','54933','80811','79361','53962',
                          '36071','54350','56131','19949','63575',
                          '43600','80078','56574','81185','65735',
                          '58482','87684','18748','25797','65584',
                          '89211','11729','49897','60018','74788',
                          '41395','31050','60419','59974','95784',
                          '83685','79413','41228','72785','64739',
                          '93044','38229','71099','33608','62333',
                          '73658','37748','67345','57293','75988',
                          '57333','31300','65399','70313','48209',
                          '95828','98512','28376','35767','27839',
                          '91815','51845','40527','59063','29217',
                          '39487','20043','35170','39401','66668',
                          '93331','19711','87382','25496','74938',
                          '50301','83388','75006','72107','86931',
                          '23083','89993','72214','89455','96956',
                          '67977','65402','68963','80077','73402',
                          '37274','61044','95037','35867','86727',
                          '20356','41222','83410','87749','78737',
                          '77501','45233','47384','45278','61420',
                          '54926','38154','88574','47715','24511',
                          '61881','39235','16137','28124','19660',
                          '58298','49933','70031','55129','19356',
                          '73780','94512','93382','75833','88604',
                          '89477','43329','52118','71778','14622',
                          '61103','39343','69756','67089','38319',
                          '69336','52056','56640','34204','52090',
                          '15100','79530','84740','54112','58171',
                          '96979','85576','62451','81332','34710',
                          '78689','52853','20262','36607','19155',
                          '54379','61104','48724','92718','97731',
                          '38795','23148','20165','40576','18021',
                          '19922','57255','53558','49916','96358',
                          '95529','42112','53272','76043','53175',
                          '11442','27929','98273','46693','63310',
                          '95017','86859','33768','56821')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2002
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '88053','64716','91272','65707','75106','15225',
                          '49875','99293','80284','41035','57467',
                          '71867','33369','13605','40964','56671',
                          '30702','21599','28082','87565','73608',
                          '56317','52623','94222','96392','14956',
                          '49235','37367','34063','77618','78671',
                          '88668','29713','30018','51333','92469',
                          '53371','72706','34538','80828','24921',
                          '80532','32210','30203','43594','38859',
                          '80018','56112','46416','65264','54423',
                          '98459','44504','72105','88844','46484',
                          '39743','37040','18589','65679','58979',
                          '58268','77970','33779','77744','42366',
                          '21390','20241','98645','39275','23128',
                          '68948','56303','10222','32794','38494',
                          '99701','64660','23824','14302','99745',
                          '61508','55259','75830','41052','69231',
                          '61556','71036','33472','19866','59620',
                          '87096','69873','14904','88550','59976',
                          '60096','67849','84568','84711','87205',
                          '77287','51151','11082','42399','66976',
                          '79884','23138','38310','68738','54602',
                          '65514','65167','48519','50008','93637',
                          '35580','55243','87930','12491','86150',
                          '56354','10074','98079','75528','87300',
                          '43092','74370','37060','85109','87063',
                          '42224','15285','61698','12292','84261',
                          '84087','11844','97449','98598','37998',
                          '64686','47857','52973','68406','88829',
                          '10797','50971','17837','50806','22877',
                          '56820','31910','52131','63710','81104',
                          '51377','67844','73606','11389','52194',
                          '26290','34045','51276','28926','95930',
                          '94007','52559','43090','74012','66683',
                          '69762','76968','23008','43437','16119',
                          '96910','52886','45850','99244','39818',
                          '68971','41279','91916','93285','22284',
                          '46220','50480','62538','94179','51265',
                          '56490','78805','15661','33247','60951',
                          '41480','28655','27238','19002','83104',
                          '86643','14603','10506','71753','19771',
                          '25984','20598','19453','68267','39392',
                          '24479','98383','93240','93582','40668',
                          '80962','93429','49377','71025','69970',
                          '73113','95837','58330','18494','76472',
                          '25669','17252','12325','32750','60586',
                          '48809','11127','54143','50908','21133',
                          '49878','77775','72808','53532','20206',
                          '80070','63485','82108','35687','85373',
                          '71473','34121','72068','93766','95429',
                          '28151','51044','28473','88766','64927',
                          '23844','14676','74707','72231','84031',
                          '59956','95835','44833','15653','52411',
                          '90831','29223','70783','83558','29769',
                          '36043','98917','96967','25015','78156',
                          '20691','16403','96060','67769','51524',
                          '63458','52591','32972','85174','94105',
                          '47224','65770','79352','82693','52110',
                          '10677','65417','48191','88647','25101',
                          '30113','89682','47729','96992','95988',
                          '40545','86680','47335','93538','67408',
                          '93337','53999','23198','54985','47148',
                          '35815','11938','87493','91573','15318',
                          '71828','24199','34010','48635','66013',
                          '63397','94216','44931','55975','83085',
                          '41357','43114','53504','98373','22698',
                          '55117','55038','64313','88468','84203',
                          '55231','63738','99896','85721','55606',
                          '80249','76820','10317','14409','66947',
                          '24992','49757','19324','16324','78303',
                          '74720','72749','93600','84357','60645',
                          '19094','58773','80367','96633','81492',
                          '58887','43835','60936','12181','36497',
                          '80241','25370','29159','50164','76825',
                          '78529','75668','47418','74535','36593',
                          '59577','31815','66345','74717','17151',
                          '88527','88334','81994','44906','65287',
                          '88244','97509','75678','67952','38134',
                          '61647','43333','26762','21352','94392',
                          '74863','67724','33541','13244')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '23039','10419','69883','36482','16085','95410',
                          '78190','97223','79137','23643','13668',
                          '33465','15032','99942','50999','96690',
                          '19191','31486','80190','98979','49447',
                          '52116','49208','69048','37957','26311',
                          '64429','44072','75381','75243','90800',
                          '68836','14897','28937','55027','96852',
                          '58646','52268','52976','93700','78341',
                          '48131','35157','62708','29154','23906',
                          '83816','51823','74685','40735','23422',
                          '54350','36003','55315','32568','37941',
                          '57748','42046','83511','39424','69602',
                          '25854','60492','62951','28510','19052',
                          '43583','16950','96891','75296','23842',
                          '58424','75798','34617','92605','18843',
                          '55075','65348','63513','50191','55093',
                          '90966','32239','46661','88748','81887',
                          '75985','79708','53225','60384','12541',
                          '64057','41906','89793','24780','33653',
                          '38016','91689','33067','51298','11605',
                          '77638','94062','64642','42217','22957',
                          '48710','68809','49077','22818','37237',
                          '64241','45987','56981','81600','15489',
                          '58249','42811','65235','82787','94707',
                          '90345','77126','92912','69544','37415',
                          '73801','46200','70579','97927','92892',
                          '47814','77282','38182','43621','84719',
                          '38649','35027','93622','68326','51207',
                          '69060','54957','68927','20246','38205',
                          '36560','20535','20546','18392','43303',
                          '94354','34318','17534','40614','17256',
                          '52432','88184','88165','27704','71885',
                          '12673','55362','33467','29413','60121',
                          '20716','80392','34094','31957','52828',
                          '90952','28705','78035','17670','81808',
                          '53190','82940','85078','52834','63990',
                          '97413','21690','74546','82048','49189',
                          '49905','14187','14746','75424','29637',
                          '60730','97964','51339','13730','62969',
                          '92414','28066','23283','39187','64568',
                          '53198','14005','66838','58776','80534',
                          '54829','63814','68645','84584','61727',
                          '58090','42344','89905','61260','25383',
                          '47701','52990','97860','58075','64571',
                          '63823','84570','16043','96016','17565',
                          '20910','14619','92207','79013','63496',
                          '97753','34722','78072','60995','61244',
                          '71717','86501','54496','80620','42751',
                          '28127','61128','71757','50983','89018',
                          '49218','33208','74490','25864','61659',
                          '65162','67313','32220','97640','46106',
                          '26507','33919','78894','67221','43683',
                          '52696','40092','67169','11288','97864',
                          '81780','52167','20307','45661','54428',
                          '49598','34583','94862','28323','90656',
                          '10923','54354','43695','47285','86758',
                          '69100','87846','55781','39957','11950',
                          '46618','33837','55993','37927','99193',
                          '45851','81341','61799','73938','87248',
                          '78534','67699','41331','13490','83024',
                          '39397','25348','23639','68120','54490',
                          '47140','28582','45642','99461','23591',
                          '89085','36177','92019','90899','92079',
                          '21005','60647','19808','31915','48866',
                          '82500','16332','96804','63599','33199',
                          '51528','28051','94335','48891','81605',
                          '53974','88840','98650','66675','29477',
                          '99842','79004','72568','37810','13715',
                          '94452','19795','60932','54156','26494',
                          '88698','97305','80799','29629','89109',
                          '40978','44526','53199','60566','18129',
                          '21682','11488','75650','83760','13681',
                          '18183','99990','34162','18646','10129',
                          '92209','78217','70503','49796','87078',
                          '10981','54546','71125','94523','85721',
                          '79757','72375','60230','27379','66533',
                          '32646','65479','95607','73535','25308',
                          '84406','43665','94820','11091','85545',
                          '41112','87886','68141','42163','99318',
                          '42674','78223','42402','67809')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '22888','98101','84089','70677','22407','94070',
                          '20977','76393','74710','82097','79596',
                          '71734','59103','52019','51156','82036',
                          '49122','44077','18542','79396','48569',
                          '66015','79406','83911','66118','89249',
                          '71824','84242','91412','31408','74929',
                          '72390','37809','83015','15801','59034',
                          '92898','38713','54597','82243','26401',
                          '84565','39917','45371','23351','70724',
                          '23836','60612','61260','27692','34923',
                          '97153','56819','13500','67946','34319',
                          '81672','94299','83843','59133','16266',
                          '89661','28984','49789','21547','73148',
                          '49130','70016','13561','62777','69253',
                          '53269','24395','81639','21018','67414',
                          '84966','35947','17143','88357','93594',
                          '87689','26385','38584','86013','20781',
                          '49436','63260','54613','71966','59509',
                          '74880','99959','53592','19351','53336',
                          '40592','94683','33750','78224','16861',
                          '81617','28255','22999','88126','66494',
                          '30692','11734','97950','62929','32743',
                          '45310','83963','20853','79014','84393',
                          '66506','58923','66390','70527','92316',
                          '94650','54524','91455','53598','46905',
                          '63966','84457','41244','65312','80460',
                          '40725','85152','18917','79810','73807',
                          '20268','42266','84349','29802','34048',
                          '65159','96995','47726','11646','21691',
                          '50625','69660','19488','49277','52779',
                          '43122','72448','35189','69424','85630',
                          '34886','95022','49323','17155','38697',
                          '44167','89591','94792','38081','74552',
                          '51168','31387','28855','55100','32659',
                          '32489','52253','50230','52038','96281',
                          '40971','48213','53590','91325','85210',
                          '71481','28223','19960','49469','85849',
                          '62956','11357','87006','14651','90822',
                          '56601','47381','43662','76955','11681',
                          '79206','76689','54538','69775','24765',
                          '92335','63204','94817','83374','24543',
                          '23931','48002','40210','52298','39774',
                          '50824','98045','13742','55954','95952',
                          '78248','64895','52361','36778','59260',
                          '28639','39513','94770','94591','66404',
                          '19841','21085','21804','42243','51234',
                          '62397','94262','13552','33764','96269',
                          '89778','17066','65058','41752','45629',
                          '97240','15032','50783','85543','80952',
                          '73734','76911','49905','44783','96038',
                          '64070','69702','58756','49579','99457',
                          '74804','19831','27129','30341','54895',
                          '19678','93395','41026','37675','64579',
                          '91493','25346','40506','49966','48335',
                          '27856','21745','27056','31386','11380',
                          '62182','86465','18194','74434','25069',
                          '33121','58184','23260','90635','38676',
                          '32941','99459','20740','44487','27731',
                          '91113','35190','84436','30468','16008',
                          '28559','73584','22923','88954','35018',
                          '82726','44426','90357','96958','33958',
                          '48996','80190','42216','77649','33153',
                          '40190','81699','29460','24010','52666',
                          '50321','65683','22354','64317','70791',
                          '21961','62917','12806','33801','43759',
                          '89756','77090','11198','44247','39866',
                          '33669','13008','74085','79980','74113',
                          '89153','93350','91908','67997','40149',
                          '86565','76670','40547','91747','46387',
                          '86542','96749','10473','97074','24478',
                          '21306','65518','55803','92328','68256',
                          '56009','62665','26540','41015','89184',
                          '96679','63269','11182','66119','90883',
                          '80429','72598','36191','34971','93092',
                          '96627','60516','23507','69047','52568',
                          '57243','36253','47798','98664','58964',
                          '13838','89971','90067','79040','13776',
                          '93188','95260','60087','66216','86069',
                          '46143','49662','19228','49059','90929',
                          '86102','72201','10569','15080')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1999
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;


EXPLAIN (FORMAT JSON, ANALYZE, VERBOSE)
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '54007','94588','89866','51778','52042','15318',
                          '49140','10866','90704','86676','27830',
                          '53995','49550','16457','73794','70832',
                          '68607','84754','91214','61728','23780',
                          '26554','20956','70291','77031','57403',
                          '25128','88570','91152','93092','40984',
                          '70547','33657','75372','19521','96047',
                          '40214','66702','35021','15602','99809',
                          '57758','63248','13927','17572','67840',
                          '55613','40012','45836','57373','69960',
                          '86115','23765','59963','45951','67267',
                          '20734','51100','92609','47628','40044',
                          '57869','56848','86702','86747','12136',
                          '64287','15895','81960','81410','62854',
                          '68115','35332','63506','14488','15633',
                          '84655','59121','57914','84390','23849',
                          '19878','74339','34495','18510','42082',
                          '77799','54977','25716','76482','82748',
                          '64404','11444','29281','30122','82092',
                          '93445','42228','66992','37219','73710',
                          '54300','63241','20439','35683','91597',
                          '29559','45841','62521','96765','71581',
                          '19626','15310','93585','82186','79363',
                          '84476','30125','49090','98218','34493',
                          '41770','22181','98303','87045','42263',
                          '28087','24281','91707','92702','55026',
                          '44475','75092','19512','52523','76969',
                          '19887','29315','91774','39522','23965',
                          '82747','47886','34365','95615','79297',
                          '39824','75262','24190','43200','39800',
                          '32775','69013','37923','81321','46832',
                          '72612','72477','77208','26283','12443',
                          '84873','95952','26552','83981','88366',
                          '48602','49377','57007','44942','77245',
                          '14283','67448','76011','84120','22473',
                          '99737','61040','57254','21159','82290',
                          '91677','40394','81419','65788','62049',
                          '98876','44600','38001','42832','98735',
                          '61074','37729','31150','45845','57441',
                          '51004','96708','33974','81165','82481',
                          '52058','65656','63377','85018','71031',
                          '71133','15978','26928','30306','68556',
                          '47275','47118','81656','12285','85966',
                          '36469','79253','51150','55636','14328',
                          '25531','62434','96908','21313','23810',
                          '56000','29064','92789','60659','95037',
                          '66002','42570','66719','93499','39562',
                          '41573','10887','52384','88942','95670',
                          '53047','51628','47589','45307','71460',
                          '31253','80590','70754','48056','60782',
                          '24485','22298','67823','99457','60607',
                          '40020','26139','76038','84339','50231',
                          '55705','61377','24451','27302','14437',
                          '84017','88176','39091','37791','15899',
                          '57698','62510','67089','48325','26366',
                          '26767','24189','48470','93736','77160',
                          '30154','77006','75778','17009','45651',
                          '96982','20667','66874','54235','16943',
                          '60118','97203','46754','97711','10864',
                          '14687','36037','67757','75355','61937',
                          '69166','48861','73406','79345','24444',
                          '66615','56516','51918','42423','30905',
                          '96757','99940','77773','14720','87059',
                          '37383','76452','31091','42807','16198',
                          '63629','13656','65691','36972','95265',
                          '22318','50924','45402','69934','13134',
                          '47682','16186','26955','30138','89585',
                          '57345','27050','33769','13238','13396',
                          '85651','87212','38070','67244','12823',
                          '30594','21047','49524','71052','45947',
                          '52681','39574','76280','52884','42519',
                          '66866','70032','70784','20694','65301',
                          '33078','99131','28041','80920','53555',
                          '34803','56569','62706','88388','74164',
                          '79978','43140','27294','97964','51675',
                          '62112','46101','53832','31796','27741',
                          '39236','44036','79901','89694','34916',
                          '85894','70568','30572','80931','21618',
                          '32708','96109','95521','64049','10335',
                          '30535','59382','84334','76465')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
